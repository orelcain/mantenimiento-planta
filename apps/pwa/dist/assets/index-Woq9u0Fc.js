import{j as e,c as Xa,O as ps,P as Wa,C as fs,a as Ya,T as gs,D as vs,R as Ka,b as Ja,d as js,I as Qa,S as bs,e as ys,f as er,g as Ns,V as tr,L as ws,h as Cs,i as sr,k as ar,l as Ss,m as rr,n as nr,u as ht,o as Rt,p as Tt,q as we,r as Ue,s as ks,t as Es,v as Is,w as or,x as St,y as As,z as ir,A as cr,B as lr,E as dr}from"./ui-BYyVPSVf.js";import{e as ur,g as mr,d as tt,a as d,R as hr,r as xr,u as Pt,N as pr,O as fr,B as gr,f as vr,h as ge,i as zt}from"./vendor-BtbATzP-.js";import{i as jr,g as br,c as yr,d as Nr,o as wr,s as Cr,e as Ds,f as Sr,u as kr,h as Ve,j as X,k as Ze,l as Er,m as Lt,q as je,w as Ge,n as ie,p as Re,r as Y,t as Ae,v as Ir,x as Ar,T as be,y as Dr,z as Mr,A as Rr,B as Ft,C as Ms}from"./firebase-Dw09es-n.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();var it={},Qt;function Tr(){if(Qt)return it;Qt=1;var t=ur();return it.createRoot=t.createRoot,it.hydrateRoot=t.hydrateRoot,it}var Pr=Tr();const zr=mr(Pr),Lr={apiKey:"AIzaSyBsJSh6x3ZGEyuXsM18dSWsJKyU7--KJss",authDomain:"mantenimiento-planta-771a3.firebaseapp.com",projectId:"mantenimiento-planta-771a3",storageBucket:"mantenimiento-planta-771a3.firebasestorage.app",messagingSenderId:"1019421112530",appId:"1:1019421112530:web:9afd9962e0b53152f8d50b"},_t=jr(Lr),rt=br(_t),F=yr(_t),Fr=Nr(_t);async function _r(t,s){const a=await Cr(rt,t,s),n=await Rs(a.user.uid);if(!n)throw new Error("Usuario no encontrado en la base de datos");if(!n.activo)throw await Ds(rt),new Error("Usuario desactivado. Contacte al administrador.");return n}async function Or(t,s,a,n,o){const r=await Vr(o);if(!r)throw new Error("Código de invitación inválido o expirado");const i=await Sr(rt,t,s);await kr(i.user,{displayName:`${a} ${n}`});const c={id:i.user.uid,email:t,nombre:a,apellido:n,rol:r.rol,activo:!0,createdAt:new Date,updatedAt:new Date};return await Ve(X(F,"users",i.user.uid),{...c,createdAt:Y(),updatedAt:Y()}),await Ze(X(F,"inviteCodes",r.id),{usosActuales:Er(1)}),c}async function $r(){await Ds(rt)}async function Rs(t){var o,r;const s=X(F,"users",t),a=await Lt(s);if(!a.exists())return null;const n=a.data();return{id:a.id,...n,createdAt:((o=n.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((r=n.updatedAt)==null?void 0:r.toDate())||new Date}}async function Vr(t){var i,c;const s=je(ie(F,"inviteCodes"),Ge("code","==",t.toUpperCase()),Ge("activo","==",!0)),a=await Re(s);if(a.empty)return null;const n=a.docs[0];if(!n)return null;const o=n.data(),r={id:n.id,code:o.code,rol:o.rol,usosMaximos:o.usosMaximos,usosActuales:o.usosActuales,activo:o.activo,createdBy:o.createdBy,createdAt:((i=o.createdAt)==null?void 0:i.toDate())||new Date,expiresAt:(c=o.expiresAt)==null?void 0:c.toDate()};return r.expiresAt&&r.expiresAt<new Date||r.usosActuales>=r.usosMaximos?null:r}function Ur(t){return wr(rt,t)}const es=t=>{let s;const a=new Set,n=(u,p)=>{const h=typeof u=="function"?u(s):u;if(!Object.is(h,s)){const f=s;s=p??(typeof h!="object"||h===null)?h:Object.assign({},s,h),a.forEach(N=>N(s,f))}},o=()=>s,c={setState:n,getState:o,getInitialState:()=>l,subscribe:u=>(a.add(u),()=>a.delete(u))},l=s=t(n,o,c);return c},Br=(t=>t?es(t):es),qr=t=>t;function Zr(t,s=qr){const a=tt.useSyncExternalStore(t.subscribe,tt.useCallback(()=>s(t.getState()),[t,s]),tt.useCallback(()=>s(t.getInitialState()),[t,s]));return tt.useDebugValue(a),a}const ts=t=>{const s=Br(t),a=n=>Zr(s,n);return Object.assign(a,s),a},Ts=(t=>t?ts(t):ts);function Gr(t,s){let a;try{a=t()}catch{return}return{getItem:o=>{var r;const i=l=>l===null?null:JSON.parse(l,void 0),c=(r=a.getItem(o))!=null?r:null;return c instanceof Promise?c.then(i):i(c)},setItem:(o,r)=>a.setItem(o,JSON.stringify(r,void 0)),removeItem:o=>a.removeItem(o)}}const kt=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(n){return kt(n)(a)},catch(n){return this}}}catch(a){return{then(n){return this},catch(n){return kt(n)(a)}}}},Hr=(t,s)=>(a,n,o)=>{let r={storage:Gr(()=>localStorage),partialize:x=>x,version:0,merge:(x,m)=>({...m,...x}),...s},i=!1;const c=new Set,l=new Set;let u=r.storage;if(!u)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...x)},n,o);const p=()=>{const x=r.partialize({...n()});return u.setItem(r.name,{state:x,version:r.version})},h=o.setState;o.setState=(x,m)=>(h(x,m),p());const f=t((...x)=>(a(...x),p()),n,o);o.getInitialState=()=>f;let N;const g=()=>{var x,m;if(!u)return;i=!1,c.forEach(b=>{var j;return b((j=n())!=null?j:f)});const v=((m=r.onRehydrateStorage)==null?void 0:m.call(r,(x=n())!=null?x:f))||void 0;return kt(u.getItem.bind(u))(r.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==r.version){if(r.migrate){const j=r.migrate(b.state,b.version);return j instanceof Promise?j.then(I=>[!0,I]):[!0,j]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var j;const[I,O]=b;if(N=r.merge(O,(j=n())!=null?j:f),a(N,!0),I)return p()}).then(()=>{v==null||v(N,void 0),N=n(),i=!0,l.forEach(b=>b(N))}).catch(b=>{v==null||v(void 0,b)})};return o.persist={setOptions:x=>{r={...r,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u==null||u.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:x=>(c.add(x),()=>{c.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},r.skipHydration||g(),N||f},Xr=Hr,Q=Ts()(Xr(t=>({user:null,isAuthenticated:!1,isLoading:!0,setUser:s=>t({user:s,isAuthenticated:!!s,isLoading:!1}),setLoading:s=>t({isLoading:s}),logout:()=>t({user:null,isAuthenticated:!1,isLoading:!1})}),{name:"auth-storage",partialize:t=>({user:t.user,isAuthenticated:t.isAuthenticated})}));function Wr(){const t=Q(s=>s.user);return(t==null?void 0:t.rol)==="admin"}function Yr(){const t=Q(s=>s.user);return(t==null?void 0:t.rol)==="supervisor"||(t==null?void 0:t.rol)==="admin"}const He=Ts(t=>({incidents:[],selectedIncident:null,setIncidents:s=>t({incidents:s}),setSelectedIncident:s=>t({selectedIncident:s}),addIncident:s=>t(a=>({incidents:[s,...a.incidents]})),updateIncident:(s,a)=>t(n=>({incidents:n.incidents.map(o=>o.id===s?{...o,...a}:o)})),removeIncident:s=>t(a=>({incidents:a.incidents.filter(n=>n.id!==s)})),zones:[],selectedZone:null,setZones:s=>t({zones:s}),setSelectedZone:s=>t({selectedZone:s}),equipment:[],selectedEquipment:null,setEquipment:s=>t({equipment:s}),setSelectedEquipment:s=>t({selectedEquipment:s}),sidebarOpen:!0,toggleSidebar:()=>t(s=>({sidebarOpen:!s.sidebarOpen})),setSidebarOpen:s=>t({sidebarOpen:s}),mapImage:null,setMapImage:s=>t({mapImage:s})}));var Kr=Symbol.for("react.lazy"),mt=hr[" use ".trim().toString()];function Jr(t){return typeof t=="object"&&t!==null&&"then"in t}function Ps(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Kr&&"_payload"in t&&Jr(t._payload)}function zs(t){const s=en(t),a=d.forwardRef((n,o)=>{let{children:r,...i}=n;Ps(r)&&typeof mt=="function"&&(r=mt(r._payload));const c=d.Children.toArray(r),l=c.find(sn);if(l){const u=l.props.children,p=c.map(h=>h===l?d.Children.count(u)>1?d.Children.only(null):d.isValidElement(u)?u.props.children:null:h);return e.jsx(s,{...i,ref:o,children:d.isValidElement(u)?d.cloneElement(u,void 0,p):null})}return e.jsx(s,{...i,ref:o,children:r})});return a.displayName=`${t}.Slot`,a}var Qr=zs("Slot");function en(t){const s=d.forwardRef((a,n)=>{let{children:o,...r}=a;if(Ps(o)&&typeof mt=="function"&&(o=mt(o._payload)),d.isValidElement(o)){const i=rn(o),c=an(r,o.props);return o.type!==d.Fragment&&(c.ref=n?Xa(n,i):i),d.cloneElement(o,c)}return d.Children.count(o)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var tn=Symbol("radix.slottable");function sn(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===tn}function an(t,s){const a={...s};for(const n in s){const o=t[n],r=s[n];/^on[A-Z]/.test(n)?o&&r?a[n]=(...c)=>{const l=r(...c);return o(...c),l}:o&&(a[n]=o):n==="style"?a[n]={...o,...r}:n==="className"&&(a[n]=[o,r].filter(Boolean).join(" "))}return{...t,...a}}function rn(t){var n,o;let s=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,a=s&&"isReactWarning"in s&&s.isReactWarning;return a?t.ref:(s=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,a=s&&"isReactWarning"in s&&s.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}function Ls(t){var s,a,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(s=0;s<o;s++)t[s]&&(a=Ls(t[s]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a);return n}function Fs(){for(var t,s,a=0,n="",o=arguments.length;a<o;a++)(t=arguments[a])&&(s=Ls(t))&&(n&&(n+=" "),n+=s);return n}const ss=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,as=Fs,Ot=(t,s)=>a=>{var n;if((s==null?void 0:s.variants)==null)return as(t,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:o,defaultVariants:r}=s,i=Object.keys(o).map(u=>{const p=a==null?void 0:a[u],h=r==null?void 0:r[u];if(p===null)return null;const f=ss(p)||ss(h);return o[u][f]}),c=a&&Object.entries(a).reduce((u,p)=>{let[h,f]=p;return f===void 0||(u[h]=f),u},{}),l=s==null||(n=s.compoundVariants)===null||n===void 0?void 0:n.reduce((u,p)=>{let{class:h,className:f,...N}=p;return Object.entries(N).every(g=>{let[x,m]=g;return Array.isArray(m)?m.includes({...r,...c}[x]):{...r,...c}[x]===m})?[...u,h,f]:u},[]);return as(t,i,l,a==null?void 0:a.class,a==null?void 0:a.className)},$t="-",nn=t=>{const s=cn(t),{conflictingClassGroups:a,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:i=>{const c=i.split($t);return c[0]===""&&c.length!==1&&c.shift(),_s(c,s)||on(i)},getConflictingClassGroupIds:(i,c)=>{const l=a[i]||[];return c&&n[i]?[...l,...n[i]]:l}}},_s=(t,s)=>{var i;if(t.length===0)return s.classGroupId;const a=t[0],n=s.nextPart.get(a),o=n?_s(t.slice(1),n):void 0;if(o)return o;if(s.validators.length===0)return;const r=t.join($t);return(i=s.validators.find(({validator:c})=>c(r)))==null?void 0:i.classGroupId},rs=/^\[(.+)\]$/,on=t=>{if(rs.test(t)){const s=rs.exec(t)[1],a=s==null?void 0:s.substring(0,s.indexOf(":"));if(a)return"arbitrary.."+a}},cn=t=>{const{theme:s,prefix:a}=t,n={nextPart:new Map,validators:[]};return dn(Object.entries(t.classGroups),a).forEach(([r,i])=>{Et(i,n,r,s)}),n},Et=(t,s,a,n)=>{t.forEach(o=>{if(typeof o=="string"){const r=o===""?s:ns(s,o);r.classGroupId=a;return}if(typeof o=="function"){if(ln(o)){Et(o(n),s,a,n);return}s.validators.push({validator:o,classGroupId:a});return}Object.entries(o).forEach(([r,i])=>{Et(i,ns(s,r),a,n)})})},ns=(t,s)=>{let a=t;return s.split($t).forEach(n=>{a.nextPart.has(n)||a.nextPart.set(n,{nextPart:new Map,validators:[]}),a=a.nextPart.get(n)}),a},ln=t=>t.isThemeGetter,dn=(t,s)=>s?t.map(([a,n])=>{const o=n.map(r=>typeof r=="string"?s+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([i,c])=>[s+i,c])):r);return[a,o]}):t,un=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,a=new Map,n=new Map;const o=(r,i)=>{a.set(r,i),s++,s>t&&(s=0,n=a,a=new Map)};return{get(r){let i=a.get(r);if(i!==void 0)return i;if((i=n.get(r))!==void 0)return o(r,i),i},set(r,i){a.has(r)?a.set(r,i):o(r,i)}}},Os="!",mn=t=>{const{separator:s,experimentalParseClassName:a}=t,n=s.length===1,o=s[0],r=s.length,i=c=>{const l=[];let u=0,p=0,h;for(let m=0;m<c.length;m++){let v=c[m];if(u===0){if(v===o&&(n||c.slice(m,m+r)===s)){l.push(c.slice(p,m)),p=m+r;continue}if(v==="/"){h=m;continue}}v==="["?u++:v==="]"&&u--}const f=l.length===0?c:c.substring(p),N=f.startsWith(Os),g=N?f.substring(1):f,x=h&&h>p?h-p:void 0;return{modifiers:l,hasImportantModifier:N,baseClassName:g,maybePostfixModifierPosition:x}};return a?c=>a({className:c,parseClassName:i}):i},hn=t=>{if(t.length<=1)return t;const s=[];let a=[];return t.forEach(n=>{n[0]==="["?(s.push(...a.sort(),n),a=[]):a.push(n)}),s.push(...a.sort()),s},xn=t=>({cache:un(t.cacheSize),parseClassName:mn(t),...nn(t)}),pn=/\s+/,fn=(t,s)=>{const{parseClassName:a,getClassGroupId:n,getConflictingClassGroupIds:o}=s,r=[],i=t.trim().split(pn);let c="";for(let l=i.length-1;l>=0;l-=1){const u=i[l],{modifiers:p,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:N}=a(u);let g=!!N,x=n(g?f.substring(0,N):f);if(!x){if(!g){c=u+(c.length>0?" "+c:c);continue}if(x=n(f),!x){c=u+(c.length>0?" "+c:c);continue}g=!1}const m=hn(p).join(":"),v=h?m+Os:m,b=v+x;if(r.includes(b))continue;r.push(b);const j=o(x,g);for(let I=0;I<j.length;++I){const O=j[I];r.push(v+O)}c=u+(c.length>0?" "+c:c)}return c};function gn(){let t=0,s,a,n="";for(;t<arguments.length;)(s=arguments[t++])&&(a=$s(s))&&(n&&(n+=" "),n+=a);return n}const $s=t=>{if(typeof t=="string")return t;let s,a="";for(let n=0;n<t.length;n++)t[n]&&(s=$s(t[n]))&&(a&&(a+=" "),a+=s);return a};function vn(t,...s){let a,n,o,r=i;function i(l){const u=s.reduce((p,h)=>h(p),t());return a=xn(u),n=a.cache.get,o=a.cache.set,r=c,c(l)}function c(l){const u=n(l);if(u)return u;const p=fn(l,a);return o(l,p),p}return function(){return r(gn.apply(null,arguments))}}const $=t=>{const s=a=>a[t]||[];return s.isThemeGetter=!0,s},Vs=/^\[(?:([a-z-]+):)?(.+)\]$/i,jn=/^\d+\/\d+$/,bn=new Set(["px","full","screen"]),yn=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Nn=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,wn=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Cn=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Sn=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ve=t=>Be(t)||bn.has(t)||jn.test(t),Ee=t=>Xe(t,"length",Tn),Be=t=>!!t&&!Number.isNaN(Number(t)),bt=t=>Xe(t,"number",Be),Je=t=>!!t&&Number.isInteger(Number(t)),kn=t=>t.endsWith("%")&&Be(t.slice(0,-1)),T=t=>Vs.test(t),Ie=t=>yn.test(t),En=new Set(["length","size","percentage"]),In=t=>Xe(t,En,Us),An=t=>Xe(t,"position",Us),Dn=new Set(["image","url"]),Mn=t=>Xe(t,Dn,zn),Rn=t=>Xe(t,"",Pn),Qe=()=>!0,Xe=(t,s,a)=>{const n=Vs.exec(t);return n?n[1]?typeof s=="string"?n[1]===s:s.has(n[1]):a(n[2]):!1},Tn=t=>Nn.test(t)&&!wn.test(t),Us=()=>!1,Pn=t=>Cn.test(t),zn=t=>Sn.test(t),Ln=()=>{const t=$("colors"),s=$("spacing"),a=$("blur"),n=$("brightness"),o=$("borderColor"),r=$("borderRadius"),i=$("borderSpacing"),c=$("borderWidth"),l=$("contrast"),u=$("grayscale"),p=$("hueRotate"),h=$("invert"),f=$("gap"),N=$("gradientColorStops"),g=$("gradientColorStopPositions"),x=$("inset"),m=$("margin"),v=$("opacity"),b=$("padding"),j=$("saturate"),I=$("scale"),O=$("sepia"),L=$("skew"),H=$("space"),le=$("translate"),ne=()=>["auto","contain","none"],Ce=()=>["auto","hidden","clip","visible","scroll"],de=()=>["auto",T,s],C=()=>[T,s],_=()=>["",ve,Ee],ae=()=>["auto",Be,T],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ce=()=>["solid","dashed","dotted","double","none"],Se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ue=()=>["start","end","center","between","around","evenly","stretch"],he=()=>["","0",T],ze=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[Be,T];return{cacheSize:500,separator:":",theme:{colors:[Qe],spacing:[ve,Ee],blur:["none","",Ie,T],brightness:re(),borderColor:[t],borderRadius:["none","","full",Ie,T],borderSpacing:C(),borderWidth:_(),contrast:re(),grayscale:he(),hueRotate:re(),invert:he(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[kn,Ee],inset:de(),margin:de(),opacity:re(),padding:C(),saturate:re(),scale:re(),sepia:he(),skew:re(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",T]}],container:["container"],columns:[{columns:[Ie]}],"break-after":[{"break-after":ze()}],"break-before":[{"break-before":ze()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),T]}],overflow:[{overflow:Ce()}],"overflow-x":[{"overflow-x":Ce()}],"overflow-y":[{"overflow-y":Ce()}],overscroll:[{overscroll:ne()}],"overscroll-x":[{"overscroll-x":ne()}],"overscroll-y":[{"overscroll-y":ne()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Je,T]}],basis:[{basis:de()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",T]}],grow:[{grow:he()}],shrink:[{shrink:he()}],order:[{order:["first","last","none",Je,T]}],"grid-cols":[{"grid-cols":[Qe]}],"col-start-end":[{col:["auto",{span:["full",Je,T]},T]}],"col-start":[{"col-start":ae()}],"col-end":[{"col-end":ae()}],"grid-rows":[{"grid-rows":[Qe]}],"row-start-end":[{row:["auto",{span:[Je,T]},T]}],"row-start":[{"row-start":ae()}],"row-end":[{"row-end":ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",T]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",T]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...ue()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ue(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ue(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[H]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[H]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",T,s]}],"min-w":[{"min-w":[T,s,"min","max","fit"]}],"max-w":[{"max-w":[T,s,"none","full","min","max","fit","prose",{screen:[Ie]},Ie]}],h:[{h:[T,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[T,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[T,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[T,s,"auto","min","max","fit"]}],"font-size":[{text:["base",Ie,Ee]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bt]}],"font-family":[{font:[Qe]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",T]}],"line-clamp":[{"line-clamp":["none",Be,bt]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ve,T]}],"list-image":[{"list-image":["none",T]}],"list-style-type":[{list:["none","disc","decimal",T]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ce(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ve,Ee]}],"underline-offset":[{"underline-offset":["auto",ve,T]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",T]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",T]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),An]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",In]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Mn]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[N]}],"gradient-via":[{via:[N]}],"gradient-to":[{to:[N]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...ce(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:ce()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...ce()]}],"outline-offset":[{"outline-offset":[ve,T]}],"outline-w":[{outline:[ve,Ee]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:_()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[ve,Ee]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ie,Rn]}],"shadow-color":[{shadow:[Qe]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...Se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Se()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ie,T]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[h]}],saturate:[{saturate:[j]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",T]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",T]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",T]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[Je,T]}],"translate-x":[{"translate-x":[le]}],"translate-y":[{"translate-y":[le]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",T]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",T]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",T]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ve,Ee,bt]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Fn=vn(Ln);function k(...t){return Fn(Fs(t))}function Bs(t){return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(t))}function It(t){const s=new Date,a=new Date(t),n=s.getTime()-a.getTime(),o=Math.floor(n/6e4),r=Math.floor(n/36e5),i=Math.floor(n/864e5);return o<1?"Hace un momento":o<60?`Hace ${o} min`:r<24?`Hace ${r}h`:i<7?`Hace ${i} días`:Bs(t)}function Vt(){return`${Date.now()}-${Math.random().toString(36).substring(2,9)}`}const _n=Ot("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90",warning:"bg-warning text-warning-foreground hover:bg-warning/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=d.forwardRef(({className:t,variant:s,size:a,asChild:n=!1,...o},r)=>{const i=n?Qr:"button";return e.jsx(i,{className:k(_n({variant:s,size:a,className:t})),ref:r,...o})});E.displayName="Button";const V=d.forwardRef(({className:t,type:s,...a},n)=>e.jsx("input",{type:s,className:k("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...a}));V.displayName="Input";var On=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],xt=On.reduce((t,s)=>{const a=zs(`Primitive.${s}`),n=d.forwardRef((o,r)=>{const{asChild:i,...c}=o,l=i?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...c,ref:r})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{}),$n="Label",qs=d.forwardRef((t,s)=>e.jsx(xt.label,{...t,ref:s,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=t.onMouseDown)==null||o.call(t,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));qs.displayName=$n;var Zs=qs;const Vn=Ot("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),M=d.forwardRef(({className:t,...s},a)=>e.jsx(Zs,{ref:a,className:k(Vn(),t),...s}));M.displayName=Zs.displayName;const D=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:k("rounded-lg border border-border bg-card text-card-foreground shadow-sm",t),...s}));D.displayName="Card";const B=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:k("flex flex-col space-y-1.5 p-6",t),...s}));B.displayName="CardHeader";const q=d.forwardRef(({className:t,...s},a)=>e.jsx("h3",{ref:a,className:k("text-2xl font-semibold leading-none tracking-tight",t),...s}));q.displayName="CardTitle";const Gs=d.forwardRef(({className:t,...s},a)=>e.jsx("p",{ref:a,className:k("text-sm text-muted-foreground",t),...s}));Gs.displayName="CardDescription";const R=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:k("p-6 pt-0",t),...s}));R.displayName="CardContent";const Un=d.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:k("flex items-center p-6 pt-0",t),...s}));Un.displayName="CardFooter";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Hs=(...t)=>t.filter((s,a,n)=>!!s&&s.trim()!==""&&n.indexOf(s)===a).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=d.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:o="",children:r,iconNode:i,...c},l)=>d.createElement("svg",{ref:l,...qn,width:s,height:s,stroke:t,strokeWidth:n?Number(a)*24/Number(s):a,className:Hs("lucide",o),...c},[...i.map(([u,p])=>d.createElement(u,p)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=(t,s)=>{const a=d.forwardRef(({className:n,...o},r)=>d.createElement(Zn,{ref:r,iconNode:s,className:Hs(`lucide-${Bn(t)}`,n),...o}));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=A("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=A("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=A("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=A("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=A("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=A("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=A("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=A("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=A("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=A("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=A("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=A("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=A("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=A("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=A("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=A("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=A("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=A("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=A("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=A("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=A("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=A("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=A("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=A("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=A("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=A("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=A("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=A("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=A("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=A("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=A("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=A("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=A("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=A("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=A("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=A("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=A("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=A("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=A("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=A("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=A("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=A("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=A("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=A("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Me=Ka,go=Ja,vo=Wa,ta=d.forwardRef(({className:t,...s},a)=>e.jsx(ps,{ref:a,className:k("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));ta.displayName=ps.displayName;const Ne=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(vo,{children:[e.jsx(ta,{}),e.jsxs(fs,{ref:n,className:k("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-card p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a,children:[s,e.jsxs(Ya,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Cerrar"})]})]})]}));Ne.displayName=fs.displayName;const Te=({className:t,...s})=>e.jsx("div",{className:k("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Te.displayName="DialogHeader";const Ke=({className:t,...s})=>e.jsx("div",{className:k("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Ke.displayName="DialogFooter";const Pe=d.forwardRef(({className:t,...s},a)=>e.jsx(gs,{ref:a,className:k("text-lg font-semibold leading-none tracking-tight",t),...s}));Pe.displayName=gs.displayName;const jo=d.forwardRef(({className:t,...s},a)=>e.jsx(vs,{ref:a,className:k("text-sm text-muted-foreground",t),...s}));jo.displayName=vs.displayName;const te=rr,se=nr,K=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(js,{ref:n,className:k("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(Qa,{asChild:!0,children:e.jsx(Ut,{className:"h-4 w-4 opacity-50"})})]}));K.displayName=js.displayName;const sa=d.forwardRef(({className:t,...s},a)=>e.jsx(bs,{ref:a,className:k("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Kn,{className:"h-4 w-4"})}));sa.displayName=bs.displayName;const aa=d.forwardRef(({className:t,...s},a)=>e.jsx(ys,{ref:a,className:k("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Ut,{className:"h-4 w-4"})}));aa.displayName=ys.displayName;const J=d.forwardRef(({className:t,children:s,position:a="popper",...n},o)=>e.jsx(er,{children:e.jsxs(Ns,{ref:o,className:k("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...n,children:[e.jsx(sa,{}),e.jsx(tr,{className:k("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(aa,{})]})}));J.displayName=Ns.displayName;const bo=d.forwardRef(({className:t,...s},a)=>e.jsx(ws,{ref:a,className:k("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));bo.displayName=ws.displayName;const P=d.forwardRef(({className:t,children:s,...a},n)=>e.jsxs(Cs,{ref:n,className:k("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(sr,{children:e.jsx(Ws,{className:"h-4 w-4"})})}),e.jsx(ar,{children:s})]}));P.displayName=Cs.displayName;const yo=d.forwardRef(({className:t,...s},a)=>e.jsx(Ss,{ref:a,className:k("-mx-1 my-1 h-px bg-muted",t),...s}));yo.displayName=Ss.displayName;var ft="Switch",[No]=Tt(ft),[wo,Co]=No(ft),ra=d.forwardRef((t,s)=>{const{__scopeSwitch:a,name:n,checked:o,defaultChecked:r,required:i,disabled:c,value:l="on",onCheckedChange:u,form:p,...h}=t,[f,N]=d.useState(null),g=ht(s,j=>N(j)),x=d.useRef(!1),m=f?p||!!f.closest("form"):!0,[v,b]=Rt({prop:o,defaultProp:r??!1,onChange:u,caller:ft});return e.jsxs(wo,{scope:a,checked:v,disabled:c,children:[e.jsx(we.button,{type:"button",role:"switch","aria-checked":v,"aria-required":i,"data-state":ca(v),"data-disabled":c?"":void 0,disabled:c,value:l,...h,ref:g,onClick:Ue(t.onClick,j=>{b(I=>!I),m&&(x.current=j.isPropagationStopped(),x.current||j.stopPropagation())})}),m&&e.jsx(ia,{control:f,bubbles:!x.current,name:n,value:l,checked:v,required:i,disabled:c,form:p,style:{transform:"translateX(-100%)"}})]})});ra.displayName=ft;var na="SwitchThumb",oa=d.forwardRef((t,s)=>{const{__scopeSwitch:a,...n}=t,o=Co(na,a);return e.jsx(we.span,{"data-state":ca(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:s})});oa.displayName=na;var So="SwitchBubbleInput",ia=d.forwardRef(({__scopeSwitch:t,control:s,checked:a,bubbles:n=!0,...o},r)=>{const i=d.useRef(null),c=ht(i,r),l=ks(a),u=Es(s);return d.useEffect(()=>{const p=i.current;if(!p)return;const h=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==a&&N){const g=new Event("click",{bubbles:n});N.call(p,a),p.dispatchEvent(g)}},[l,a,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...o,tabIndex:-1,ref:c,style:{...o.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ia.displayName=So;function ca(t){return t?"checked":"unchecked"}var la=ra,ko=oa;const _e=d.forwardRef(({className:t,...s},a)=>e.jsx(la,{className:k("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...s,ref:a,children:e.jsx(ko,{className:k("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));_e.displayName=la.displayName;var gt="Checkbox",[Eo]=Tt(gt),[Io,Gt]=Eo(gt);function Ao(t){const{__scopeCheckbox:s,checked:a,children:n,defaultChecked:o,disabled:r,form:i,name:c,onCheckedChange:l,required:u,value:p="on",internal_do_not_use_render:h}=t,[f,N]=Rt({prop:a,defaultProp:o??!1,onChange:l,caller:gt}),[g,x]=d.useState(null),[m,v]=d.useState(null),b=d.useRef(!1),j=g?!!i||!!g.closest("form"):!0,I={checked:f,disabled:r,setChecked:N,control:g,setControl:x,name:c,form:i,value:p,hasConsumerStoppedPropagationRef:b,required:u,defaultChecked:De(o)?!1:o,isFormControl:j,bubbleInput:m,setBubbleInput:v};return e.jsx(Io,{scope:s,...I,children:Do(h)?h(I):n})}var da="CheckboxTrigger",ua=d.forwardRef(({__scopeCheckbox:t,onKeyDown:s,onClick:a,...n},o)=>{const{control:r,value:i,disabled:c,checked:l,required:u,setControl:p,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:N,bubbleInput:g}=Gt(da,t),x=ht(o,p),m=d.useRef(l);return d.useEffect(()=>{const v=r==null?void 0:r.form;if(v){const b=()=>h(m.current);return v.addEventListener("reset",b),()=>v.removeEventListener("reset",b)}},[r,h]),e.jsx(we.button,{type:"button",role:"checkbox","aria-checked":De(l)?"mixed":l,"aria-required":u,"data-state":fa(l),"data-disabled":c?"":void 0,disabled:c,value:i,...n,ref:x,onKeyDown:Ue(s,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:Ue(a,v=>{h(b=>De(b)?!0:!b),g&&N&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});ua.displayName=da;var Ht=d.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:n,checked:o,defaultChecked:r,required:i,disabled:c,value:l,onCheckedChange:u,form:p,...h}=t;return e.jsx(Ao,{__scopeCheckbox:a,checked:o,defaultChecked:r,disabled:c,required:i,onCheckedChange:u,name:n,form:p,value:l,internal_do_not_use_render:({isFormControl:f})=>e.jsxs(e.Fragment,{children:[e.jsx(ua,{...h,ref:s,__scopeCheckbox:a}),f&&e.jsx(pa,{__scopeCheckbox:a})]})})});Ht.displayName=gt;var ma="CheckboxIndicator",ha=d.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:n,...o}=t,r=Gt(ma,a);return e.jsx(Is,{present:n||De(r.checked)||r.checked===!0,children:e.jsx(we.span,{"data-state":fa(r.checked),"data-disabled":r.disabled?"":void 0,...o,ref:s,style:{pointerEvents:"none",...t.style}})})});ha.displayName=ma;var xa="CheckboxBubbleInput",pa=d.forwardRef(({__scopeCheckbox:t,...s},a)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:r,defaultChecked:i,required:c,disabled:l,name:u,value:p,form:h,bubbleInput:f,setBubbleInput:N}=Gt(xa,t),g=ht(a,N),x=ks(r),m=Es(n);d.useEffect(()=>{const b=f;if(!b)return;const j=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(j,"checked").set,L=!o.current;if(x!==r&&O){const H=new Event("click",{bubbles:L});b.indeterminate=De(r),O.call(b,De(r)?!1:r),b.dispatchEvent(H)}},[f,x,r,o]);const v=d.useRef(De(r)?!1:r);return e.jsx(we.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??v.current,required:c,disabled:l,name:u,value:p,form:h,...s,tabIndex:-1,ref:g,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});pa.displayName=xa;function Do(t){return typeof t=="function"}function De(t){return t==="indeterminate"}function fa(t){return De(t)?"indeterminate":t?"checked":"unchecked"}const ga=d.forwardRef(({className:t,...s},a)=>e.jsx(Ht,{ref:a,className:k("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(ha,{className:k("flex items-center justify-center text-current"),children:e.jsx(Ws,{className:"h-4 w-4"})})}));ga.displayName=Ht.displayName;function Mo(t,s=[]){let a=[];function n(r,i){const c=d.createContext(i);c.displayName=r+"Context";const l=a.length;a=[...a,i];const u=h=>{var v;const{scope:f,children:N,...g}=h,x=((v=f==null?void 0:f[t])==null?void 0:v[l])||c,m=d.useMemo(()=>g,Object.values(g));return e.jsx(x.Provider,{value:m,children:N})};u.displayName=r+"Provider";function p(h,f){var x;const N=((x=f==null?void 0:f[t])==null?void 0:x[l])||c,g=d.useContext(N);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${r}\``)}return[u,p]}const o=()=>{const r=a.map(i=>d.createContext(i));return function(c){const l=(c==null?void 0:c[t])||r;return d.useMemo(()=>({[`__scope${t}`]:{...c,[t]:l}}),[c,l])}};return o.scopeName=t,[n,Ro(o,...s)]}function Ro(...t){const s=t[0];if(t.length===1)return s;const a=()=>{const n=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(r){const i=n.reduce((c,{useScope:l,scopeName:u})=>{const h=l(r)[`__scope${u}`];return{...c,...h}},{});return d.useMemo(()=>({[`__scope${s.scopeName}`]:i}),[i])}};return a.scopeName=s.scopeName,a}var yt={exports:{}},Nt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ds;function To(){if(ds)return Nt;ds=1;var t=xr();function s(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var a=typeof Object.is=="function"?Object.is:s,n=t.useState,o=t.useEffect,r=t.useLayoutEffect,i=t.useDebugValue;function c(h,f){var N=f(),g=n({inst:{value:N,getSnapshot:f}}),x=g[0].inst,m=g[1];return r(function(){x.value=N,x.getSnapshot=f,l(x)&&m({inst:x})},[h,N,f]),o(function(){return l(x)&&m({inst:x}),h(function(){l(x)&&m({inst:x})})},[h]),i(N),N}function l(h){var f=h.getSnapshot;h=h.value;try{var N=f();return!a(h,N)}catch{return!0}}function u(h,f){return f()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:c;return Nt.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,Nt}var us;function Po(){return us||(us=1,yt.exports=To()),yt.exports}var zo=Po();function Lo(){return zo.useSyncExternalStore(Fo,()=>!0,()=>!1)}function Fo(){return()=>{}}var Xt="Avatar",[_o]=Mo(Xt),[Oo,va]=_o(Xt),ja=d.forwardRef((t,s)=>{const{__scopeAvatar:a,...n}=t,[o,r]=d.useState("idle");return e.jsx(Oo,{scope:a,imageLoadingStatus:o,onImageLoadingStatusChange:r,children:e.jsx(xt.span,{...n,ref:s})})});ja.displayName=Xt;var ba="AvatarImage",ya=d.forwardRef((t,s)=>{const{__scopeAvatar:a,src:n,onLoadingStatusChange:o=()=>{},...r}=t,i=va(ba,a),c=$o(n,r),l=or(u=>{o(u),i.onImageLoadingStatusChange(u)});return St(()=>{c!=="idle"&&l(c)},[c,l]),c==="loaded"?e.jsx(xt.img,{...r,ref:s,src:n}):null});ya.displayName=ba;var Na="AvatarFallback",wa=d.forwardRef((t,s)=>{const{__scopeAvatar:a,delayMs:n,...o}=t,r=va(Na,a),[i,c]=d.useState(n===void 0);return d.useEffect(()=>{if(n!==void 0){const l=window.setTimeout(()=>c(!0),n);return()=>window.clearTimeout(l)}},[n]),i&&r.imageLoadingStatus!=="loaded"?e.jsx(xt.span,{...o,ref:s}):null});wa.displayName=Na;function ms(t,s){return t?s?(t.src!==s&&(t.src=s),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function $o(t,{referrerPolicy:s,crossOrigin:a}){const n=Lo(),o=d.useRef(null),r=n?(o.current||(o.current=new window.Image),o.current):null,[i,c]=d.useState(()=>ms(r,t));return St(()=>{c(ms(r,t))},[r,t]),St(()=>{const l=h=>()=>{c(h)};if(!r)return;const u=l("loaded"),p=l("error");return r.addEventListener("load",u),r.addEventListener("error",p),s&&(r.referrerPolicy=s),typeof a=="string"&&(r.crossOrigin=a),()=>{r.removeEventListener("load",u),r.removeEventListener("error",p)}},[r,a,s]),i}var Ca=ja,Sa=ya,ka=wa;const At=d.forwardRef(({className:t,...s},a)=>e.jsx(Ca,{ref:a,className:k("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));At.displayName=Ca.displayName;const Vo=d.forwardRef(({className:t,...s},a)=>e.jsx(Sa,{ref:a,className:k("aspect-square h-full w-full",t),...s}));Vo.displayName=Sa.displayName;const Dt=d.forwardRef(({className:t,...s},a)=>e.jsx(ka,{ref:a,className:k("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));Dt.displayName=ka.displayName;const Uo=Ot("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-warning text-warning-foreground hover:bg-warning/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function W({className:t,variant:s,...a}){return e.jsx("div",{className:k(Uo({variant:s}),t),...a})}const $e=d.forwardRef(({className:t,...s},a)=>e.jsx("textarea",{className:k("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s}));$e.displayName="Textarea";const Bo={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};function qe({className:t,size:s="md"}){return e.jsx(ao,{className:k("animate-spin text-primary",Bo[s],t)})}function Ea({message:t="Cargando..."}){return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center justify-center gap-4 bg-background",children:[e.jsx(qe,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t})]})}var vt="Tabs",[qo]=Tt(vt,[As]),Ia=As(),[Zo,Wt]=qo(vt),Aa=d.forwardRef((t,s)=>{const{__scopeTabs:a,value:n,onValueChange:o,defaultValue:r,orientation:i="horizontal",dir:c,activationMode:l="automatic",...u}=t,p=lr(c),[h,f]=Rt({prop:n,onChange:o,defaultProp:r??"",caller:vt});return e.jsx(Zo,{scope:a,baseId:dr(),value:h,onValueChange:f,orientation:i,dir:p,activationMode:l,children:e.jsx(we.div,{dir:p,"data-orientation":i,...u,ref:s})})});Aa.displayName=vt;var Da="TabsList",Ma=d.forwardRef((t,s)=>{const{__scopeTabs:a,loop:n=!0,...o}=t,r=Wt(Da,a),i=Ia(a);return e.jsx(ir,{asChild:!0,...i,orientation:r.orientation,dir:r.dir,loop:n,children:e.jsx(we.div,{role:"tablist","aria-orientation":r.orientation,...o,ref:s})})});Ma.displayName=Da;var Ra="TabsTrigger",Ta=d.forwardRef((t,s)=>{const{__scopeTabs:a,value:n,disabled:o=!1,...r}=t,i=Wt(Ra,a),c=Ia(a),l=La(i.baseId,n),u=Fa(i.baseId,n),p=n===i.value;return e.jsx(cr,{asChild:!0,...c,focusable:!o,active:p,children:e.jsx(we.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":u,"data-state":p?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:l,...r,ref:s,onMouseDown:Ue(t.onMouseDown,h=>{!o&&h.button===0&&h.ctrlKey===!1?i.onValueChange(n):h.preventDefault()}),onKeyDown:Ue(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&i.onValueChange(n)}),onFocus:Ue(t.onFocus,()=>{const h=i.activationMode!=="manual";!p&&!o&&h&&i.onValueChange(n)})})})});Ta.displayName=Ra;var Pa="TabsContent",za=d.forwardRef((t,s)=>{const{__scopeTabs:a,value:n,forceMount:o,children:r,...i}=t,c=Wt(Pa,a),l=La(c.baseId,n),u=Fa(c.baseId,n),p=n===c.value,h=d.useRef(p);return d.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),e.jsx(Is,{present:o||p,children:({present:f})=>e.jsx(we.div,{"data-state":p?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:u,tabIndex:0,...i,ref:s,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&r})})});za.displayName=Pa;function La(t,s){return`${t}-trigger-${s}`}function Fa(t,s){return`${t}-content-${s}`}var Go=Aa,_a=Ma,Oa=Ta,$a=za;const Ho=Go,Va=d.forwardRef(({className:t,...s},a)=>e.jsx(_a,{ref:a,className:k("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));Va.displayName=_a.displayName;const dt=d.forwardRef(({className:t,...s},a)=>e.jsx(Oa,{ref:a,className:k("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));dt.displayName=Oa.displayName;const ut=d.forwardRef(({className:t,...s},a)=>e.jsx($a,{ref:a,className:k("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));ut.displayName=$a.displayName;const hs=[{name:"Dashboard",href:"/",icon:so},{name:"Incidencias",href:"/incidents",icon:me},{name:"Preventivo",href:"/preventive",icon:Hn},{name:"Mapa",href:"/map",icon:oo},{name:"Equipos",href:"/equipment",icon:Ye}],Xo=[{name:"Configuración",href:"/settings",icon:Zt}];function Wo(){const t=Pt(),s=Q(h=>h.user),a=Q(h=>h.logout),n=Wr(),[o,r]=d.useState(!1),[i,c]=d.useState(!1),l=async()=>{await $r(),a(),t("/login")},u=s?`${s.nombre.charAt(0)}${s.apellido.charAt(0)}`.toUpperCase():"U",p=n?[...hs,...Xo]:hs;return e.jsxs("div",{className:"min-h-screen bg-background",children:[o&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>r(!1)}),e.jsx("aside",{className:k("fixed inset-y-0 left-0 z-50 w-64 bg-card border-r transform transition-transform duration-200 ease-in-out lg:translate-x-0",o?"translate-x-0":"-translate-x-full"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Ye,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"font-semibold",children:"Mantenimiento"})]}),e.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 hover:bg-muted rounded",children:e.jsx(nt,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:p.map(h=>e.jsxs(pr,{to:h.href,onClick:()=>r(!1),className:({isActive:f})=>k("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",f?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"),children:[e.jsx(h.icon,{className:"h-5 w-5"}),h.name]},h.href))}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!i),className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-muted transition-colors",children:[e.jsx(At,{className:"h-8 w-8",children:e.jsx(Dt,{className:"bg-primary/10 text-primary text-xs",children:u})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s==null?void 0:s.nombre," ",s==null?void 0:s.apellido]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s==null?void 0:s.rol})]}),e.jsx(Ut,{className:k("h-4 w-4 text-muted-foreground transition-transform",i&&"rotate-180")})]}),i&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-card border rounded-lg shadow-lg overflow-hidden",children:e.jsxs("button",{onClick:l,className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-destructive hover:bg-muted transition-colors",children:[e.jsx(no,{className:"h-4 w-4"}),"Cerrar sesión"]})})]})})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsxs("header",{className:"sticky top-0 z-30 flex items-center h-16 px-4 bg-background/80 backdrop-blur border-b",children:[e.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 -ml-2 hover:bg-muted rounded-lg",children:e.jsx(io,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"hidden lg:flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s==null?void 0:s.nombre," ",s==null?void 0:s.apellido]}),e.jsx(At,{className:"h-8 w-8",children:e.jsx(Dt,{className:"bg-primary/10 text-primary text-xs",children:u})})]})]}),e.jsx("main",{className:"p-4 lg:p-6",children:e.jsx(fr,{})})]})]})}function Yo(){const t=Pt(),s=Q(j=>j.setUser),[a,n]=d.useState("login"),[o,r]=d.useState(!1),[i,c]=d.useState(null),[l,u]=d.useState(""),[p,h]=d.useState(""),[f,N]=d.useState(""),[g,x]=d.useState(""),[m,v]=d.useState(""),b=async j=>{j.preventDefault(),c(null),r(!0);try{let I;a==="login"?I=await _r(l,p):I=await Or(l,p,f,g,m),s(I),t("/")}catch(I){console.error("Auth error:",I),c(Ko(I.code||I.message))}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(D,{className:"w-full max-w-md",children:[e.jsxs(B,{className:"space-y-1 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:e.jsx(Ye,{className:"h-8 w-8 text-primary"})})}),e.jsx(q,{className:"text-2xl font-bold",children:"Mantenimiento Industrial"}),e.jsx(Gs,{children:a==="login"?"Ingresa tus credenciales para continuar":"Registra tu cuenta con el código de invitación"})]}),e.jsxs(R,{children:[e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a==="register"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"nombre",children:"Nombre"}),e.jsx(V,{id:"nombre",placeholder:"Juan",value:f,onChange:j=>N(j.target.value),required:!0,disabled:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"apellido",children:"Apellido"}),e.jsx(V,{id:"apellido",placeholder:"Pérez",value:g,onChange:j=>x(j.target.value),required:!0,disabled:o})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"inviteCode",children:"Código de Invitación"}),e.jsx(V,{id:"inviteCode",placeholder:"XXXX-XXXX",value:m,onChange:j=>v(j.target.value.toUpperCase()),required:!0,disabled:o,className:"uppercase tracking-widest"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(V,{id:"email",type:"email",placeholder:"usuario@empresa.com",value:l,onChange:j=>u(j.target.value),required:!0,disabled:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"password",children:"Contraseña"}),e.jsx(V,{id:"password",type:"password",placeholder:"••••••••",value:p,onChange:j=>h(j.target.value),required:!0,disabled:o,minLength:6})]}),i&&e.jsx("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:i}),e.jsx(E,{type:"submit",className:"w-full",disabled:o,children:o?e.jsx(qe,{size:"sm"}):a==="login"?e.jsxs(e.Fragment,{children:[e.jsx(ro,{className:"h-4 w-4"}),"Iniciar Sesión"]}):e.jsxs(e.Fragment,{children:[e.jsx(po,{className:"h-4 w-4"}),"Registrarse"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:()=>{n(a==="login"?"register":"login"),c(null)},className:"text-sm text-muted-foreground hover:text-primary transition-colors",disabled:o,children:a==="login"?"¿Tienes un código de invitación? Regístrate":"¿Ya tienes cuenta? Inicia sesión"})})]})]})})}function Ko(t){return{"auth/invalid-credential":"Credenciales inválidas","auth/invalid-email":"Correo electrónico inválido","auth/user-disabled":"Usuario desactivado","auth/user-not-found":"Usuario no encontrado","auth/wrong-password":"Contraseña incorrecta","auth/email-already-in-use":"Este correo ya está registrado","auth/weak-password":"La contraseña debe tener al menos 6 caracteres","auth/too-many-requests":"Demasiados intentos. Intenta más tarde."}[t]||t}function Jo(){const t=Pt(),s=Q(l=>l.user),{incidents:a,equipment:n,zones:o}=He(),r={incidentesActivos:a.filter(l=>["pendiente","confirmada","en_proceso"].includes(l.status)).length,incidentesCriticos:a.filter(l=>l.prioridad==="critica"&&l.status!=="cerrada").length,equiposOperativos:n.filter(l=>l.estado==="operativo").length,equiposTotal:n.length,zonasConIncidentes:new Set(a.filter(l=>l.status!=="cerrada").map(l=>l.zoneId)).size},i=a.slice(0,5),c=a.filter(l=>l.prioridad==="critica"&&l.status!=="cerrada");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Bienvenido, ",(s==null?void 0:s.nombre)||"Usuario"]}),e.jsx("p",{className:"text-muted-foreground",children:"Panel de control de mantenimiento industrial"})]}),e.jsxs(E,{onClick:()=>t("/incidents"),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Nueva Incidencia"]})]}),c.length>0&&e.jsxs(D,{className:"border-destructive bg-destructive/10",children:[e.jsx(B,{className:"pb-2",children:e.jsxs(q,{className:"text-destructive flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Alertas Críticas (",c.length,")"]})}),e.jsx(R,{children:e.jsx("div",{className:"space-y-2",children:c.slice(0,3).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card rounded cursor-pointer hover:bg-muted",onClick:()=>t("/incidents"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"font-medium",children:l.titulo})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:It(l.createdAt)})]},l.id))})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>t("/incidents"),children:[e.jsxs(B,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Incidencias Activas"}),e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(R,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.incidentesActivos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.incidentesCriticos>0&&e.jsxs("span",{className:"text-destructive font-medium",children:[r.incidentesCriticos," críticas"]})})]})]}),e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>t("/equipment"),children:[e.jsxs(B,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Equipos"}),e.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(R,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r.equiposOperativos,"/",r.equiposTotal]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"operativos"})]})]}),e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>t("/map"),children:[e.jsxs(B,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Zonas"}),e.jsx(Oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(R,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.zonasConIncidentes," con incidencias"]})]})]}),e.jsxs(D,{children:[e.jsxs(B,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Tasa Resolución"}),e.jsx(ho,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(R,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.length>0?Math.round(a.filter(l=>l.status==="cerrada").length/a.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"incidencias cerradas"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx(B,{children:e.jsxs(q,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Últimas Incidencias"}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>t("/incidents"),children:"Ver todas"})]})}),e.jsx(R,{children:i.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ye,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay incidencias recientes"})]}):e.jsx("div",{className:"space-y-4",children:i.map(l=>e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer hover:bg-muted p-2 rounded -mx-2",onClick:()=>t("/incidents"),children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l.prioridad==="critica"?"bg-destructive":l.prioridad==="alta"?"bg-warning":"bg-primary"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:l.titulo}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l.status==="pendiente"&&"Pendiente",l.status==="confirmada"&&"Confirmada",l.status==="en_proceso"&&"En proceso",l.status==="cerrada"&&"Cerrada"]})]}),e.jsx("span",{className:"text-sm text-muted-foreground shrink-0",children:It(l.createdAt)})]},l.id))})})]}),e.jsxs(D,{children:[e.jsx(B,{children:e.jsxs(q,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Incidencias por Zona"}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>t("/map"),children:"Ver mapa"})]})}),e.jsx(R,{children:o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Oe,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"})]}):e.jsx("div",{className:"space-y-4",children:o.map(l=>{const u=a.filter(h=>h.zoneId===l.id&&h.status!=="cerrada"),p=u.filter(h=>h.prioridad==="critica").length;return e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer hover:bg-muted p-2 rounded -mx-2",onClick:()=>t("/map"),children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:l.color||"#2196f3"}}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium",children:l.nombre})}),e.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&e.jsx(W,{variant:"destructive",children:p}),e.jsx(W,{variant:"outline",children:u.length})]})]},l.id)})})})]})]})]})}const jt="incidents";async function Qo(t){const s=Vt(),a={...t,id:s,createdAt:new Date,updatedAt:new Date};return await Ve(X(F,jt,s),{...a,createdAt:Y(),updatedAt:Y()}),a}async function ei(t){const s=X(F,jt,t),a=await Lt(s);return a.exists()?Ba(a):null}async function Yt(t,s){const a=X(F,jt,t);await Ze(a,{...s,updatedAt:Y()})}async function ti(t,s){await Yt(t,{status:"confirmada",validatedBy:s,validatedAt:new Date,confirmedAt:new Date})}async function si(t,s,a){await Yt(t,{status:"rechazada",validatedBy:s,validatedAt:new Date,rejectionReason:a})}async function ai(t,s,a,n){const o=await ei(t);if(!o)throw new Error("Incidencia no encontrada");const r=new Date,i=o.confirmedAt?Math.round((r.getTime()-o.confirmedAt.getTime())/6e4):void 0;await Yt(t,{status:"cerrada",resolucion:s,closedAt:r,tiempoResolucionMinutos:i,repuestosUsados:a,firmaCierre:n})}function Ua(t,s){const a=[];s!=null&&s.status&&s.status.length>0&&a.push(Ge("status","in",s.status)),a.push(Ae("createdAt","desc")),a.push(Ir(100));const n=je(ie(F,jt),...a);return Ar(n,o=>{const r=o.docs.map(Ba);t(r)})}function Ba(t){const s=t.data();return{...s,id:t.id,createdAt:et(s.createdAt),updatedAt:et(s.updatedAt),confirmedAt:et(s.confirmedAt),closedAt:et(s.closedAt),validatedAt:et(s.validatedAt)}}function et(t){if(t)return t instanceof be?t.toDate():t instanceof Date?t:new Date(t)}async function ri(t,s){const a=s.name.split(".").pop()||"jpg",n=`${Vt()}.${a}`,o=Dr(Fr,`incidents/${t}/${n}`);return await Mr(o,s),Rr(o)}async function ni(t,s=1920,a=.8){return new Promise((n,o)=>{const r=new Image;r.src=URL.createObjectURL(t),r.onload=()=>{const i=document.createElement("canvas");let{width:c,height:l}=r;c>s&&(l=l*s/c,c=s),i.width=c,i.height=l;const u=i.getContext("2d");if(!u){o(new Error("No se pudo crear contexto de canvas"));return}u.drawImage(r,0,0,c,l),i.toBlob(p=>{if(p){const h=new File([p],t.name,{type:"image/jpeg",lastModified:Date.now()});n(h)}else o(new Error("No se pudo comprimir la imagen"))},"image/jpeg",a),URL.revokeObjectURL(r.src)},r.onerror=()=>{o(new Error("Error cargando imagen"))}})}function oi({onClose:t,onSuccess:s}){const a=Q(m=>m.user),{zones:n}=He(),o=d.useRef(null),[r,i]=d.useState(!1),[c,l]=d.useState([]),[u,p]=d.useState([]),[h,f]=d.useState({titulo:"",descripcion:"",zoneId:"",prioridad:"media",sintomas:""}),N=async m=>{const v=Array.from(m.target.files||[]);for(const b of v){if(c.length>=5)break;const j=await ni(b,1920,.8);l(O=>[...O,j]);const I=new FileReader;I.onloadend=()=>{p(O=>[...O,I.result])},I.readAsDataURL(j)}},g=m=>{l(v=>v.filter((b,j)=>j!==m)),p(v=>v.filter((b,j)=>j!==m))},x=async m=>{if(m.preventDefault(),!!a){i(!0);try{const v=await Qo({tipo:"correctivo",titulo:h.titulo,descripcion:h.descripcion,zoneId:h.zoneId,prioridad:h.prioridad,status:"pendiente",sintomas:h.sintomas?h.sintomas.split(",").map(b=>b.trim()):void 0,fotos:[],reportadoPor:a.id,requiresValidation:!0});c.length>0&&await Promise.all(c.map(b=>ri(v.id,b))),s()}catch(v){console.error("Error creating incident:",v)}finally{i(!1)}}};return e.jsx(Me,{open:!0,onOpenChange:t,children:e.jsxs(Ne,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(Te,{children:e.jsx(Pe,{children:"Reportar Incidencia"})}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"titulo",children:"Título *"}),e.jsx(V,{id:"titulo",value:h.titulo,onChange:m=>f({...h,titulo:m.target.value}),placeholder:"Ej: Fuga de aceite en bomba principal",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"zoneId",children:"Zona *"}),e.jsxs(te,{value:h.zoneId,onValueChange:m=>f({...h,zoneId:m}),children:[e.jsxs(K,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),e.jsx(se,{placeholder:"Seleccionar zona"})]}),e.jsx(J,{children:n.map(m=>e.jsx(P,{value:m.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:m.color||"#2196f3"}}),m.nombre]})},m.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"prioridad",children:"Prioridad *"}),e.jsxs(te,{value:h.prioridad,onValueChange:m=>f({...h,prioridad:m}),children:[e.jsx(K,{children:e.jsx(se,{})}),e.jsxs(J,{children:[e.jsxs(P,{value:"critica",children:[e.jsx("span",{className:"text-destructive font-medium",children:"Crítica"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Detiene producción"})]}),e.jsxs(P,{value:"alta",children:[e.jsx("span",{className:"text-warning font-medium",children:"Alta"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Afecta operación"})]}),e.jsxs(P,{value:"media",children:[e.jsx("span",{className:"text-primary font-medium",children:"Media"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Requiere atención"})]}),e.jsxs(P,{value:"baja",children:[e.jsx("span",{className:"font-medium",children:"Baja"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Puede esperar"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"descripcion",children:"Descripción *"}),e.jsx($e,{id:"descripcion",value:h.descripcion,onChange:m=>f({...h,descripcion:m.target.value}),placeholder:"Describe el problema con el mayor detalle posible...",rows:3,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"sintomas",children:"Síntomas observados"}),e.jsx(V,{id:"sintomas",value:h.sintomas,onChange:m=>f({...h,sintomas:m.target.value}),placeholder:"Ej: Vibración, ruido, calentamiento (separar con comas)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Fotos (máx. 5)"}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[u.map((m,v)=>e.jsxs("div",{className:"relative aspect-square",children:[e.jsx("img",{src:m,alt:`Foto ${v+1}`,className:"w-full h-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>g(v),className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground rounded-full p-0.5",children:e.jsx(nt,{className:"h-3 w-3"})})]},v)),c.length<5&&e.jsxs("button",{type:"button",onClick:()=>{var m;return(m=o.current)==null?void 0:m.click()},className:"aspect-square border-2 border-dashed border-muted rounded-md flex flex-col items-center justify-center text-muted-foreground hover:border-primary hover:text-primary transition-colors",children:[e.jsx(Xs,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Agregar"})]})]}),e.jsx("input",{ref:o,type:"file",accept:"image/*",multiple:!0,onChange:N,className:"hidden",capture:"environment"})]}),e.jsxs(Ke,{children:[e.jsx(E,{type:"button",variant:"outline",onClick:t,children:"Cancelar"}),e.jsx(E,{type:"submit",disabled:r||!h.zoneId,children:r?e.jsxs(e.Fragment,{children:[e.jsx(qe,{size:"sm"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xo,{className:"h-4 w-4 mr-2"}),"Reportar Incidencia"]})})]})]})]})})}const ii={pendiente:{label:"Pendiente de validación",icon:Fe,color:"text-warning"},confirmada:{label:"Confirmada",icon:ye,color:"text-primary"},rechazada:{label:"Rechazada",icon:Bt,color:"text-destructive"},en_proceso:{label:"En proceso",icon:me,color:"text-blue-400"},cerrada:{label:"Cerrada",icon:ye,color:"text-success"}},ci={critica:{label:"Crítica",className:"bg-destructive text-destructive-foreground"},alta:{label:"Alta",className:"bg-warning text-warning-foreground"},media:{label:"Media",className:"bg-primary text-primary-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function li({incident:t,onClose:s,canValidate:a}){const n=Q(L=>L.user),[o,r]=d.useState(!1),[i,c]=d.useState(!1),[l,u]=d.useState(!1),[p,h]=d.useState(""),[f,N]=d.useState(""),[g,x]=d.useState(null),m=ii[t.status],v=ci[t.prioridad],b=m.icon,j=async()=>{if(n){r(!0);try{await ti(t.id,n.id),s()}catch(L){console.error("Error confirming incident:",L)}finally{r(!1)}}},I=async()=>{if(!(!n||!p.trim())){r(!0);try{await si(t.id,n.id,p),s()}catch(L){console.error("Error rejecting incident:",L)}finally{r(!1)}}},O=async()=>{if(f.trim()){r(!0);try{await ai(t.id,f),s()}catch(L){console.error("Error closing incident:",L)}finally{r(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(Me,{open:!0,onOpenChange:s,children:e.jsxs(Ne,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Te,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Pe,{className:"text-xl",children:t.titulo}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Fe,{className:"h-4 w-4"}),Bs(t.createdAt)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:v.className,children:v.label}),e.jsxs(W,{variant:"outline",className:m.color,children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),m.label]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Descripción"}),e.jsx("p",{className:"text-muted-foreground",children:t.descripcion})]}),t.sintomas&&t.sintomas.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Síntomas observados"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.sintomas.map((L,H)=>e.jsx(W,{variant:"outline",children:L},H))})]}),t.fotos.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Xs,{className:"h-4 w-4"}),"Fotos (",t.fotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.fotos.map((L,H)=>e.jsx("img",{src:L,alt:`Foto ${H+1}`,className:"aspect-square object-cover rounded-md cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>x(L)},H))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Zona: ",t.zoneId]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ls,{className:"h-4 w-4"}),e.jsxs("span",{children:["Reportado por: ",t.reportadoPor]})]})]}),t.asignadoA&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ls,{className:"h-4 w-4"}),e.jsxs("span",{children:["Asignado a: ",t.asignadoA]})]})})]}),t.status==="rechazada"&&t.rejectionReason&&e.jsxs("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:[e.jsx("h4",{className:"font-medium text-destructive mb-2",children:"Motivo de rechazo"}),e.jsx("p",{className:"text-sm",children:t.rejectionReason})]}),t.status==="cerrada"&&t.resolucion&&e.jsxs("div",{className:"p-4 bg-success/10 rounded-lg border border-success/20",children:[e.jsx("h4",{className:"font-medium text-success mb-2",children:"Resolución"}),e.jsx("p",{className:"text-sm",children:t.resolucion}),t.tiempoResolucionMinutos&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Tiempo de resolución: ",Math.round(t.tiempoResolucionMinutos/60),"h ",t.tiempoResolucionMinutos%60,"min"]})]}),i&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Rechazar incidencia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"rejectionReason",children:"Motivo del rechazo *"}),e.jsx($e,{id:"rejectionReason",value:p,onChange:L=>h(L.target.value),placeholder:"Explica por qué se rechaza esta incidencia...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(E,{variant:"destructive",onClick:I,disabled:o||!p.trim(),children:o?e.jsx(qe,{size:"sm"}):"Confirmar Rechazo"})]})]}),l&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Cerrar incidencia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"resolution",children:"Resolución aplicada *"}),e.jsx($e,{id:"resolution",value:f,onChange:L=>N(L.target.value),placeholder:"Describe cómo se resolvió el problema...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"outline",onClick:()=>u(!1),children:"Cancelar"}),e.jsx(E,{variant:"success",onClick:O,disabled:o||!f.trim(),children:o?e.jsx(qe,{size:"sm"}):"Cerrar Incidencia"})]})]})]}),e.jsxs(Ke,{className:"flex-wrap gap-2",children:[t.status==="pendiente"&&a&&!i&&e.jsxs(e.Fragment,{children:[e.jsxs(E,{variant:"outline",onClick:()=>c(!0),children:[e.jsx(Bt,{className:"h-4 w-4 mr-2"}),"Rechazar"]}),e.jsx(E,{onClick:j,disabled:o,children:o?e.jsx(qe,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Confirmar"]})})]}),(t.status==="confirmada"||t.status==="en_proceso")&&!l&&e.jsxs(E,{variant:"success",onClick:()=>u(!0),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Cerrar Incidencia"]}),e.jsx(E,{variant:"outline",onClick:s,children:"Cerrar"})]})]})}),g&&e.jsx(Me,{open:!0,onOpenChange:()=>x(null),children:e.jsxs(Ne,{className:"max-w-4xl p-0",children:[e.jsx("button",{onClick:()=>x(null),className:"absolute top-2 right-2 z-10 bg-background/80 rounded-full p-2",children:e.jsx(nt,{className:"h-4 w-4"})}),e.jsx("img",{src:g,alt:"Foto ampliada",className:"w-full h-auto max-h-[80vh] object-contain"})]})})]})}const di={pendiente:{label:"Pendiente",icon:Fe,variant:"warning"},confirmada:{label:"Confirmada",icon:ye,variant:"default"},rechazada:{label:"Rechazada",icon:Bt,variant:"destructive"},en_proceso:{label:"En Proceso",icon:me,variant:"secondary"},cerrada:{label:"Cerrada",icon:ye,variant:"success"}},ui={critica:{label:"Crítica",className:"bg-destructive text-destructive-foreground"},alta:{label:"Alta",className:"bg-warning text-warning-foreground"},media:{label:"Media",className:"bg-primary text-primary-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function mi(){const t=Yr(),{incidents:s,setIncidents:a,selectedIncident:n,setSelectedIncident:o}=He(),[r,i]=d.useState(!1),[c,l]=d.useState(""),[u,p]=d.useState("all"),[h,f]=d.useState("all");d.useEffect(()=>{const x=Ua(m=>{a(m)});return()=>x()},[a]);const N=s.filter(x=>{const m=x.titulo.toLowerCase().includes(c.toLowerCase())||x.descripcion.toLowerCase().includes(c.toLowerCase()),v=u==="all"||x.status===u,b=h==="all"||x.prioridad===h;return m&&v&&b}),g={total:s.length,pendientes:s.filter(x=>x.status==="pendiente").length,enProceso:s.filter(x=>x.status==="en_proceso").length,criticas:s.filter(x=>x.prioridad==="critica"&&x.status!=="cerrada").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Incidencias"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de mantenimiento correctivo"})]}),e.jsxs(E,{onClick:()=>i(!0),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Nueva Incidencia"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:g.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]})}),e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:g.pendientes}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pendientes"})]})}),e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:g.enProceso}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En Proceso"})]})}),e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:g.criticas}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Críticas"})]})})]}),e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Js,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Buscar incidencias...",value:c,onChange:x=>l(x.target.value),className:"pl-9"})]}),e.jsxs(te,{value:u,onValueChange:p,children:[e.jsxs(K,{className:"w-full sm:w-[180px]",children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),e.jsx(se,{placeholder:"Estado"})]}),e.jsxs(J,{children:[e.jsx(P,{value:"all",children:"Todos los estados"}),e.jsx(P,{value:"pendiente",children:"Pendiente"}),e.jsx(P,{value:"confirmada",children:"Confirmada"}),e.jsx(P,{value:"en_proceso",children:"En Proceso"}),e.jsx(P,{value:"cerrada",children:"Cerrada"}),e.jsx(P,{value:"rechazada",children:"Rechazada"})]})]}),e.jsxs(te,{value:h,onValueChange:f,children:[e.jsx(K,{className:"w-full sm:w-[180px]",children:e.jsx(se,{placeholder:"Prioridad"})}),e.jsxs(J,{children:[e.jsx(P,{value:"all",children:"Todas las prioridades"}),e.jsx(P,{value:"critica",children:"Crítica"}),e.jsx(P,{value:"alta",children:"Alta"}),e.jsx(P,{value:"media",children:"Media"}),e.jsx(P,{value:"baja",children:"Baja"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:N.length===0?e.jsx(D,{children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx(me,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No hay incidencias"}),e.jsx("p",{className:"text-muted-foreground",children:c||u!=="all"||h!=="all"?"No se encontraron incidencias con los filtros aplicados":"Comienza creando una nueva incidencia"})]})}):N.map(x=>e.jsx(hi,{incident:x,onClick:()=>o(x)},x.id))}),r&&e.jsx(oi,{onClose:()=>i(!1),onSuccess:()=>i(!1)}),n&&e.jsx(li,{incident:n,onClose:()=>o(null),canValidate:t})]})}function hi({incident:t,onClick:s}){const a=di[t.status],n=ui[t.prioridad],o=a.icon;return e.jsx(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:s,children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(W,{variant:a.variant,className:"gap-1",children:[e.jsx(o,{className:"h-3 w-3"}),a.label]}),e.jsx(W,{className:n.className,children:n.label})]}),e.jsx("h3",{className:"font-medium truncate",children:t.titulo}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.descripcion})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground shrink-0",children:[e.jsx("div",{children:It(t.createdAt)}),t.fotos.length>0&&e.jsxs("div",{className:"text-xs mt-1",children:[t.fotos.length," foto(s)"]})]})]})})})}const st="zones";async function xi(t){const s={...t,createdAt:new Date,updatedAt:new Date};return await Ve(X(F,st,t.id),{...s,createdAt:Y(),updatedAt:Y()}),s}async function qa(t){let s=je(ie(F,st),Ae("id"));return t!=null&&t.nivel&&(s=je(ie(F,st),Ge("nivel","==",t.nivel),Ae("id"))),t!=null&&t.parentId&&(s=je(ie(F,st),Ge("parentId","==",t.parentId),Ae("id"))),(await Re(s)).docs.map(gi)}async function at(){return qa({nivel:1})}async function pi(t){return qa({parentId:t})}async function fi(t){if((await pi(t)).length>0)throw new Error("No se puede eliminar una zona que tiene subzonas");await Ft(X(F,st,t))}function gi(t){const s=t.data();return{...s,id:t.id,createdAt:xs(s.createdAt),updatedAt:xs(s.updatedAt)}}function xs(t){return t?t instanceof be?t.toDate():t instanceof Date?t:new Date(t):new Date}const wt=["#2196f3","#4caf50","#ff9800","#9c27b0","#f44336","#00bcd4","#ffeb3b","#795548"],vi="#2196f3";function ji(){const{user:t}=Q(),{zones:s,setZones:a}=He(),[n,o]=d.useState("select"),[r,i]=d.useState(1),[c,l]=d.useState({x:0,y:0}),[u,p]=d.useState(!1),[h,f]=d.useState({x:0,y:0}),[N,g]=d.useState(!1),[x,m]=d.useState(null),[v,b]=d.useState(!1),[j,I]=d.useState(""),[O,L]=d.useState(wt[0]),[H,le]=d.useState(""),[ne,Ce]=d.useState("/maps/map_1760411932641.png"),[de,C]=d.useState(!1),_=d.useRef(null),ae=d.useRef(null),oe=d.useRef(null),ce=(t==null?void 0:t.rol)==="admin";d.useEffect(()=>{at().then(a)},[a]),d.useEffect(()=>{const w=new Image;w.onload=()=>{oe.current=w,C(!0)},w.onerror=()=>{const S=new Image;S.onload=()=>{oe.current=S,Ce("/maps/map_1763209400991.png"),C(!0)},S.src="/maps/map_1763209400991.png"},w.src=ne},[ne]);const Se=d.useCallback(()=>{const w=_.current,S=w==null?void 0:w.getContext("2d");if(!(!w||!S)){if(S.clearRect(0,0,w.width,w.height),oe.current&&de)S.drawImage(oe.current,0,0,w.width,w.height);else{S.fillStyle="#1a1a1a",S.fillRect(0,0,w.width,w.height),S.strokeStyle="#333",S.lineWidth=1;for(let z=0;z<w.width;z+=50)S.beginPath(),S.moveTo(z,0),S.lineTo(z,w.height),S.stroke();for(let z=0;z<w.height;z+=50)S.beginPath(),S.moveTo(0,z),S.lineTo(w.width,z),S.stroke()}if(s.forEach(z=>{if(z.bounds){const G=z.bounds,xe=G.minX*w.width,pe=G.minY*w.height,fe=(G.maxX-G.minX)*w.width,Le=(G.maxY-G.minY)*w.height;S.fillStyle=`${z.color||"#2196f3"}33`,S.fillRect(xe,pe,fe,Le),S.strokeStyle=z.color||"#2196f3",S.lineWidth=2,S.strokeRect(xe,pe,fe,Le),S.fillStyle="#fff",S.font="bold 14px Inter, sans-serif",S.textAlign="center",S.fillText(z.nombre,xe+fe/2,pe+Le/2),S.font="12px Inter, sans-serif",S.fillStyle=z.color||"#2196f3",S.fillText(z.id,xe+fe/2,pe+Le/2+18)}}),x&&x.points.length>=2){const z=x.points[0],G=x.points[x.points.length-1];if(z&&G){const xe=Math.min(z.x,G.x),pe=Math.min(z.y,G.y),fe=Math.abs(G.x-z.x),Le=Math.abs(G.y-z.y);S.fillStyle=`${x.color}33`,S.fillRect(xe,pe,fe,Le),S.setLineDash([5,5]),S.strokeStyle=x.color,S.lineWidth=2,S.strokeRect(xe,pe,fe,Le),S.setLineDash([])}}}},[s,x,de]);d.useEffect(()=>{Se()},[Se]);const ue=w=>{const S=_.current;if(!S)return{x:0,y:0};const z=S.getBoundingClientRect();return{x:(w.clientX-z.left)/r,y:(w.clientY-z.top)/r}},he=w=>{if(n==="draw"&&ce){const S=ue(w);g(!0),m({points:[S],color:O??vi,nombre:""})}else n==="select"&&(p(!0),f({x:w.clientX-c.x,y:w.clientY-c.y}))},ze=w=>{if(N&&x){const S=ue(w),z=x.points[0];z&&(m({...x,points:[z,S]}),Se())}else u&&n==="select"&&l({x:w.clientX-h.x,y:w.clientY-h.y})},re=()=>{N&&x&&x.points.length>=2&&b(!0),g(!1),p(!1)},y=async()=>{if(!x||x.points.length<2)return;const w=_.current;if(!w)return;const S=x.points[0],z=x.points[1];if(!S||!z)return;const G={minX:Math.min(S.x,z.x)/w.width,minY:Math.min(S.y,z.y)/w.height,maxX:Math.max(S.x,z.x)/w.width,maxY:Math.max(S.y,z.y)/w.height},xe=String.fromCharCode(65+s.length),pe={id:xe,nombre:j||`Zona ${xe}`,descripcion:H,nivel:1,bounds:G,color:O,parentId:null,activa:!0,createdAt:new Date,updatedAt:new Date};try{await xi(pe),await at().then(a),m(null),I(""),le(""),b(!1),o("select")}catch(fe){console.error("Error creando zona:",fe)}},U=async w=>{if(confirm("¿Eliminar esta zona?"))try{await fi(w),await at().then(a)}catch(S){console.error("Error eliminando zona:",S)}},Z=()=>{m(null),b(!1),I(""),le("")},ee=w=>{i(S=>Math.max(.5,Math.min(3,S+w)))},ke=()=>{i(1),l({x:0,y:0})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Herramientas:"}),e.jsxs(E,{variant:n==="select"?"default":"outline",size:"sm",onClick:()=>o("select"),children:[e.jsx(co,{className:"h-4 w-4 mr-1"}),"Seleccionar"]}),ce&&e.jsxs(E,{variant:n==="draw"?"default":"outline",size:"sm",onClick:()=>o("draw"),children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),"Dibujar Zona"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Zoom:"}),e.jsx(E,{variant:"outline",size:"icon",onClick:()=>ee(.25),children:e.jsx(Qs,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"icon",onClick:()=>ee(-.25),children:e.jsx(ea,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"icon",onClick:ke,children:e.jsx(Ks,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-muted-foreground w-16",children:[Math.round(r*100),"%"]})]}),ce&&n==="draw"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Color:"}),wt.map(w=>e.jsx("button",{className:k("w-6 h-6 rounded-full border-2 transition-transform",O===w?"scale-125 border-white":"border-transparent"),style:{backgroundColor:w},onClick:()=>L(w)},w))]})]})})}),e.jsx(D,{className:"overflow-hidden",children:e.jsx(R,{className:"p-0",children:e.jsxs("div",{ref:ae,className:k("relative w-full h-[600px] overflow-hidden bg-muted",n==="select"?"cursor-grab active:cursor-grabbing":"cursor-crosshair"),children:[e.jsx("div",{className:"absolute inset-0 transition-transform duration-100",style:{transform:`translate(${c.x}px, ${c.y}px) scale(${r})`,transformOrigin:"top left"},children:e.jsx("canvas",{ref:_,width:1200,height:600,onMouseDown:he,onMouseMove:ze,onMouseUp:re,onMouseLeave:re})}),n==="draw"&&e.jsx("div",{className:"absolute top-4 left-4 bg-primary/90 text-primary-foreground px-3 py-1 rounded text-sm",children:"🎨 Modo dibujo: Haz click y arrastra para crear una zona"})]})})}),e.jsxs(D,{children:[e.jsx(B,{children:e.jsxs(q,{className:"text-lg flex items-center justify-between",children:[e.jsxs("span",{children:["Zonas (",s.length,")"]}),!de&&e.jsxs(W,{variant:"outline",children:[e.jsx(eo,{className:"h-3 w-3 mr-1"}),"Sin imagen de plano"]})]})}),e.jsx(R,{children:s.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(cs,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"}),ce&&e.jsx("p",{className:"text-sm mt-1",children:'Usa la herramienta "Dibujar Zona" para crear una'})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map(w=>e.jsxs("div",{className:"p-4 rounded-lg border-2 bg-card",style:{borderColor:w.color},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(W,{style:{backgroundColor:w.color},children:w.id}),ce&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>U(w.id),children:e.jsx(pt,{className:"h-3 w-3"})})]}),e.jsx("h4",{className:"font-medium",children:w.nombre}),w.descripcion&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:w.descripcion})]},w.id))})})]}),e.jsx(Me,{open:v,onOpenChange:b,children:e.jsxs(Ne,{children:[e.jsx(Te,{children:e.jsx(Pe,{children:"Nueva Zona"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"zoneName",children:"Nombre de la zona"}),e.jsx(V,{id:"zoneName",value:j,onChange:w=>I(w.target.value),placeholder:"Ej: Área de producción"})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"zoneDescription",children:"Descripción (opcional)"}),e.jsx(V,{id:"zoneDescription",value:H,onChange:w=>le(w.target.value),placeholder:"Descripción de la zona"})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Color"}),e.jsx("div",{className:"flex gap-2 mt-2",children:wt.map(w=>e.jsx("button",{className:k("w-8 h-8 rounded-full border-2 transition-transform",O===w?"scale-110 border-white":"border-transparent"),style:{backgroundColor:w},onClick:()=>L(w)},w))})]})]}),e.jsxs(Ke,{children:[e.jsxs(E,{variant:"outline",onClick:Z,children:[e.jsx(nt,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),e.jsxs(E,{onClick:y,children:[e.jsx(qt,{className:"h-4 w-4 mr-1"}),"Guardar Zona"]})]})]})})]})}function bi(){const{user:t}=Q(),{zones:s,setZones:a,setSelectedZone:n,incidents:o,setIncidents:r}=He(),[i,c]=d.useState("view"),[l]=d.useState("/maps/map_1760411932641.png"),[u,p]=d.useState(1),[h,f]=d.useState({x:0,y:0}),[N,g]=d.useState(!1),[x,m]=d.useState({x:0,y:0}),v=d.useRef(null),b=(t==null?void 0:t.rol)==="admin";d.useEffect(()=>{at().then(a)},[a]),d.useEffect(()=>{const C=Ua(r,{status:["pendiente","confirmada","en_proceso"]});return()=>C()},[r]);const j=o.reduce((C,_)=>(C[_.zoneId]||(C[_.zoneId]=[]),C[_.zoneId].push(_),C),{}),I=C=>{p(_=>Math.max(.5,Math.min(3,_+C)))},O=()=>{p(1),f({x:0,y:0})},L=C=>{C.button===0&&(g(!0),m({x:C.clientX-h.x,y:C.clientY-h.y}))},H=C=>{N&&f({x:C.clientX-x.x,y:C.clientY-x.y})},le=()=>{g(!1)},ne=C=>{const _=C.touches[0];C.touches.length===1&&_&&(g(!0),m({x:_.clientX-h.x,y:_.clientY-h.y}))},Ce=C=>{const _=C.touches[0];N&&C.touches.length===1&&_&&f({x:_.clientX-x.x,y:_.clientY-x.y})},de=()=>{g(!1)};return i==="edit"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Editor de Zonas"}),e.jsx("p",{className:"text-muted-foreground",children:"Dibuja y configura las zonas de la planta"})]}),e.jsxs(E,{variant:"outline",onClick:()=>c("view"),children:[e.jsx(Qn,{className:"h-4 w-4 mr-2"}),"Volver a Vista"]})]}),e.jsx(ji,{})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mapa de Planta"}),e.jsx("p",{className:"text-muted-foreground",children:"Vista general de zonas e incidencias"})]}),e.jsxs("div",{className:"flex gap-2",children:[b&&e.jsxs(E,{variant:"outline",onClick:()=>c("edit"),children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Editar Zonas"]}),e.jsx(E,{variant:"outline",size:"icon",onClick:()=>I(.25),children:e.jsx(Qs,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"icon",onClick:()=>I(-.25),children:e.jsx(ea,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"icon",onClick:O,children:e.jsx(Ks,{className:"h-4 w-4"})})]})]}),e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-destructive"}),e.jsx("span",{children:"Incidencias críticas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-warning"}),e.jsx("span",{children:"Incidencias altas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-primary"}),e.jsx("span",{children:"Incidencias medias"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-success"}),e.jsx("span",{children:"Sin incidencias"})]})]})})}),e.jsx(D,{className:"overflow-hidden",children:e.jsx(R,{className:"p-0",children:e.jsxs("div",{ref:v,className:"relative w-full h-[500px] overflow-hidden bg-muted cursor-grab active:cursor-grabbing",onMouseDown:L,onMouseMove:H,onMouseUp:le,onMouseLeave:le,onTouchStart:ne,onTouchMove:Ce,onTouchEnd:de,children:[e.jsx("div",{className:"absolute transition-transform duration-100",style:{transform:`translate(${h.x}px, ${h.y}px) scale(${u})`,transformOrigin:"top left",width:"100%",height:"100%"},children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:l,alt:"Plano de planta",className:"absolute inset-0 w-full h-full object-contain opacity-50",onError:C=>{C.currentTarget.style.display="none"}}),s.length>0?s.map(C=>e.jsx(yi,{zone:C,incidents:j[C.id]||[],onClick:()=>n(C)},C.id)):e.jsxs("div",{className:"absolute inset-0 grid grid-cols-2 grid-rows-2 gap-2 p-4",children:[e.jsx(ct,{name:"Zona A",color:"#2196f3"}),e.jsx(ct,{name:"Zona B",color:"#4caf50"}),e.jsx(ct,{name:"Zona C",color:"#ff9800"}),e.jsx(ct,{name:"Zona D",color:"#9c27b0"})]})]})}),e.jsxs("div",{className:"absolute bottom-4 right-4 bg-card/80 backdrop-blur px-3 py-1 rounded text-sm",children:["Zoom: ",Math.round(u*100),"%"]})]})})}),s.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map(C=>{const _=j[C.id]||[],ae=_.filter(oe=>oe.prioridad==="critica").length;return e.jsxs(D,{className:k("cursor-pointer hover:border-primary/50 transition-colors",ae>0&&"border-destructive"),onClick:()=>n(C),children:[e.jsx(B,{className:"p-4 pb-2",children:e.jsxs(q,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C.color||"#2196f3"}}),C.nombre]})}),e.jsxs(R,{className:"p-4 pt-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl font-bold",children:_.length}),ae>0&&e.jsxs(W,{variant:"destructive",className:"gap-1",children:[e.jsx(me,{className:"h-3 w-3"}),ae]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"incidencias activas"})]})]},C.id)})})]})}function yi({zone:t,incidents:s,onClick:a}){const n=s.filter(i=>i.prioridad==="critica").length,o=s.filter(i=>i.prioridad==="alta").length;let r="border-success/50 bg-success/10";if(n>0?r="border-destructive bg-destructive/20":o>0?r="border-warning bg-warning/20":s.length>0&&(r="border-primary bg-primary/20"),t.bounds){const i={position:"absolute",left:`${t.bounds.minX*100}%`,top:`${t.bounds.minY*100}%`,width:`${(t.bounds.maxX-t.bounds.minX)*100}%`,height:`${(t.bounds.maxY-t.bounds.minY)*100}%`,borderColor:t.color};return e.jsxs("div",{className:k("rounded-lg border-2 cursor-pointer transition-all hover:scale-[1.02]",r),style:i,onClick:a,children:[e.jsx("div",{className:"absolute top-1 left-1",children:e.jsx(W,{style:{backgroundColor:t.color},className:"text-white text-xs",children:t.id})}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-2",children:[e.jsx("h3",{className:"font-medium text-center text-sm",children:t.nombre}),s.length>0&&e.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[e.jsx(me,{className:"h-3 w-3 text-warning"}),e.jsx("span",{className:"text-xs",children:s.length})]})]}),s.slice(0,3).map((c,l)=>e.jsx("div",{className:k("absolute w-2 h-2 rounded-full animate-pulse",c.prioridad==="critica"?"bg-destructive":c.prioridad==="alta"?"bg-warning":"bg-primary"),style:{top:`${20+l*20}%`,right:`${10+l*10}%`}},c.id))]})}return null}function ct({name:t,color:s}){return e.jsxs("div",{className:"relative rounded-lg border-2 border-dashed p-4 flex flex-col items-center justify-center",style:{borderColor:s,backgroundColor:`${s}10`},children:[e.jsx(Oe,{className:"h-8 w-8 mb-2",style:{color:s}}),e.jsx("h3",{className:"font-medium",children:t}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sin configurar"})]})}const Kt="equipment";async function Ni(t){const s=Vt(),a={...t,id:s,createdAt:new Date,updatedAt:new Date};return await Ve(X(F,Kt,s),{...a,createdAt:Y(),updatedAt:Y()}),a}async function Mt(t){let s=je(ie(F,Kt),Ae("nombre"));return(await Re(s)).docs.map(Ci)}async function wi(t,s){const a=X(F,Kt,t);await Ze(a,{...s,updatedAt:Y()})}function Ci(t){const s=t.data();return{...s,id:t.id,createdAt:Ct(s.createdAt),updatedAt:Ct(s.updatedAt),fechaInstalacion:Ct(s.fechaInstalacion)}}function Ct(t){if(t)return t instanceof be?t.toDate():t instanceof Date?t:new Date(t)}const Si={operativo:{label:"Operativo",className:"bg-success text-success-foreground"},en_mantenimiento:{label:"En Mantenimiento",className:"bg-warning text-warning-foreground"},fuera_servicio:{label:"Fuera de Servicio",className:"bg-destructive text-destructive-foreground"}},ki={alta:{label:"Alta",className:"bg-destructive text-destructive-foreground"},media:{label:"Media",className:"bg-warning text-warning-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function Ei(){const{equipment:t,setEquipment:s,zones:a,setZones:n}=He(),[o,r]=d.useState(!1),[i,c]=d.useState(null),[l,u]=d.useState(""),[p,h]=d.useState("all"),[f,N]=d.useState("all");d.useEffect(()=>{Mt().then(s),at().then(n)},[s,n]);const g=t.filter(j=>{const I=j.nombre.toLowerCase().includes(l.toLowerCase())||j.codigo.toLowerCase().includes(l.toLowerCase()),O=p==="all"||j.zoneId===p,L=f==="all"||j.estado===f;return I&&O&&L}),x={total:t.length,operativos:t.filter(j=>j.estado==="operativo").length,enMantenimiento:t.filter(j=>j.estado==="en_mantenimiento").length,fueraServicio:t.filter(j=>j.estado==="fuera_servicio").length},m=j=>{c(j),r(!0)},v=()=>{r(!1),c(null)},b=async()=>{v();const j=await Mt();s(j)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Equipos"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de activos y máquinas"})]}),e.jsxs(E,{onClick:()=>r(!0),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Nuevo Equipo"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:x.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]})}),e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-success",children:x.operativos}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Operativos"})]})}),e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:x.enMantenimiento}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En Mantenimiento"})]})}),e.jsx(D,{children:e.jsxs(R,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:x.fueraServicio}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Fuera de Servicio"})]})})]}),e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Js,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Buscar por nombre o código...",value:l,onChange:j=>u(j.target.value),className:"pl-9"})]}),e.jsxs(te,{value:p,onValueChange:h,children:[e.jsxs(K,{className:"w-full sm:w-[180px]",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),e.jsx(se,{placeholder:"Zona"})]}),e.jsxs(J,{children:[e.jsx(P,{value:"all",children:"Todas las zonas"}),a.map(j=>e.jsx(P,{value:j.id,children:j.nombre},j.id))]})]}),e.jsxs(te,{value:f,onValueChange:N,children:[e.jsx(K,{className:"w-full sm:w-[180px]",children:e.jsx(se,{placeholder:"Estado"})}),e.jsxs(J,{children:[e.jsx(P,{value:"all",children:"Todos los estados"}),e.jsx(P,{value:"operativo",children:"Operativo"}),e.jsx(P,{value:"en_mantenimiento",children:"En Mantenimiento"}),e.jsx(P,{value:"fuera_servicio",children:"Fuera de Servicio"})]})]})]})})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.length===0?e.jsx(D,{className:"md:col-span-2 lg:col-span-3",children:e.jsxs(R,{className:"p-8 text-center",children:[e.jsx(Ye,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No hay equipos"}),e.jsx("p",{className:"text-muted-foreground",children:l||p!=="all"||f!=="all"?"No se encontraron equipos con los filtros aplicados":"Comienza agregando un nuevo equipo"})]})}):g.map(j=>e.jsx(Ii,{equipment:j,zone:a.find(I=>I.id===j.zoneId),onClick:()=>m(j)},j.id))}),o&&e.jsx(Ai,{equipment:i,zones:a,onClose:v,onSuccess:b})]})}function Ii({equipment:t,zone:s,onClick:a}){const n=Si[t.estado],o=ki[t.criticidad];return e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:a,children:[e.jsx(B,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(q,{className:"text-base",children:t.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:t.codigo})]}),e.jsx(W,{className:n.className,children:n.label})]})}),e.jsx(R,{className:"p-4 pt-2",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[s&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"}),s.nombre]}),t.marca&&e.jsxs("div",{className:"text-muted-foreground",children:[t.marca," ",t.modelo]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Criticidad:"}),e.jsx(W,{variant:"outline",className:o.className,children:o.label})]})]})})]})}function Ai({equipment:t,zones:s,onClose:a,onSuccess:n}){const[o,r]=d.useState(!1),[i,c]=d.useState({codigo:(t==null?void 0:t.codigo)||"",nombre:(t==null?void 0:t.nombre)||"",descripcion:(t==null?void 0:t.descripcion)||"",marca:(t==null?void 0:t.marca)||"",modelo:(t==null?void 0:t.modelo)||"",numeroSerie:(t==null?void 0:t.numeroSerie)||"",zoneId:(t==null?void 0:t.zoneId)||"",criticidad:(t==null?void 0:t.criticidad)||"media",estado:(t==null?void 0:t.estado)||"operativo"}),l=async u=>{u.preventDefault(),r(!0);try{t?await wi(t.id,i):await Ni({...i,zonePath:[i.zoneId],position:{x:0,y:0}}),n()}catch(p){console.error("Error saving equipment:",p)}finally{r(!1)}};return e.jsx(Me,{open:!0,onOpenChange:a,children:e.jsxs(Ne,{className:"max-w-md",children:[e.jsx(Te,{children:e.jsx(Pe,{children:t?"Editar Equipo":"Nuevo Equipo"})}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"codigo",children:"Código *"}),e.jsx(V,{id:"codigo",value:i.codigo,onChange:u=>c({...i,codigo:u.target.value}),placeholder:"EQ-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"zoneId",children:"Zona *"}),e.jsxs(te,{value:i.zoneId,onValueChange:u=>c({...i,zoneId:u}),children:[e.jsx(K,{children:e.jsx(se,{placeholder:"Seleccionar zona"})}),e.jsx(J,{children:s.map(u=>e.jsx(P,{value:u.id,children:u.nombre},u.id))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"nombre",children:"Nombre *"}),e.jsx(V,{id:"nombre",value:i.nombre,onChange:u=>c({...i,nombre:u.target.value}),placeholder:"Bomba centrífuga principal",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"descripcion",children:"Descripción"}),e.jsx($e,{id:"descripcion",value:i.descripcion,onChange:u=>c({...i,descripcion:u.target.value}),placeholder:"Descripción del equipo...",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"marca",children:"Marca"}),e.jsx(V,{id:"marca",value:i.marca,onChange:u=>c({...i,marca:u.target.value}),placeholder:"Siemens"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"modelo",children:"Modelo"}),e.jsx(V,{id:"modelo",value:i.modelo,onChange:u=>c({...i,modelo:u.target.value}),placeholder:"XYZ-100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"criticidad",children:"Criticidad"}),e.jsxs(te,{value:i.criticidad,onValueChange:u=>c({...i,criticidad:u}),children:[e.jsx(K,{children:e.jsx(se,{})}),e.jsxs(J,{children:[e.jsx(P,{value:"alta",children:"Alta"}),e.jsx(P,{value:"media",children:"Media"}),e.jsx(P,{value:"baja",children:"Baja"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"estado",children:"Estado"}),e.jsxs(te,{value:i.estado,onValueChange:u=>c({...i,estado:u}),children:[e.jsx(K,{children:e.jsx(se,{})}),e.jsxs(J,{children:[e.jsx(P,{value:"operativo",children:"Operativo"}),e.jsx(P,{value:"en_mantenimiento",children:"En Mantenimiento"}),e.jsx(P,{value:"fuera_servicio",children:"Fuera de Servicio"})]})]})]})]}),e.jsxs(Ke,{children:[e.jsx(E,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(E,{type:"submit",disabled:o,children:o?"Guardando...":t?"Guardar Cambios":"Crear Equipo"})]})]})]})})}function Di(){const{user:t}=Q(),[s,a]=d.useState("general");if((t==null?void 0:t.rol)!=="admin")return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs(D,{className:"p-8 text-center",children:[e.jsx(uo,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),e.jsx("h2",{className:"text-xl font-bold",children:"Acceso Denegado"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Solo los administradores pueden acceder a esta página."})]})});const n=[{id:"general",label:"General",icon:Zt},{id:"users",label:"Usuarios",icon:fo},{id:"invites",label:"Invitaciones",icon:to},{id:"notifications",label:"Notificaciones",icon:Gn}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Configuración"}),e.jsx("p",{className:"text-muted-foreground",children:"Administra la configuración del sistema"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-border pb-2",children:n.map(o=>e.jsxs(E,{variant:s===o.id?"default":"ghost",onClick:()=>a(o.id),className:"gap-2",children:[e.jsx(o.icon,{className:"h-4 w-4"}),o.label]},o.id))}),s==="general"&&e.jsx(Mi,{}),s==="users"&&e.jsx(Ri,{}),s==="invites"&&e.jsx(Ti,{}),s==="notifications"&&e.jsx(Pi,{})]})}function Mi(){const[t,s]=d.useState(!0),[a,n]=d.useState(!1),[o,r]=d.useState(!1),[i,c]=d.useState(!1),l=async()=>{r(!0);try{await Ve(X(F,"settings","general"),{requireValidation:t,autoAssign:a,updatedAt:Y()},{merge:!0}),c(!0),setTimeout(()=>c(!1),2e3)}catch(u){console.error("Error guardando:",u)}r(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(q,{children:"Flujo de Incidencias"})}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(M,{children:"Validación de Incidencias"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Requiere que un supervisor valide las incidencias reportadas"})]}),e.jsx(_e,{checked:t,onCheckedChange:s})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(M,{children:"Auto-asignación"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Asigna automáticamente incidencias a técnicos disponibles"})]}),e.jsx(_e,{checked:a,onCheckedChange:n})]})]})]}),e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(q,{children:"Prioridades"})}),e.jsx(R,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Tiempo respuesta crítica (min)"}),e.jsx(V,{type:"number",defaultValue:15,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Tiempo respuesta alta (min)"}),e.jsx(V,{type:"number",defaultValue:30,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Tiempo respuesta media (min)"}),e.jsx(V,{type:"number",defaultValue:60,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Tiempo respuesta baja (min)"}),e.jsx(V,{type:"number",defaultValue:120,className:"mt-1"})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{onClick:l,disabled:o,children:o?"Guardando...":i?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Guardado"]}):e.jsxs(e.Fragment,{children:[e.jsx(qt,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})})]})}function Ri(){const[t,s]=d.useState([]),[a,n]=d.useState(!0);d.useEffect(()=>{o()},[]);const o=async()=>{try{const u=(await Re(ie(F,"users"))).docs.map(p=>({id:p.id,...p.data()}));s(u)}catch(l){console.error("Error cargando usuarios:",l)}n(!1)},r=async(l,u)=>{try{await Ze(X(F,"users",l),{activo:!u,updatedAt:Y()}),o()}catch(p){console.error("Error actualizando usuario:",p)}},i=async(l,u)=>{try{await Ze(X(F,"users",l),{rol:u,updatedAt:Y()}),o()}catch(p){console.error("Error actualizando rol:",p)}},c=l=>{const u={admin:{label:"Admin",className:"bg-destructive"},supervisor:{label:"Supervisor",className:"bg-warning"},tecnico:{label:"Técnico",className:"bg-primary"}},{label:p,className:h}=u[l]||u.tecnico;return e.jsx(W,{className:h,children:p})};return a?e.jsx("div",{className:"text-center py-8",children:"Cargando usuarios..."}):e.jsxs(D,{children:[e.jsx(B,{children:e.jsxs(q,{children:["Usuarios del Sistema (",t.length,")"]})}),e.jsx(R,{children:e.jsx("div",{className:"divide-y divide-border",children:t.map(l=>e.jsxs("div",{className:"py-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[l.nombre," ",l.apellido]}),c(l.rol),!l.activo&&e.jsx(W,{variant:"outline",className:"text-destructive",children:"Inactivo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:l.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(te,{value:l.rol,onValueChange:u=>i(l.id,u),children:[e.jsx(K,{className:"w-32",children:e.jsx(se,{})}),e.jsxs(J,{children:[e.jsx(P,{value:"admin",children:"Admin"}),e.jsx(P,{value:"supervisor",children:"Supervisor"}),e.jsx(P,{value:"tecnico",children:"Técnico"})]})]}),e.jsx(_e,{checked:l.activo,onCheckedChange:()=>r(l.id,l.activo)})]})]},l.id))})})]})}function Ti(){const{user:t}=Q(),[s,a]=d.useState([]),[n,o]=d.useState(!0),[r,i]=d.useState(!1),[c,l]=d.useState("tecnico"),[u,p]=d.useState(!1);d.useEffect(()=>{h()},[]);const h=async()=>{try{const v=(await Re(ie(F,"inviteCodes"))).docs.map(b=>({...b.data(),code:b.id}));a(v)}catch(m){console.error("Error cargando invitaciones:",m)}o(!1)},f=()=>Math.random().toString(36).substring(2,8).toUpperCase(),N=async()=>{if(t){p(!0);try{const m=f(),v=new Date;v.setDate(v.getDate()+7),await Ve(X(F,"inviteCodes",m),{rol:c,createdBy:t.id,createdAt:Y(),expiresAt:v,used:!1,usedBy:null,usedAt:null}),i(!1),h()}catch(m){console.error("Error creando invitación:",m)}p(!1)}},g=async m=>{if(confirm("¿Eliminar este código de invitación?"))try{await Ft(X(F,"inviteCodes",m)),h()}catch(v){console.error("Error eliminando invitación:",v)}},x=m=>{navigator.clipboard.writeText(m)};return n?e.jsx("div",{className:"text-center py-8",children:"Cargando invitaciones..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Códigos de Invitación"}),e.jsxs(E,{onClick:()=>i(!0),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Nuevo Código"]})]}),e.jsx(D,{children:e.jsx(R,{className:"p-0",children:s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No hay códigos de invitación activos"}):e.jsx("div",{className:"divide-y divide-border",children:s.map(m=>{const v=m.usosActuales>=m.usosMaximos;return e.jsxs("div",{className:k("p-4 flex items-center justify-between",v&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("code",{className:"bg-muted px-3 py-1 rounded text-lg font-mono",children:m.code}),e.jsxs("div",{children:[e.jsx(W,{variant:"outline",children:m.rol==="admin"?"Admin":m.rol==="supervisor"?"Supervisor":"Técnico"}),v&&e.jsx(W,{className:"ml-2 bg-muted text-muted-foreground",children:"Usado"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!v&&e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>x(m.code),children:e.jsx(Jn,{className:"h-4 w-4"})}),e.jsx(E,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>g(m.code),children:e.jsx(pt,{className:"h-4 w-4"})})]})]},m.code)})})})}),e.jsx(Me,{open:r,onOpenChange:i,children:e.jsxs(Ne,{children:[e.jsx(Te,{children:e.jsx(Pe,{children:"Crear Código de Invitación"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Rol del nuevo usuario"}),e.jsxs(te,{value:c,onValueChange:l,children:[e.jsx(K,{className:"mt-1",children:e.jsx(se,{})}),e.jsxs(J,{children:[e.jsx(P,{value:"tecnico",children:"Técnico"}),e.jsx(P,{value:"supervisor",children:"Supervisor"}),e.jsx(P,{value:"admin",children:"Administrador"})]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"El código expirará en 7 días"})]}),e.jsxs(Ke,{children:[e.jsx(E,{variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(E,{onClick:N,disabled:u,children:u?"Creando...":"Crear Código"})]})]})})]})}function Pi(){const[t,s]=d.useState(!0),[a,n]=d.useState(!1),[o,r]=d.useState(!0),[i,c]=d.useState(!1),[l,u]=d.useState(!1),p=async()=>{c(!0);try{await Ve(X(F,"settings","notifications"),{emailNotifications:t,pushNotifications:a,criticalAlerts:o,updatedAt:Y()},{merge:!0}),u(!0),setTimeout(()=>u(!1),2e3)}catch(h){console.error("Error guardando:",h)}c(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(q,{children:"Notificaciones"})}),e.jsxs(R,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(M,{children:"Notificaciones por Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recibir resumen diario de incidencias"})]}),e.jsx(_e,{checked:t,onCheckedChange:s})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(M,{children:"Notificaciones Push"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recibir alertas en tiempo real (requiere PWA instalada)"})]}),e.jsx(_e,{checked:a,onCheckedChange:n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(M,{children:"Alertas Críticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notificar inmediatamente incidencias críticas"})]}),e.jsx(_e,{checked:o,onCheckedChange:r})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{onClick:p,disabled:i,children:i?"Guardando...":l?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Guardado"]}):e.jsxs(e.Fragment,{children:[e.jsx(qt,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})})]})}const ot="preventiveTasks",Jt="preventiveExecutions";async function Za(t){let s=je(ie(F,ot),Ae("proximaEjecucion","asc"));return(await Re(s)).docs.map(n=>{var o;return{id:n.id,...n.data(),ultimaEjecucion:(o=n.data().ultimaEjecucion)==null?void 0:o.toDate(),proximaEjecucion:n.data().proximaEjecucion.toDate(),createdAt:n.data().createdAt.toDate(),updatedAt:n.data().updatedAt.toDate()}})}async function zi(t){var o;const s=X(F,ot,t),a=await Lt(s);if(!a.exists())return null;const n=a.data();return{id:a.id,...n,ultimaEjecucion:(o=n.ultimaEjecucion)==null?void 0:o.toDate(),proximaEjecucion:n.proximaEjecucion.toDate(),createdAt:n.createdAt.toDate(),updatedAt:n.updatedAt.toDate()}}async function Li(t){return(await Ms(ie(F,ot),{...t,proximaEjecucion:be.fromDate(t.proximaEjecucion),ultimaEjecucion:t.ultimaEjecucion?be.fromDate(t.ultimaEjecucion):null,createdAt:Y(),updatedAt:Y()})).id}async function Ga(t,s){const a=X(F,ot,t),n={...s,updatedAt:Y()};s.proximaEjecucion&&(n.proximaEjecucion=be.fromDate(s.proximaEjecucion)),s.ultimaEjecucion&&(n.ultimaEjecucion=be.fromDate(s.ultimaEjecucion)),await Ze(a,n)}async function Fi(t){await Ft(X(F,ot,t))}async function _i(t){let s=je(ie(F,Jt),Ae("fechaEjecucion","desc"));return(await Re(s)).docs.map(n=>({id:n.id,...n.data(),fechaEjecucion:n.data().fechaEjecucion.toDate()}))}async function Oi(t){const s=await Ms(ie(F,Jt),{...t,fechaEjecucion:be.fromDate(t.fechaEjecucion)}),a=await zi(t.taskId);if(a){const n=new Date(t.fechaEjecucion);n.setDate(n.getDate()+a.frecuenciaDias),await Ga(t.taskId,{ultimaEjecucion:t.fechaEjecucion,proximaEjecucion:n})}return s.id}async function $i(){const t=await Za(),s=new Date,a=t.filter(r=>r.activo&&r.proximaEjecucion<s).length,n=t.filter(r=>{if(!r.activo)return!1;const c=(r.proximaEjecucion.getTime()-s.getTime())/(1e3*60*60*24);return c>0&&c<=7}).length,o=await Vi();return{totalTasks:t.filter(r=>r.activo).length,overdue:a,upcoming7Days:n,completedThisMonth:o.length}}async function Vi(){const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),1),a=je(ie(F,Jt),Ge("fechaEjecucion",">=",be.fromDate(s)),Ae("fechaEjecucion","desc"));return(await Re(a)).docs.map(o=>({id:o.id,...o.data(),fechaEjecucion:o.data().fechaEjecucion.toDate()}))}const Ha=[{value:"inspeccion",label:"Inspección visual"},{value:"lubricacion",label:"Lubricación"},{value:"limpieza",label:"Limpieza"},{value:"calibracion",label:"Calibración"},{value:"cambio_filtro",label:"Cambio de filtro"},{value:"cambio_aceite",label:"Cambio de aceite"},{value:"ajuste",label:"Ajuste/Torque"},{value:"verificacion_electrica",label:"Verificación eléctrica"},{value:"verificacion_neumatica",label:"Verificación neumática"},{value:"revision_seguridad",label:"Revisión de seguridad"},{value:"otro",label:"Otro"}],Ui=[{value:1,label:"Diario"},{value:7,label:"Semanal"},{value:14,label:"Quincenal"},{value:30,label:"Mensual"},{value:60,label:"Bimestral"},{value:90,label:"Trimestral"},{value:180,label:"Semestral"},{value:365,label:"Anual"}];function Bi(){const t=Q(y=>y.user),[s,a]=d.useState([]),[n,o]=d.useState([]),[r,i]=d.useState([]),[c,l]=d.useState(!0),[u,p]=d.useState({totalTasks:0,overdue:0,upcoming7Days:0,completedThisMonth:0}),[h,f]=d.useState(new Date),[N,g]=d.useState(null),[x,m]=d.useState(!1),[v,b]=d.useState(!1),[j,I]=d.useState(null),[O,L]=d.useState(null),[H,le]=d.useState("all");d.useEffect(()=>{ne()},[]);const ne=async()=>{l(!0);try{const[y,U,Z,ee]=await Promise.all([Za(),Mt(),$i(),_i()]);a(y),i(U),p(Z),o(ee)}catch(y){console.error("Error loading data:",y)}finally{l(!1)}},de=(y=>{const U=y.getFullYear(),Z=y.getMonth(),ee=new Date(U,Z,1),w=new Date(U,Z+1,0).getDate(),S=ee.getDay(),z=[];for(let G=0;G<S;G++)z.push(null);for(let G=1;G<=w;G++)z.push(new Date(U,Z,G));return z})(h),C=y=>s.filter(U=>{if(!U.activo)return!1;const Z=new Date(U.proximaEjecucion);return Z.getDate()===y.getDate()&&Z.getMonth()===y.getMonth()&&Z.getFullYear()===y.getFullYear()}),_=d.useMemo(()=>s.filter(y=>!(H!=="all"&&y.equipmentId!==H)),[s,H]),ae=_.filter(y=>y.activo&&y.proximaEjecucion<new Date),oe=_.filter(y=>{if(!y.activo)return!1;const U=new Date,ee=(y.proximaEjecucion.getTime()-U.getTime())/(1e3*60*60*24);return ee>=0&&ee<=7}),ce=()=>{f(new Date(h.getFullYear(),h.getMonth()-1))},Se=()=>{f(new Date(h.getFullYear(),h.getMonth()+1))},ue=async y=>{if(confirm("¿Estás seguro de eliminar esta tarea?"))try{await Fi(y),ne()}catch(U){console.error("Error deleting task:",U)}},he=y=>{const U=new Date;return y.getDate()===U.getDate()&&y.getMonth()===U.getMonth()&&y.getFullYear()===U.getFullYear()},ze=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],re=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mantenimiento Preventivo"}),e.jsx("p",{className:"text-muted-foreground",children:"Planifica y ejecuta tareas de mantenimiento programado"})]}),e.jsxs(Me,{open:x,onOpenChange:m,children:[e.jsx(go,{asChild:!0,children:e.jsxs(E,{onClick:()=>I(null),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Nueva Tarea"]})}),e.jsx(qi,{task:j,equipment:r,onClose:()=>{m(!1),I(null)},onSave:ne})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(is,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tareas"}),e.jsx("p",{className:"text-2xl font-bold",children:u.totalTasks})]})]})})}),e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(me,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vencidas"}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:u.overdue})]})]})})}),e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx(Fe,{className:"h-5 w-5 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Próximos 7 días"}),e.jsx("p",{className:"text-2xl font-bold",children:u.upcoming7Days})]})]})})}),e.jsx(D,{children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(os,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completadas (mes)"}),e.jsx("p",{className:"text-2xl font-bold",children:u.completedThisMonth})]})]})})})]}),e.jsxs(Ho,{defaultValue:"calendar",className:"space-y-4",children:[e.jsxs(Va,{children:[e.jsxs(dt,{value:"calendar",children:[e.jsx(Xn,{className:"h-4 w-4 mr-2"}),"Calendario"]}),e.jsxs(dt,{value:"list",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Lista de Tareas"]}),e.jsxs(dt,{value:"history",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Historial"]})]}),e.jsxs(ut,{value:"calendar",className:"space-y-4",children:[e.jsxs(D,{children:[e.jsxs(B,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{variant:"outline",size:"icon",onClick:ce,children:e.jsx(Wn,{className:"h-4 w-4"})}),e.jsxs(q,{className:"text-lg",children:[ze[h.getMonth()]," ",h.getFullYear()]}),e.jsx(E,{variant:"outline",size:"icon",onClick:Se,children:e.jsx(Yn,{className:"h-4 w-4"})})]}),e.jsxs(te,{value:H,onValueChange:le,children:[e.jsxs(K,{className:"w-48",children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),e.jsx(se,{placeholder:"Filtrar por equipo"})]}),e.jsxs(J,{children:[e.jsx(P,{value:"all",children:"Todos los equipos"}),r.map(y=>e.jsx(P,{value:y.id,children:y.nombre},y.id))]})]})]}),e.jsxs(R,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:re.map(y=>e.jsx("div",{className:"text-center text-sm font-medium text-muted-foreground py-2",children:y},y))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:de.map((y,U)=>{if(!y)return e.jsx("div",{className:"h-24"},`empty-${U}`);const Z=C(y),ee=Z.some(ke=>ke.proximaEjecucion<new Date);return e.jsxs("div",{className:k("h-24 p-1 border rounded-lg overflow-hidden cursor-pointer transition-colors",he(y)&&"bg-primary/5 border-primary",(N==null?void 0:N.toDateString())===y.toDateString()&&"ring-2 ring-primary"),onClick:()=>g(y),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:k("text-sm font-medium",he(y)&&"text-primary"),children:y.getDate()}),ee&&e.jsx(me,{className:"h-3 w-3 text-red-500"})]}),e.jsxs("div",{className:"space-y-0.5 overflow-y-auto max-h-16",children:[Z.slice(0,3).map(ke=>e.jsx("div",{className:k("text-xs px-1 py-0.5 rounded truncate",ke.proximaEjecucion<new Date?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:ke.nombre},ke.id)),Z.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:["+",Z.length-3," más"]})]})]},y.toISOString())})})]})]}),N&&e.jsxs(D,{children:[e.jsx(B,{children:e.jsxs(q,{className:"text-lg",children:["Tareas del ",N.getDate()," de ",ze[N.getMonth()]]})}),e.jsx(R,{children:C(N).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas programadas para este día"}):e.jsx("div",{className:"space-y-2",children:C(N).map(y=>e.jsx(lt,{task:y,equipment:r,onEdit:()=>{I(y),m(!0)},onExecute:()=>{L(y),b(!0)},onDelete:()=>ue(y.id)},y.id))})})]})]}),e.jsxs(ut,{value:"list",className:"space-y-4",children:[ae.length>0&&e.jsxs(D,{className:"border-red-500/50",children:[e.jsx(B,{children:e.jsxs(q,{className:"text-lg flex items-center gap-2 text-red-500",children:[e.jsx(me,{className:"h-5 w-5"}),"Tareas Vencidas (",ae.length,")"]})}),e.jsx(R,{className:"space-y-2",children:ae.map(y=>e.jsx(lt,{task:y,equipment:r,onEdit:()=>{I(y),m(!0)},onExecute:()=>{L(y),b(!0)},onDelete:()=>ue(y.id)},y.id))})]}),e.jsxs(D,{children:[e.jsx(B,{children:e.jsxs(q,{className:"text-lg flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5 text-yellow-500"}),"Próximos 7 días (",oe.length,")"]})}),e.jsx(R,{className:"space-y-2",children:oe.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas programadas para los próximos 7 días"}):oe.map(y=>e.jsx(lt,{task:y,equipment:r,onEdit:()=>{I(y),m(!0)},onExecute:()=>{L(y),b(!0)},onDelete:()=>ue(y.id)},y.id))})]}),e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(q,{className:"text-lg",children:"Todas las Tareas"})}),e.jsx(R,{className:"space-y-2",children:_.filter(y=>y.activo).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas activas"}):_.filter(y=>y.activo).map(y=>e.jsx(lt,{task:y,equipment:r,onEdit:()=>{I(y),m(!0)},onExecute:()=>{L(y),b(!0)},onDelete:()=>ue(y.id)},y.id))})]})]}),e.jsx(ut,{value:"history",children:e.jsxs(D,{children:[e.jsx(B,{children:e.jsx(q,{className:"text-lg",children:"Historial de Ejecuciones"})}),e.jsx(R,{children:n.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No hay ejecuciones registradas"}):e.jsx("div",{className:"space-y-3",children:n.map(y=>{const U=s.find(ee=>ee.id===y.taskId),Z=r.find(ee=>ee.id===y.equipmentId);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(os,{className:"h-4 w-4 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(U==null?void 0:U.nombre)||"Tarea eliminada"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(Z==null?void 0:Z.nombre)||"Equipo"," • ",y.duracionMinutos," min"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm",children:y.fechaEjecucion.toLocaleDateString("es-ES")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:y.fechaEjecucion.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]},y.id)})})})]})})]}),e.jsx(Me,{open:v,onOpenChange:b,children:e.jsx(Ne,{className:"max-w-lg",children:O&&e.jsx(Zi,{task:O,equipment:r,userId:(t==null?void 0:t.id)||"",onClose:()=>{b(!1),L(null)},onSave:ne})})})]})}function lt({task:t,equipment:s,onEdit:a,onExecute:n,onDelete:o}){const r=s.find(l=>l.id===t.equipmentId),i=t.proximaEjecucion<new Date,c=Ha.find(l=>l.value===t.tipo);return e.jsxs("div",{className:k("flex items-center justify-between p-3 rounded-lg border",i?"border-red-500/50 bg-red-500/5":"bg-muted/50"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:k("p-2 rounded-lg",i?"bg-red-500/10":"bg-blue-500/10"),children:e.jsx(Ye,{className:k("h-4 w-4",i?"text-red-500":"text-blue-500")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.nombre}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:(r==null?void 0:r.nombre)||"Sin equipo"}),e.jsx("span",{children:"•"}),e.jsx(W,{variant:"outline",className:"text-xs",children:(c==null?void 0:c.label)||t.tipo})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:["Próxima: ",t.proximaEjecucion.toLocaleDateString("es-ES"),t.ultimaEjecucion&&e.jsxs(e.Fragment,{children:[" • Última: ",t.ultimaEjecucion.toLocaleDateString("es-ES")]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{variant:"ghost",size:"icon",onClick:n,title:"Ejecutar",children:e.jsx(lo,{className:"h-4 w-4 text-green-500"})}),e.jsx(E,{variant:"ghost",size:"icon",onClick:a,title:"Editar",children:e.jsx(mo,{className:"h-4 w-4"})}),e.jsx(E,{variant:"ghost",size:"icon",onClick:o,title:"Eliminar",children:e.jsx(pt,{className:"h-4 w-4 text-destructive"})})]})]})}function qi({task:t,equipment:s,onClose:a,onSave:n}){var N;const o=()=>t!=null&&t.proximaEjecucion?t.proximaEjecucion.toISOString().split("T")[0]||new Date().toISOString().substring(0,10):new Date().toISOString().substring(0,10),[r,i]=d.useState({equipmentId:(t==null?void 0:t.equipmentId)||"",tipo:(t==null?void 0:t.tipo)||"",nombre:(t==null?void 0:t.nombre)||"",descripcion:(t==null?void 0:t.descripcion)||"",frecuenciaDias:(t==null?void 0:t.frecuenciaDias)||30,proximaEjecucion:o(),asignadoA:(t==null?void 0:t.asignadoA)||"",checklist:((N=t==null?void 0:t.checklist)==null?void 0:N.map(g=>({id:g.id,tarea:g.tarea,completado:g.completado})))||[{id:"1",tarea:"",completado:!1}]}),[c,l]=d.useState(!1),u=async g=>{g.preventDefault(),l(!0);try{const x={...r,proximaEjecucion:new Date(r.proximaEjecucion),checklist:r.checklist.filter(m=>m.tarea.trim()!==""),activo:!0};t?await Ga(t.id,x):await Li(x),n(),a()}catch(x){console.error("Error saving task:",x)}finally{l(!1)}},p=()=>{i({...r,checklist:[...r.checklist,{id:String(Date.now()),tarea:"",completado:!1}]})},h=(g,x)=>{const m=[...r.checklist],v=m[g];v&&(m[g]={id:v.id,tarea:x,completado:v.completado},i({...r,checklist:m}))},f=g=>{i({...r,checklist:r.checklist.filter((x,m)=>m!==g)})};return e.jsxs(Ne,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(Te,{children:e.jsx(Pe,{children:t?"Editar Tarea":"Nueva Tarea Preventiva"})}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Equipo *"}),e.jsxs(te,{value:r.equipmentId,onValueChange:g=>i({...r,equipmentId:g}),required:!0,children:[e.jsx(K,{children:e.jsx(se,{placeholder:"Seleccionar equipo"})}),e.jsx(J,{children:s.map(g=>e.jsxs(P,{value:g.id,children:[g.nombre," (",g.codigo,")"]},g.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Tipo de Tarea *"}),e.jsxs(te,{value:r.tipo,onValueChange:g=>i({...r,tipo:g}),required:!0,children:[e.jsx(K,{children:e.jsx(se,{placeholder:"Seleccionar tipo"})}),e.jsx(J,{children:Ha.map(g=>e.jsx(P,{value:g.value,children:g.label},g.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Frecuencia *"}),e.jsxs(te,{value:String(r.frecuenciaDias),onValueChange:g=>i({...r,frecuenciaDias:Number(g)}),children:[e.jsx(K,{children:e.jsx(se,{placeholder:"Seleccionar"})}),e.jsx(J,{children:Ui.map(g=>e.jsx(P,{value:String(g.value),children:g.label},g.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Nombre de la Tarea *"}),e.jsx(V,{value:r.nombre,onChange:g=>i({...r,nombre:g.target.value}),placeholder:"Ej: Lubricación de rodamientos",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Descripción"}),e.jsx($e,{value:r.descripcion,onChange:g=>i({...r,descripcion:g.target.value}),placeholder:"Instrucciones adicionales...",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Próxima Ejecución *"}),e.jsx(V,{type:"date",value:r.proximaEjecucion,onChange:g=>i({...r,proximaEjecucion:g.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Checklist de Tareas"}),e.jsxs("div",{className:"space-y-2",children:[r.checklist.map((g,x)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{value:g.tarea,onChange:m=>h(x,m.target.value),placeholder:`Paso ${x+1}`}),r.checklist.length>1&&e.jsx(E,{type:"button",variant:"ghost",size:"icon",onClick:()=>f(x),children:e.jsx(pt,{className:"h-4 w-4"})})]},g.id)),e.jsxs(E,{type:"button",variant:"outline",size:"sm",onClick:p,children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Agregar paso"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(E,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(E,{type:"submit",disabled:c,children:c?"Guardando...":t?"Actualizar":"Crear Tarea"})]})]})]})}function Zi({task:t,equipment:s,userId:a,onClose:n,onSave:o}){const r=s.find(m=>m.id===t.equipmentId),[i,c]=d.useState(t.checklist.map(m=>({...m,completado:!1,observacion:""}))),[l,u]=d.useState(""),[p,h]=d.useState(30),[f,N]=d.useState(!1),g=i.every(m=>m.completado),x=async m=>{if(m.preventDefault(),!g){alert("Debes completar todas las tareas del checklist");return}N(!0);try{await Oi({taskId:t.id,equipmentId:t.equipmentId,ejecutadoPor:a,fechaEjecucion:new Date,checklistCompletado:i,observaciones:l,fotos:[],duracionMinutos:p}),o(),n()}catch(v){console.error("Error executing task:",v)}finally{N(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Te,{children:e.jsxs(Pe,{children:["Ejecutar: ",t.nombre]})}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:["Equipo: ",e.jsx("span",{className:"font-medium text-foreground",children:r==null?void 0:r.nombre})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Checklist"}),e.jsx("div",{className:"space-y-2 border rounded-lg p-3",children:i.map((m,v)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ga,{id:`check-${m.id}`,checked:m.completado,onCheckedChange:b=>{const j=[...i];j[v]={...m,completado:b},c(j)}}),e.jsx("label",{htmlFor:`check-${m.id}`,className:k("text-sm cursor-pointer",m.completado&&"line-through text-muted-foreground"),children:m.tarea})]}),m.completado&&e.jsx(V,{placeholder:"Observación (opcional)",value:m.observacion,onChange:b=>{const j=[...i];j[v]={...m,observacion:b.target.value},c(j)},className:"ml-6 text-xs h-8"})]},m.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Duración (minutos)"}),e.jsx(V,{type:"number",value:p,onChange:m=>h(Number(m.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:"Observaciones generales"}),e.jsx($e,{value:l,onChange:m=>u(m.target.value),placeholder:"Notas adicionales...",rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(E,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),e.jsx(E,{type:"submit",disabled:f||!g,children:f?"Guardando...":"Completar Ejecución"})]})]})]})}function Gi({children:t}){const{isAuthenticated:s,isLoading:a}=Q();return a?e.jsx(Ea,{}):s?e.jsx(e.Fragment,{children:t}):e.jsx(zt,{to:"/login",replace:!0})}function Hi({children:t}){const{isAuthenticated:s,isLoading:a}=Q();return a?e.jsx(Ea,{}):s?e.jsx(zt,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:t})}function Xi(){const{setUser:t,setLoading:s}=Q();return d.useEffect(()=>{const a=Ur(async n=>{if(n)try{const o=await Rs(n.uid);t(o)}catch(o){console.error("Error fetching user:",o),t(null)}else t(null)});return()=>a()},[t,s]),e.jsx(gr,{children:e.jsxs(vr,{children:[e.jsx(ge,{path:"/login",element:e.jsx(Hi,{children:e.jsx(Yo,{})})}),e.jsxs(ge,{path:"/",element:e.jsx(Gi,{children:e.jsx(Wo,{})}),children:[e.jsx(ge,{index:!0,element:e.jsx(Jo,{})}),e.jsx(ge,{path:"incidents",element:e.jsx(mi,{})}),e.jsx(ge,{path:"map",element:e.jsx(bi,{})}),e.jsx(ge,{path:"equipment",element:e.jsx(Ei,{})}),e.jsx(ge,{path:"preventive",element:e.jsx(Bi,{})}),e.jsx(ge,{path:"settings",element:e.jsx(Di,{})})]}),e.jsx(ge,{path:"*",element:e.jsx(zt,{to:"/",replace:!0})})]})})}zr.createRoot(document.getElementById("root")).render(e.jsx(tt.StrictMode,{children:e.jsx(Xi,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(t=>{console.log("SW registration failed:",t)})});
