import{j as e,c as Vr,O as $t,P as qr,C as Vt,a as Ur,T as qt,D as Ut,R as Br,b as Zr,d as Bt,I as Hr,S as Zt,e as Ht,f as Gr,g as Gt,V as Wr,L as Wt,h as Xt,i as Xr,k as Yr,l as Yt,m as Kr,n as Jr,u as Ss,o as Xs,p as Ys,q as Ae,r as We,s as Kt,t as Jt,v as Qt,w as Qr,x as Vs,y as ea,z as en,A as sn,B as tn,E as an}from"./ui-DkQ0Gqwz.js";import{e as rn,g as nn,d as us,a as l,R as on,r as cn,u as Ks,N as ln,O as dn,B as un,f as mn,h as Ce,i as Js}from"./vendor-BtbATzP-.js";import{i as hn,g as xn,c as pn,d as fn,o as gn,s as jn,e as sa,f as vn,u as bn,h as Ze,j as ee,k as Je,l as yn,m as Qs,q as ke,w as Qe,n as me,p as Oe,r as ae,t as Le,v as Nn,x as wn,T as Ee,y as ks,z as Cn,A as et,B as Sn,C as ta,D as st,E as aa}from"./firebase-CyPWyDAX.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();var js={},Ct;function kn(){if(Ct)return js;Ct=1;var s=rn();return js.createRoot=s.createRoot,js.hydrateRoot=s.hydrateRoot,js}var En=kn();const In=nn(En),An={apiKey:"AIzaSyBsJSh6x3ZGEyuXsM18dSWsJKyU7--KJss",authDomain:"mantenimiento-planta-771a3.firebaseapp.com",projectId:"mantenimiento-planta-771a3",storageBucket:"mantenimiento-planta-771a3.firebasestorage.app",messagingSenderId:"1019421112530",appId:"1:1019421112530:web:9afd9962e0b53152f8d50b"},tt=hn(An),hs=xn(tt),U=pn(tt),Es=fn(tt);async function Mn(s,t){const a=await jn(hs,s,t),n=await ra(a.user.uid);if(!n)throw new Error("Usuario no encontrado en la base de datos");if(!n.activo)throw await sa(hs),new Error("Usuario desactivado. Contacte al administrador.");return n}async function Dn(s,t,a,n,o){const r=await Tn(o);if(!r)throw new Error("Código de invitación inválido o expirado");const i=await vn(hs,s,t);await bn(i.user,{displayName:`${a} ${n}`});const c={id:i.user.uid,email:s,nombre:a,apellido:n,rol:r.rol,activo:!0,createdAt:new Date,updatedAt:new Date};return await Ze(ee(U,"users",i.user.uid),{...c,createdAt:ae(),updatedAt:ae()}),await Je(ee(U,"inviteCodes",r.id),{usosActuales:yn(1)}),c}async function Rn(){await sa(hs)}async function ra(s){var o,r;const t=ee(U,"users",s),a=await Qs(t);if(!a.exists())return null;const n=a.data();return{id:a.id,...n,createdAt:((o=n.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((r=n.updatedAt)==null?void 0:r.toDate())||new Date}}async function Tn(s){var i,c;const t=ke(me(U,"inviteCodes"),Qe("code","==",s.toUpperCase()),Qe("activo","==",!0)),a=await Oe(t);if(a.empty)return null;const n=a.docs[0];if(!n)return null;const o=n.data(),r={id:n.id,code:o.code,rol:o.rol,usosMaximos:o.usosMaximos,usosActuales:o.usosActuales,activo:o.activo,createdBy:o.createdBy,createdAt:((i=o.createdAt)==null?void 0:i.toDate())||new Date,expiresAt:(c=o.expiresAt)==null?void 0:c.toDate()};return r.expiresAt&&r.expiresAt<new Date||r.usosActuales>=r.usosMaximos?null:r}function Pn(s){return gn(hs,s)}const St=s=>{let t;const a=new Set,n=(m,x)=>{const u=typeof m=="function"?m(t):m;if(!Object.is(u,t)){const g=t;t=x??(typeof u!="object"||u===null)?u:Object.assign({},t,u),a.forEach(w=>w(t,g))}},o=()=>t,c={setState:n,getState:o,getInitialState:()=>d,subscribe:m=>(a.add(m),()=>a.delete(m))},d=t=s(n,o,c);return c},zn=(s=>s?St(s):St),Ln=s=>s;function Fn(s,t=Ln){const a=us.useSyncExternalStore(s.subscribe,us.useCallback(()=>t(s.getState()),[s,t]),us.useCallback(()=>t(s.getInitialState()),[s,t]));return us.useDebugValue(a),a}const kt=s=>{const t=zn(s),a=n=>Fn(t,n);return Object.assign(a,t),a},na=(s=>s?kt(s):kt);function _n(s,t){let a;try{a=s()}catch{return}return{getItem:o=>{var r;const i=d=>d===null?null:JSON.parse(d,void 0),c=(r=a.getItem(o))!=null?r:null;return c instanceof Promise?c.then(i):i(c)},setItem:(o,r)=>a.setItem(o,JSON.stringify(r,void 0)),removeItem:o=>a.removeItem(o)}}const qs=s=>t=>{try{const a=s(t);return a instanceof Promise?a:{then(n){return qs(n)(a)},catch(n){return this}}}catch(a){return{then(n){return this},catch(n){return qs(n)(a)}}}},On=(s,t)=>(a,n,o)=>{let r={storage:_n(()=>localStorage),partialize:p=>p,version:0,merge:(p,h)=>({...h,...p}),...t},i=!1;const c=new Set,d=new Set;let m=r.storage;if(!m)return s((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...p)},n,o);const x=()=>{const p=r.partialize({...n()});return m.setItem(r.name,{state:p,version:r.version})},u=o.setState;o.setState=(p,h)=>(u(p,h),x());const g=s((...p)=>(a(...p),x()),n,o);o.getInitialState=()=>g;let w;const b=()=>{var p,h;if(!m)return;i=!1,c.forEach(v=>{var N;return v((N=n())!=null?N:g)});const y=((h=r.onRehydrateStorage)==null?void 0:h.call(r,(p=n())!=null?p:g))||void 0;return qs(m.getItem.bind(m))(r.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==r.version){if(r.migrate){const N=r.migrate(v.state,v.version);return N instanceof Promise?N.then(M=>[!0,M]):[!0,N]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var N;const[M,Z]=v;if(w=r.merge(Z,(N=n())!=null?N:g),a(w,!0),M)return x()}).then(()=>{y==null||y(w,void 0),w=n(),i=!0,d.forEach(v=>v(w))}).catch(v=>{y==null||y(void 0,v)})};return o.persist={setOptions:p=>{r={...r,...p},p.storage&&(m=p.storage)},clearStorage:()=>{m==null||m.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>b(),hasHydrated:()=>i,onHydrate:p=>(c.add(p),()=>{c.delete(p)}),onFinishHydration:p=>(d.add(p),()=>{d.delete(p)})},r.skipHydration||b(),w||g},$n=On,ie=na()($n(s=>({user:null,isAuthenticated:!1,isLoading:!0,setUser:t=>s({user:t,isAuthenticated:!!t,isLoading:!1}),setLoading:t=>s({isLoading:t}),logout:()=>s({user:null,isAuthenticated:!1,isLoading:!1})}),{name:"auth-storage",partialize:s=>({user:s.user,isAuthenticated:s.isAuthenticated})}));function oa(){const s=ie(t=>t.user);return(s==null?void 0:s.rol)==="admin"}function Vn(){const s=ie(t=>t.user);return(s==null?void 0:s.rol)==="supervisor"||(s==null?void 0:s.rol)==="admin"}const ss=na(s=>({incidents:[],selectedIncident:null,setIncidents:t=>s({incidents:t}),setSelectedIncident:t=>s({selectedIncident:t}),addIncident:t=>s(a=>({incidents:[t,...a.incidents]})),updateIncident:(t,a)=>s(n=>({incidents:n.incidents.map(o=>o.id===t?{...o,...a}:o)})),removeIncident:t=>s(a=>({incidents:a.incidents.filter(n=>n.id!==t)})),zones:[],selectedZone:null,setZones:t=>s({zones:t}),setSelectedZone:t=>s({selectedZone:t}),equipment:[],selectedEquipment:null,setEquipment:t=>s({equipment:t}),setSelectedEquipment:t=>s({selectedEquipment:t}),sidebarOpen:!0,toggleSidebar:()=>s(t=>({sidebarOpen:!t.sidebarOpen})),setSidebarOpen:t=>s({sidebarOpen:t}),mapImage:null,setMapImage:t=>s({mapImage:t})}));var qn=Symbol.for("react.lazy"),ws=on[" use ".trim().toString()];function Un(s){return typeof s=="object"&&s!==null&&"then"in s}function ia(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===qn&&"_payload"in s&&Un(s._payload)}function ca(s){const t=Zn(s),a=l.forwardRef((n,o)=>{let{children:r,...i}=n;ia(r)&&typeof ws=="function"&&(r=ws(r._payload));const c=l.Children.toArray(r),d=c.find(Gn);if(d){const m=d.props.children,x=c.map(u=>u===d?l.Children.count(m)>1?l.Children.only(null):l.isValidElement(m)?m.props.children:null:u);return e.jsx(t,{...i,ref:o,children:l.isValidElement(m)?l.cloneElement(m,void 0,x):null})}return e.jsx(t,{...i,ref:o,children:r})});return a.displayName=`${s}.Slot`,a}var Bn=ca("Slot");function Zn(s){const t=l.forwardRef((a,n)=>{let{children:o,...r}=a;if(ia(o)&&typeof ws=="function"&&(o=ws(o._payload)),l.isValidElement(o)){const i=Xn(o),c=Wn(r,o.props);return o.type!==l.Fragment&&(c.ref=n?Vr(n,i):i),l.cloneElement(o,c)}return l.Children.count(o)>1?l.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var Hn=Symbol("radix.slottable");function Gn(s){return l.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Hn}function Wn(s,t){const a={...t};for(const n in t){const o=s[n],r=t[n];/^on[A-Z]/.test(n)?o&&r?a[n]=(...c)=>{const d=r(...c);return o(...c),d}:o&&(a[n]=o):n==="style"?a[n]={...o,...r}:n==="className"&&(a[n]=[o,r].filter(Boolean).join(" "))}return{...s,...a}}function Xn(s){var n,o;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,a=t&&"isReactWarning"in t&&t.isReactWarning;return a?s.ref:(t=(o=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:o.get,a=t&&"isReactWarning"in t&&t.isReactWarning,a?s.props.ref:s.props.ref||s.ref)}function la(s){var t,a,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var o=s.length;for(t=0;t<o;t++)s[t]&&(a=la(s[t]))&&(n&&(n+=" "),n+=a)}else for(a in s)s[a]&&(n&&(n+=" "),n+=a);return n}function da(){for(var s,t,a=0,n="",o=arguments.length;a<o;a++)(s=arguments[a])&&(t=la(s))&&(n&&(n+=" "),n+=t);return n}const Et=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,It=da,at=(s,t)=>a=>{var n;if((t==null?void 0:t.variants)==null)return It(s,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:o,defaultVariants:r}=t,i=Object.keys(o).map(m=>{const x=a==null?void 0:a[m],u=r==null?void 0:r[m];if(x===null)return null;const g=Et(x)||Et(u);return o[m][g]}),c=a&&Object.entries(a).reduce((m,x)=>{let[u,g]=x;return g===void 0||(m[u]=g),m},{}),d=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((m,x)=>{let{class:u,className:g,...w}=x;return Object.entries(w).every(b=>{let[p,h]=b;return Array.isArray(h)?h.includes({...r,...c}[p]):{...r,...c}[p]===h})?[...m,u,g]:m},[]);return It(s,i,d,a==null?void 0:a.class,a==null?void 0:a.className)},rt="-",Yn=s=>{const t=Jn(s),{conflictingClassGroups:a,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:i=>{const c=i.split(rt);return c[0]===""&&c.length!==1&&c.shift(),ua(c,t)||Kn(i)},getConflictingClassGroupIds:(i,c)=>{const d=a[i]||[];return c&&n[i]?[...d,...n[i]]:d}}},ua=(s,t)=>{var i;if(s.length===0)return t.classGroupId;const a=s[0],n=t.nextPart.get(a),o=n?ua(s.slice(1),n):void 0;if(o)return o;if(t.validators.length===0)return;const r=s.join(rt);return(i=t.validators.find(({validator:c})=>c(r)))==null?void 0:i.classGroupId},At=/^\[(.+)\]$/,Kn=s=>{if(At.test(s)){const t=At.exec(s)[1],a=t==null?void 0:t.substring(0,t.indexOf(":"));if(a)return"arbitrary.."+a}},Jn=s=>{const{theme:t,prefix:a}=s,n={nextPart:new Map,validators:[]};return eo(Object.entries(s.classGroups),a).forEach(([r,i])=>{Us(i,n,r,t)}),n},Us=(s,t,a,n)=>{s.forEach(o=>{if(typeof o=="string"){const r=o===""?t:Mt(t,o);r.classGroupId=a;return}if(typeof o=="function"){if(Qn(o)){Us(o(n),t,a,n);return}t.validators.push({validator:o,classGroupId:a});return}Object.entries(o).forEach(([r,i])=>{Us(i,Mt(t,r),a,n)})})},Mt=(s,t)=>{let a=s;return t.split(rt).forEach(n=>{a.nextPart.has(n)||a.nextPart.set(n,{nextPart:new Map,validators:[]}),a=a.nextPart.get(n)}),a},Qn=s=>s.isThemeGetter,eo=(s,t)=>t?s.map(([a,n])=>{const o=n.map(r=>typeof r=="string"?t+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([i,c])=>[t+i,c])):r);return[a,o]}):s,so=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,a=new Map,n=new Map;const o=(r,i)=>{a.set(r,i),t++,t>s&&(t=0,n=a,a=new Map)};return{get(r){let i=a.get(r);if(i!==void 0)return i;if((i=n.get(r))!==void 0)return o(r,i),i},set(r,i){a.has(r)?a.set(r,i):o(r,i)}}},ma="!",to=s=>{const{separator:t,experimentalParseClassName:a}=s,n=t.length===1,o=t[0],r=t.length,i=c=>{const d=[];let m=0,x=0,u;for(let h=0;h<c.length;h++){let y=c[h];if(m===0){if(y===o&&(n||c.slice(h,h+r)===t)){d.push(c.slice(x,h)),x=h+r;continue}if(y==="/"){u=h;continue}}y==="["?m++:y==="]"&&m--}const g=d.length===0?c:c.substring(x),w=g.startsWith(ma),b=w?g.substring(1):g,p=u&&u>x?u-x:void 0;return{modifiers:d,hasImportantModifier:w,baseClassName:b,maybePostfixModifierPosition:p}};return a?c=>a({className:c,parseClassName:i}):i},ao=s=>{if(s.length<=1)return s;const t=[];let a=[];return s.forEach(n=>{n[0]==="["?(t.push(...a.sort(),n),a=[]):a.push(n)}),t.push(...a.sort()),t},ro=s=>({cache:so(s.cacheSize),parseClassName:to(s),...Yn(s)}),no=/\s+/,oo=(s,t)=>{const{parseClassName:a,getClassGroupId:n,getConflictingClassGroupIds:o}=t,r=[],i=s.trim().split(no);let c="";for(let d=i.length-1;d>=0;d-=1){const m=i[d],{modifiers:x,hasImportantModifier:u,baseClassName:g,maybePostfixModifierPosition:w}=a(m);let b=!!w,p=n(b?g.substring(0,w):g);if(!p){if(!b){c=m+(c.length>0?" "+c:c);continue}if(p=n(g),!p){c=m+(c.length>0?" "+c:c);continue}b=!1}const h=ao(x).join(":"),y=u?h+ma:h,v=y+p;if(r.includes(v))continue;r.push(v);const N=o(p,b);for(let M=0;M<N.length;++M){const Z=N[M];r.push(y+Z)}c=m+(c.length>0?" "+c:c)}return c};function io(){let s=0,t,a,n="";for(;s<arguments.length;)(t=arguments[s++])&&(a=ha(t))&&(n&&(n+=" "),n+=a);return n}const ha=s=>{if(typeof s=="string")return s;let t,a="";for(let n=0;n<s.length;n++)s[n]&&(t=ha(s[n]))&&(a&&(a+=" "),a+=t);return a};function co(s,...t){let a,n,o,r=i;function i(d){const m=t.reduce((x,u)=>u(x),s());return a=ro(m),n=a.cache.get,o=a.cache.set,r=c,c(d)}function c(d){const m=n(d);if(m)return m;const x=oo(d,a);return o(d,x),x}return function(){return r(io.apply(null,arguments))}}const W=s=>{const t=a=>a[s]||[];return t.isThemeGetter=!0,t},xa=/^\[(?:([a-z-]+):)?(.+)\]$/i,lo=/^\d+\/\d+$/,uo=new Set(["px","full","screen"]),mo=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ho=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xo=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,po=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fo=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Se=s=>Xe(s)||uo.has(s)||lo.test(s),Pe=s=>ts(s,"length",Co),Xe=s=>!!s&&!Number.isNaN(Number(s)),Ls=s=>ts(s,"number",Xe),cs=s=>!!s&&Number.isInteger(Number(s)),go=s=>s.endsWith("%")&&Xe(s.slice(0,-1)),_=s=>xa.test(s),ze=s=>mo.test(s),jo=new Set(["length","size","percentage"]),vo=s=>ts(s,jo,pa),bo=s=>ts(s,"position",pa),yo=new Set(["image","url"]),No=s=>ts(s,yo,ko),wo=s=>ts(s,"",So),ls=()=>!0,ts=(s,t,a)=>{const n=xa.exec(s);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):a(n[2]):!1},Co=s=>ho.test(s)&&!xo.test(s),pa=()=>!1,So=s=>po.test(s),ko=s=>fo.test(s),Eo=()=>{const s=W("colors"),t=W("spacing"),a=W("blur"),n=W("brightness"),o=W("borderColor"),r=W("borderRadius"),i=W("borderSpacing"),c=W("borderWidth"),d=W("contrast"),m=W("grayscale"),x=W("hueRotate"),u=W("invert"),g=W("gap"),w=W("gradientColorStops"),b=W("gradientColorStopPositions"),p=W("inset"),h=W("margin"),y=W("opacity"),v=W("padding"),N=W("saturate"),M=W("scale"),Z=W("sepia"),T=W("skew"),Q=W("space"),Me=W("translate"),ce=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],le=()=>["auto",_,t],V=()=>[_,t],L=()=>["",Se,Pe],q=()=>["auto",Xe,_],he=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],we=()=>["solid","dashed","dotted","double","none"],De=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>["start","end","center","between","around","evenly","stretch"],ge=()=>["","0",_],je=()=>["auto","avoid","all","avoid-page","page","left","right","column"],de=()=>[Xe,_];return{cacheSize:500,separator:":",theme:{colors:[ls],spacing:[Se,Pe],blur:["none","",ze,_],brightness:de(),borderColor:[s],borderRadius:["none","","full",ze,_],borderSpacing:V(),borderWidth:L(),contrast:de(),grayscale:ge(),hueRotate:de(),invert:ge(),gap:V(),gradientColorStops:[s],gradientColorStopPositions:[go,Pe],inset:le(),margin:le(),opacity:de(),padding:V(),saturate:de(),scale:de(),sepia:ge(),skew:de(),space:V(),translate:V()},classGroups:{aspect:[{aspect:["auto","square","video",_]}],container:["container"],columns:[{columns:[ze]}],"break-after":[{"break-after":je()}],"break-before":[{"break-before":je()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...he(),_]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:ce()}],"overscroll-x":[{"overscroll-x":ce()}],"overscroll-y":[{"overscroll-y":ce()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",cs,_]}],basis:[{basis:le()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",_]}],grow:[{grow:ge()}],shrink:[{shrink:ge()}],order:[{order:["first","last","none",cs,_]}],"grid-cols":[{"grid-cols":[ls]}],"col-start-end":[{col:["auto",{span:["full",cs,_]},_]}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":[ls]}],"row-start-end":[{row:["auto",{span:[cs,_]},_]}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",_]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",_]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...fe()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...fe(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...fe(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[h]}],mx:[{mx:[h]}],my:[{my:[h]}],ms:[{ms:[h]}],me:[{me:[h]}],mt:[{mt:[h]}],mr:[{mr:[h]}],mb:[{mb:[h]}],ml:[{ml:[h]}],"space-x":[{"space-x":[Q]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Q]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",_,t]}],"min-w":[{"min-w":[_,t,"min","max","fit"]}],"max-w":[{"max-w":[_,t,"none","full","min","max","fit","prose",{screen:[ze]},ze]}],h:[{h:[_,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[_,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[_,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[_,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ze,Pe]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ls]}],"font-family":[{font:[ls]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",_]}],"line-clamp":[{"line-clamp":["none",Xe,Ls]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Se,_]}],"list-image":[{"list-image":["none",_]}],"list-style-type":[{list:["none","disc","decimal",_]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[s]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[s]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...we(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Se,Pe]}],"underline-offset":[{"underline-offset":["auto",Se,_]}],"text-decoration-color":[{decoration:[s]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:V()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...he(),bo]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",vo]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},No]}],"bg-color":[{bg:[s]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...we(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:we()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...we()]}],"outline-offset":[{"outline-offset":[Se,_]}],"outline-w":[{outline:[Se,Pe]}],"outline-color":[{outline:[s]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[s]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Se,Pe]}],"ring-offset-color":[{"ring-offset":[s]}],shadow:[{shadow:["","inner","none",ze,wo]}],"shadow-color":[{shadow:[ls]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...De(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":De()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",ze,_]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[x]}],invert:[{invert:[u]}],saturate:[{saturate:[N]}],sepia:[{sepia:[Z]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[x]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[Z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",_]}],duration:[{duration:de()}],ease:[{ease:["linear","in","out","in-out",_]}],delay:[{delay:de()}],animate:[{animate:["none","spin","ping","pulse","bounce",_]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[cs,_]}],"translate-x":[{"translate-x":[Me]}],"translate-y":[{"translate-y":[Me]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",_]}],accent:[{accent:["auto",s]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_]}],"caret-color":[{caret:[s]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_]}],fill:[{fill:[s,"none"]}],"stroke-w":[{stroke:[Se,Pe,Ls]}],stroke:[{stroke:[s,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Io=co(Eo);function k(...s){return Io(da(s))}function fa(s){return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(s))}function Bs(s){const t=new Date,a=new Date(s),n=t.getTime()-a.getTime(),o=Math.floor(n/6e4),r=Math.floor(n/36e5),i=Math.floor(n/864e5);return o<1?"Hace un momento":o<60?`Hace ${o} min`:r<24?`Hace ${r}h`:i<7?`Hace ${i} días`:fa(s)}function nt(){return`${Date.now()}-${Math.random().toString(36).substring(2,9)}`}const Ao=at("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90",warning:"bg-warning text-warning-foreground hover:bg-warning/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),S=l.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...o},r)=>{const i=n?Bn:"button";return e.jsx(i,{className:k(Ao({variant:t,size:a,className:s})),ref:r,...o})});S.displayName="Button";const X=l.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:k("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...a}));X.displayName="Input";var Mo=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Is=Mo.reduce((s,t)=>{const a=ca(`Primitive.${t}`),n=l.forwardRef((o,r)=>{const{asChild:i,...c}=o,d=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:r})});return n.displayName=`Primitive.${t}`,{...s,[t]:n}},{}),Do="Label",ga=l.forwardRef((s,t)=>e.jsx(Is.label,{...s,ref:t,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=s.onMouseDown)==null||o.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));ga.displayName=Do;var ja=ga;const Ro=at("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),R=l.forwardRef(({className:s,...t},a)=>e.jsx(ja,{ref:a,className:k(Ro(),s),...t}));R.displayName=ja.displayName;const D=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:k("rounded-lg border border-border bg-card text-card-foreground shadow-sm",s),...t}));D.displayName="Card";const Y=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:k("flex flex-col space-y-1.5 p-6",s),...t}));Y.displayName="CardHeader";const K=l.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:k("text-2xl font-semibold leading-none tracking-tight",s),...t}));K.displayName="CardTitle";const va=l.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:k("text-sm text-muted-foreground",s),...t}));va.displayName="CardDescription";const z=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:k("p-6 pt-0",s),...t}));z.displayName="CardContent";const To=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:k("flex items-center p-6 pt-0",s),...t}));To.displayName="CardFooter";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ba=(...s)=>s.filter((t,a,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===a).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=l.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:o="",children:r,iconNode:i,...c},d)=>l.createElement("svg",{ref:d,...zo,width:t,height:t,stroke:s,strokeWidth:n?Number(a)*24/Number(t):a,className:ba("lucide",o),...c},[...i.map(([m,x])=>l.createElement(m,x)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=(s,t)=>{const a=l.forwardRef(({className:n,...o},r)=>l.createElement(Lo,{ref:r,iconNode:t,className:ba(`lucide-${Po(s)}`,n),...o}));return a.displayName=`${s}`,a};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=A("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=A("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=A("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=A("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=A("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=A("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=A("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=A("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=A("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=A("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=A("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=A("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=A("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=A("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=A("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=A("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=A("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=A("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=A("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=A("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=A("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=A("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=A("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=A("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=A("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=A("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=A("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=A("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=A("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=A("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=A("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=A("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=A("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=A("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=A("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=A("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=A("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=A("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=A("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=A("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=A("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=A("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=A("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=A("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=A("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=A("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=A("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=A("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),be=Br,ai=Zr,ri=qr,Ta=l.forwardRef(({className:s,...t},a)=>e.jsx($t,{ref:a,className:k("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Ta.displayName=$t.displayName;const pe=l.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(ri,{children:[e.jsx(Ta,{}),e.jsxs(Vt,{ref:n,"aria-describedby":void 0,className:k("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-card p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(Ur,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Cerrar"})]})]})]}));pe.displayName=Vt.displayName;const ye=({className:s,...t})=>e.jsx("div",{className:k("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});ye.displayName="DialogHeader";const rs=({className:s,...t})=>e.jsx("div",{className:k("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});rs.displayName="DialogFooter";const Ne=l.forwardRef(({className:s,...t},a)=>e.jsx(qt,{ref:a,className:k("text-lg font-semibold leading-none tracking-tight",s),...t}));Ne.displayName=qt.displayName;const ni=l.forwardRef(({className:s,...t},a)=>e.jsx(Ut,{ref:a,className:k("text-sm text-muted-foreground",s),...t}));ni.displayName=Ut.displayName;const ne=Kr,oe=Jr,se=l.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(Bt,{ref:n,className:k("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(Hr,{asChild:!0,children:e.jsx(ot,{className:"h-4 w-4 opacity-50"})})]}));se.displayName=Bt.displayName;const Pa=l.forwardRef(({className:s,...t},a)=>e.jsx(Zt,{ref:a,className:k("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx($o,{className:"h-4 w-4"})}));Pa.displayName=Zt.displayName;const za=l.forwardRef(({className:s,...t},a)=>e.jsx(Ht,{ref:a,className:k("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ot,{className:"h-4 w-4"})}));za.displayName=Ht.displayName;const te=l.forwardRef(({className:s,children:t,position:a="popper",...n},o)=>e.jsx(Gr,{children:e.jsxs(Gt,{ref:o,className:k("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...n,children:[e.jsx(Pa,{}),e.jsx(Wr,{className:k("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(za,{})]})}));te.displayName=Gt.displayName;const oi=l.forwardRef(({className:s,...t},a)=>e.jsx(Wt,{ref:a,className:k("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));oi.displayName=Wt.displayName;const F=l.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(Xt,{ref:n,className:k("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Xr,{children:e.jsx(Cs,{className:"h-4 w-4"})})}),e.jsx(Yr,{children:t})]}));F.displayName=Xt.displayName;const ii=l.forwardRef(({className:s,...t},a)=>e.jsx(Yt,{ref:a,className:k("-mx-1 my-1 h-px bg-muted",s),...t}));ii.displayName=Yt.displayName;var Ms="Switch",[ci]=Ys(Ms),[li,di]=ci(Ms),La=l.forwardRef((s,t)=>{const{__scopeSwitch:a,name:n,checked:o,defaultChecked:r,required:i,disabled:c,value:d="on",onCheckedChange:m,form:x,...u}=s,[g,w]=l.useState(null),b=Ss(t,N=>w(N)),p=l.useRef(!1),h=g?x||!!g.closest("form"):!0,[y,v]=Xs({prop:o,defaultProp:r??!1,onChange:m,caller:Ms});return e.jsxs(li,{scope:a,checked:y,disabled:c,children:[e.jsx(Ae.button,{type:"button",role:"switch","aria-checked":y,"aria-required":i,"data-state":$a(y),"data-disabled":c?"":void 0,disabled:c,value:d,...u,ref:b,onClick:We(s.onClick,N=>{v(M=>!M),h&&(p.current=N.isPropagationStopped(),p.current||N.stopPropagation())})}),h&&e.jsx(Oa,{control:g,bubbles:!p.current,name:n,value:d,checked:y,required:i,disabled:c,form:x,style:{transform:"translateX(-100%)"}})]})});La.displayName=Ms;var Fa="SwitchThumb",_a=l.forwardRef((s,t)=>{const{__scopeSwitch:a,...n}=s,o=di(Fa,a);return e.jsx(Ae.span,{"data-state":$a(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:t})});_a.displayName=Fa;var ui="SwitchBubbleInput",Oa=l.forwardRef(({__scopeSwitch:s,control:t,checked:a,bubbles:n=!0,...o},r)=>{const i=l.useRef(null),c=Ss(i,r),d=Kt(a),m=Jt(t);return l.useEffect(()=>{const x=i.current;if(!x)return;const u=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(u,"checked").set;if(d!==a&&w){const b=new Event("click",{bubbles:n});w.call(x,a),x.dispatchEvent(b)}},[d,a,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...o,tabIndex:-1,ref:c,style:{...o.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Oa.displayName=ui;function $a(s){return s?"checked":"unchecked"}var Va=La,mi=_a;const Ue=l.forwardRef(({className:s,...t},a)=>e.jsx(Va,{className:k("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,children:e.jsx(mi,{className:k("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ue.displayName=Va.displayName;var Ds="Checkbox",[hi]=Ys(Ds),[xi,lt]=hi(Ds);function pi(s){const{__scopeCheckbox:t,checked:a,children:n,defaultChecked:o,disabled:r,form:i,name:c,onCheckedChange:d,required:m,value:x="on",internal_do_not_use_render:u}=s,[g,w]=Xs({prop:a,defaultProp:o??!1,onChange:d,caller:Ds}),[b,p]=l.useState(null),[h,y]=l.useState(null),v=l.useRef(!1),N=b?!!i||!!b.closest("form"):!0,M={checked:g,disabled:r,setChecked:w,control:b,setControl:p,name:c,form:i,value:x,hasConsumerStoppedPropagationRef:v,required:m,defaultChecked:Fe(o)?!1:o,isFormControl:N,bubbleInput:h,setBubbleInput:y};return e.jsx(xi,{scope:t,...M,children:fi(u)?u(M):n})}var qa="CheckboxTrigger",Ua=l.forwardRef(({__scopeCheckbox:s,onKeyDown:t,onClick:a,...n},o)=>{const{control:r,value:i,disabled:c,checked:d,required:m,setControl:x,setChecked:u,hasConsumerStoppedPropagationRef:g,isFormControl:w,bubbleInput:b}=lt(qa,s),p=Ss(o,x),h=l.useRef(d);return l.useEffect(()=>{const y=r==null?void 0:r.form;if(y){const v=()=>u(h.current);return y.addEventListener("reset",v),()=>y.removeEventListener("reset",v)}},[r,u]),e.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":Fe(d)?"mixed":d,"aria-required":m,"data-state":Wa(d),"data-disabled":c?"":void 0,disabled:c,value:i,...n,ref:p,onKeyDown:We(t,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:We(a,y=>{u(v=>Fe(v)?!0:!v),b&&w&&(g.current=y.isPropagationStopped(),g.current||y.stopPropagation())})})});Ua.displayName=qa;var dt=l.forwardRef((s,t)=>{const{__scopeCheckbox:a,name:n,checked:o,defaultChecked:r,required:i,disabled:c,value:d,onCheckedChange:m,form:x,...u}=s;return e.jsx(pi,{__scopeCheckbox:a,checked:o,defaultChecked:r,disabled:c,required:i,onCheckedChange:m,name:n,form:x,value:d,internal_do_not_use_render:({isFormControl:g})=>e.jsxs(e.Fragment,{children:[e.jsx(Ua,{...u,ref:t,__scopeCheckbox:a}),g&&e.jsx(Ga,{__scopeCheckbox:a})]})})});dt.displayName=Ds;var Ba="CheckboxIndicator",Za=l.forwardRef((s,t)=>{const{__scopeCheckbox:a,forceMount:n,...o}=s,r=lt(Ba,a);return e.jsx(Qt,{present:n||Fe(r.checked)||r.checked===!0,children:e.jsx(Ae.span,{"data-state":Wa(r.checked),"data-disabled":r.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...s.style}})})});Za.displayName=Ba;var Ha="CheckboxBubbleInput",Ga=l.forwardRef(({__scopeCheckbox:s,...t},a)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:r,defaultChecked:i,required:c,disabled:d,name:m,value:x,form:u,bubbleInput:g,setBubbleInput:w}=lt(Ha,s),b=Ss(a,w),p=Kt(r),h=Jt(n);l.useEffect(()=>{const v=g;if(!v)return;const N=window.HTMLInputElement.prototype,Z=Object.getOwnPropertyDescriptor(N,"checked").set,T=!o.current;if(p!==r&&Z){const Q=new Event("click",{bubbles:T});v.indeterminate=Fe(r),Z.call(v,Fe(r)?!1:r),v.dispatchEvent(Q)}},[g,p,r,o]);const y=l.useRef(Fe(r)?!1:r);return e.jsx(Ae.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??y.current,required:c,disabled:d,name:m,value:x,form:u,...t,tabIndex:-1,ref:b,style:{...t.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ga.displayName=Ha;function fi(s){return typeof s=="function"}function Fe(s){return s==="indeterminate"}function Wa(s){return Fe(s)?"indeterminate":s?"checked":"unchecked"}const Xa=l.forwardRef(({className:s,...t},a)=>e.jsx(dt,{ref:a,className:k("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(Za,{className:k("flex items-center justify-center text-current"),children:e.jsx(Cs,{className:"h-4 w-4"})})}));Xa.displayName=dt.displayName;function gi(s,t=[]){let a=[];function n(r,i){const c=l.createContext(i);c.displayName=r+"Context";const d=a.length;a=[...a,i];const m=u=>{var y;const{scope:g,children:w,...b}=u,p=((y=g==null?void 0:g[s])==null?void 0:y[d])||c,h=l.useMemo(()=>b,Object.values(b));return e.jsx(p.Provider,{value:h,children:w})};m.displayName=r+"Provider";function x(u,g){var p;const w=((p=g==null?void 0:g[s])==null?void 0:p[d])||c,b=l.useContext(w);if(b)return b;if(i!==void 0)return i;throw new Error(`\`${u}\` must be used within \`${r}\``)}return[m,x]}const o=()=>{const r=a.map(i=>l.createContext(i));return function(c){const d=(c==null?void 0:c[s])||r;return l.useMemo(()=>({[`__scope${s}`]:{...c,[s]:d}}),[c,d])}};return o.scopeName=s,[n,ji(o,...t)]}function ji(...s){const t=s[0];if(s.length===1)return t;const a=()=>{const n=s.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(r){const i=n.reduce((c,{useScope:d,scopeName:m})=>{const u=d(r)[`__scope${m}`];return{...c,...u}},{});return l.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return a.scopeName=t.scopeName,a}var Fs={exports:{}},_s={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zt;function vi(){if(zt)return _s;zt=1;var s=cn();function t(u,g){return u===g&&(u!==0||1/u===1/g)||u!==u&&g!==g}var a=typeof Object.is=="function"?Object.is:t,n=s.useState,o=s.useEffect,r=s.useLayoutEffect,i=s.useDebugValue;function c(u,g){var w=g(),b=n({inst:{value:w,getSnapshot:g}}),p=b[0].inst,h=b[1];return r(function(){p.value=w,p.getSnapshot=g,d(p)&&h({inst:p})},[u,w,g]),o(function(){return d(p)&&h({inst:p}),u(function(){d(p)&&h({inst:p})})},[u]),i(w),w}function d(u){var g=u.getSnapshot;u=u.value;try{var w=g();return!a(u,w)}catch{return!0}}function m(u,g){return g()}var x=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:c;return _s.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:x,_s}var Lt;function bi(){return Lt||(Lt=1,Fs.exports=vi()),Fs.exports}var yi=bi();function Ni(){return yi.useSyncExternalStore(wi,()=>!0,()=>!1)}function wi(){return()=>{}}var ut="Avatar",[Ci]=gi(ut),[Si,Ya]=Ci(ut),Ka=l.forwardRef((s,t)=>{const{__scopeAvatar:a,...n}=s,[o,r]=l.useState("idle");return e.jsx(Si,{scope:a,imageLoadingStatus:o,onImageLoadingStatusChange:r,children:e.jsx(Is.span,{...n,ref:t})})});Ka.displayName=ut;var Ja="AvatarImage",Qa=l.forwardRef((s,t)=>{const{__scopeAvatar:a,src:n,onLoadingStatusChange:o=()=>{},...r}=s,i=Ya(Ja,a),c=ki(n,r),d=Qr(m=>{o(m),i.onImageLoadingStatusChange(m)});return Vs(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?e.jsx(Is.img,{...r,ref:t,src:n}):null});Qa.displayName=Ja;var er="AvatarFallback",sr=l.forwardRef((s,t)=>{const{__scopeAvatar:a,delayMs:n,...o}=s,r=Ya(er,a),[i,c]=l.useState(n===void 0);return l.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>c(!0),n);return()=>window.clearTimeout(d)}},[n]),i&&r.imageLoadingStatus!=="loaded"?e.jsx(Is.span,{...o,ref:t}):null});sr.displayName=er;function Ft(s,t){return s?t?(s.src!==t&&(s.src=t),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ki(s,{referrerPolicy:t,crossOrigin:a}){const n=Ni(),o=l.useRef(null),r=n?(o.current||(o.current=new window.Image),o.current):null,[i,c]=l.useState(()=>Ft(r,s));return Vs(()=>{c(Ft(r,s))},[r,s]),Vs(()=>{const d=u=>()=>{c(u)};if(!r)return;const m=d("loaded"),x=d("error");return r.addEventListener("load",m),r.addEventListener("error",x),t&&(r.referrerPolicy=t),typeof a=="string"&&(r.crossOrigin=a),()=>{r.removeEventListener("load",m),r.removeEventListener("error",x)}},[r,a,t]),i}var tr=Ka,ar=Qa,rr=sr;const Hs=l.forwardRef(({className:s,...t},a)=>e.jsx(tr,{ref:a,className:k("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));Hs.displayName=tr.displayName;const Ei=l.forwardRef(({className:s,...t},a)=>e.jsx(ar,{ref:a,className:k("aspect-square h-full w-full",s),...t}));Ei.displayName=ar.displayName;const Gs=l.forwardRef(({className:s,...t},a)=>e.jsx(rr,{ref:a,className:k("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));Gs.displayName=rr.displayName;const Ii=at("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-warning text-warning-foreground hover:bg-warning/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function J({className:s,variant:t,...a}){return e.jsx("div",{className:k(Ii({variant:t}),s),...a})}const _e=l.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:k("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...t}));_e.displayName="Textarea";const Ai={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};function Ye({className:s,size:t="md"}){return e.jsx(Zo,{className:k("animate-spin text-primary",Ai[t],s)})}function nr({message:s="Cargando..."}){return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center justify-center gap-4 bg-background",children:[e.jsx(Ye,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:s})]})}var Rs="Tabs",[Mi]=Ys(Rs,[ea]),or=ea(),[Di,mt]=Mi(Rs),ir=l.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,onValueChange:o,defaultValue:r,orientation:i="horizontal",dir:c,activationMode:d="automatic",...m}=s,x=tn(c),[u,g]=Xs({prop:n,onChange:o,defaultProp:r??"",caller:Rs});return e.jsx(Di,{scope:a,baseId:an(),value:u,onValueChange:g,orientation:i,dir:x,activationMode:d,children:e.jsx(Ae.div,{dir:x,"data-orientation":i,...m,ref:t})})});ir.displayName=Rs;var cr="TabsList",lr=l.forwardRef((s,t)=>{const{__scopeTabs:a,loop:n=!0,...o}=s,r=mt(cr,a),i=or(a);return e.jsx(en,{asChild:!0,...i,orientation:r.orientation,dir:r.dir,loop:n,children:e.jsx(Ae.div,{role:"tablist","aria-orientation":r.orientation,...o,ref:t})})});lr.displayName=cr;var dr="TabsTrigger",ur=l.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,disabled:o=!1,...r}=s,i=mt(dr,a),c=or(a),d=xr(i.baseId,n),m=pr(i.baseId,n),x=n===i.value;return e.jsx(sn,{asChild:!0,...c,focusable:!o,active:x,children:e.jsx(Ae.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":m,"data-state":x?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:d,...r,ref:t,onMouseDown:We(s.onMouseDown,u=>{!o&&u.button===0&&u.ctrlKey===!1?i.onValueChange(n):u.preventDefault()}),onKeyDown:We(s.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&i.onValueChange(n)}),onFocus:We(s.onFocus,()=>{const u=i.activationMode!=="manual";!x&&!o&&u&&i.onValueChange(n)})})})});ur.displayName=dr;var mr="TabsContent",hr=l.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,forceMount:o,children:r,...i}=s,c=mt(mr,a),d=xr(c.baseId,n),m=pr(c.baseId,n),x=n===c.value,u=l.useRef(x);return l.useEffect(()=>{const g=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(g)},[]),e.jsx(Qt,{present:o||x,children:({present:g})=>e.jsx(Ae.div,{"data-state":x?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!g,id:m,tabIndex:0,...i,ref:t,style:{...s.style,animationDuration:u.current?"0s":void 0},children:g&&r})})});hr.displayName=mr;function xr(s,t){return`${s}-trigger-${t}`}function pr(s,t){return`${s}-content-${t}`}var Ri=ir,fr=lr,gr=ur,jr=hr;const Ti=Ri,vr=l.forwardRef(({className:s,...t},a)=>e.jsx(fr,{ref:a,className:k("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));vr.displayName=fr.displayName;const ys=l.forwardRef(({className:s,...t},a)=>e.jsx(gr,{ref:a,className:k("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));ys.displayName=gr.displayName;const Ns=l.forwardRef(({className:s,...t},a)=>e.jsx(jr,{ref:a,className:k("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));Ns.displayName=jr.displayName;const br=l.createContext(null);function ht(){const s=l.useContext(br);if(!s)throw new Error("useHelp must be used within HelpProvider");return s}function Pi({children:s}){const[t,a]=l.useState(!1),[n,o]=l.useState(null),[r,i]=l.useState(()=>localStorage.getItem("help-tour-completed")==="true"),c=()=>{i(!0),localStorage.setItem("help-tour-completed","true")};return e.jsx(br.Provider,{value:{showHelp:t,setShowHelp:a,currentTip:n,setCurrentTip:o,hasSeenTour:r,completeTour:c},children:s})}const zi=[{id:"dashboard",title:"Dashboard",description:"Vista general con estadísticas de incidencias, equipos y alertas críticas. Desde aquí puedes ver el estado general de la planta.",icon:Sa},{id:"incidents",title:"Incidencias",description:"Reporta y gestiona problemas en la planta. Puedes crear nuevas incidencias, filtrar por estado/prioridad y dar seguimiento.",icon:xe},{id:"preventive",title:"Mantenimiento Preventivo",description:"Programa y gestiona tareas de mantenimiento preventivo. Evita fallas configurando revisiones periódicas.",icon:ya},{id:"map",title:"Mapa de Planta",description:"Vista visual de las zonas de la planta. Los colores indican el estado: 🟢 Sin problemas, 🔵 Medio, 🟠 Alto, 🔴 Crítico.",icon:Ea},{id:"equipment",title:"Equipos",description:"Inventario de maquinaria y equipos. Registra información técnica, ubicación y estado de cada equipo.",icon:He},{id:"settings",title:"Configuración",description:"Solo administradores. Gestiona usuarios, zonas, categorías y configuración general del sistema.",icon:As,forAdmin:!0}],Li=[{step:1,title:"Configurar Planta",description:"El administrador sube el plano y crea las zonas de trabajo",tasks:["Subir imagen del plano de planta","Dibujar zonas con la herramienta de polígonos","Asignar nombres y tipos a cada zona"],forAdmin:!0},{step:2,title:"Reportar Incidencias",description:"Los usuarios reportan problemas encontrados",tasks:["Ir a Incidencias → Nueva Incidencia","Seleccionar la zona afectada","Describir el problema y prioridad","Agregar fotos si es necesario"],forAdmin:!1},{step:3,title:"Gestionar Incidencias",description:"Técnicos y supervisores dan seguimiento",tasks:["Revisar incidencias pendientes","Asignar técnico responsable","Actualizar estado (en proceso → resuelta)","Documentar la solución aplicada"],forAdmin:!1},{step:4,title:"Monitorear Estado",description:"Ver el estado general en el mapa",tasks:["El mapa muestra zonas por color según incidencias","Dashboard muestra estadísticas en tiempo real","Alertas críticas aparecen destacadas"],forAdmin:!1}];function Fi(){const{showHelp:s,setShowHelp:t}=ht();return e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>t(!s),className:k("relative",s&&"bg-primary text-primary-foreground"),title:"Ayuda",children:e.jsx(Vo,{className:"h-5 w-5"})})}function _i(){const{showHelp:s,setShowHelp:t,hasSeenTour:a,completeTour:n}=ht(),o=oa(),[r,i]=l.useState("tour"),[c,d]=l.useState(0),m=zi.filter(u=>!u.forAdmin||o),x=Li.filter(u=>!u.forAdmin||o);return e.jsx(be,{open:s,onOpenChange:t,children:e.jsxs(pe,{className:"max-w-2xl max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-5 w-5 text-yellow-500"}),"Centro de Ayuda"]})}),e.jsxs("div",{className:"flex gap-2 border-b pb-2",children:[e.jsx(S,{variant:r==="tour"?"default":"ghost",size:"sm",onClick:()=>i("tour"),children:"Tour de la App"}),e.jsx(S,{variant:r==="workflow"?"default":"ghost",size:"sm",onClick:()=>i("workflow"),children:"Flujo de Trabajo"}),e.jsx(S,{variant:r==="tips"?"default":"ghost",size:"sm",onClick:()=>i("tips"),children:"Tips Rápidos"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r==="tour"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"grid gap-3",children:m.map((u,g)=>e.jsx(D,{className:k("cursor-pointer transition-all hover:border-primary",c===g&&"border-primary bg-primary/5"),onClick:()=>d(g),children:e.jsxs(z,{className:"p-4 flex items-start gap-4",children:[e.jsx("div",{className:k("p-2 rounded-lg",c===g?"bg-primary text-primary-foreground":"bg-muted"),children:e.jsx(u.icon,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:u.title}),u.forAdmin&&e.jsx(J,{variant:"outline",className:"text-xs",children:"Admin"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u.description})]})]})},u.id))}),!a&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(S,{onClick:n,children:[e.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Marcar como visto"]})})]}),r==="workflow"&&e.jsx("div",{className:"space-y-4 py-4",children:x.map((u,g)=>e.jsxs(D,{children:[e.jsx(Y,{className:"pb-2",children:e.jsxs(K,{className:"text-base flex items-center gap-3",children:[e.jsx("span",{className:k("flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold","bg-primary text-primary-foreground"),children:g+1}),u.title,u.forAdmin&&e.jsx(J,{variant:"outline",className:"text-xs",children:"Solo Admin"})]})}),e.jsxs(z,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:u.description}),e.jsx("ul",{className:"space-y-2",children:u.tasks.map((w,b)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(wa,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{children:w})]},b))})]})]},u.step))}),r==="tips"&&e.jsxs("div",{className:"space-y-3 py-4",children:[e.jsx(Ve,{emoji:"🗺️",title:"Colores del Mapa",description:"Verde = sin incidencias, Azul = medias, Naranja = altas, Rojo = críticas"}),e.jsx(Ve,{emoji:"📸",title:"Fotos en Incidencias",description:"Agrega fotos al reportar para documentar mejor el problema"}),e.jsx(Ve,{emoji:"⚡",title:"Prioridades",description:"Usa 'Crítica' solo para problemas que detengan la producción"}),e.jsx(Ve,{emoji:"🔔",title:"Alertas",description:"Las incidencias críticas aparecen destacadas en el Dashboard"}),e.jsx(Ve,{emoji:"📍",title:"Zonas",description:"Haz clic en una zona del mapa para ver sus incidencias activas"}),o&&e.jsxs(e.Fragment,{children:[e.jsx(Ve,{emoji:"✏️",title:"Editar Zonas",description:"Usa 'Editar Zonas' en el mapa para dibujar polígonos punto a punto"}),e.jsx(Ve,{emoji:"🗑️",title:"Eliminar Mapas",description:"En el selector de mapas, pasa el mouse sobre uno para ver el botón de eliminar"})]})]})]})]})})}function Ve({emoji:s,title:t,description:a}){return e.jsx(D,{children:e.jsxs(z,{className:"p-4 flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:s}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]})]})})}function Oi(){const{hasSeenTour:s,setShowHelp:t,completeTour:a}=ht(),[n,o]=l.useState(!s),r=ie(i=>i.user);return s||!n?null:e.jsx(be,{open:n,onOpenChange:o,children:e.jsxs(pe,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"text-center",children:["👋 ¡Bienvenido, ",r==null?void 0:r.nombre,"!"]})}),e.jsxs("div",{className:"text-center space-y-4 py-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"Esta es tu primera vez en el Sistema de Mantenimiento Industrial."}),e.jsx("p",{className:"text-muted-foreground",children:"¿Te gustaría ver un tour rápido de cómo funciona la aplicación?"}),e.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[e.jsx(S,{variant:"outline",onClick:()=>{o(!1),a()},children:"Ahora no"}),e.jsxs(S,{onClick:()=>{o(!1),t(!0)},children:[e.jsx(ka,{className:"h-4 w-4 mr-2"}),"Ver Tour"]})]})]})]})})}const _t=[{name:"Dashboard",href:"/",icon:Sa},{name:"Incidencias",href:"/incidents",icon:xe},{name:"Preventivo",href:"/preventive",icon:ya},{name:"Mapa",href:"/map",icon:Ea},{name:"Equipos",href:"/equipment",icon:He}],$i=[{name:"Configuración",href:"/settings",icon:As}];function Vi(){const s=Ks(),t=ie(u=>u.user),a=ie(u=>u.logout),n=oa(),[o,r]=l.useState(!1),[i,c]=l.useState(!1),d=async()=>{await Rn(),a(),s("/login")},m=t?`${t.nombre.charAt(0)}${t.apellido.charAt(0)}`.toUpperCase():"U",x=n?[..._t,...$i]:_t;return e.jsxs("div",{className:"min-h-screen bg-background",children:[o&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>r(!1)}),e.jsx("aside",{className:k("fixed inset-y-0 left-0 z-50 w-64 bg-card border-r transform transition-transform duration-200 ease-in-out lg:translate-x-0",o?"translate-x-0":"-translate-x-full"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(He,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"font-semibold",children:"Mantenimiento"})]}),e.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 hover:bg-muted rounded",children:e.jsx(es,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:x.map(u=>e.jsxs(ln,{to:u.href,onClick:()=>r(!1),className:({isActive:g})=>k("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",g?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"),children:[e.jsx(u.icon,{className:"h-5 w-5"}),u.name]},u.href))}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!i),className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-muted transition-colors",children:[e.jsx(Hs,{className:"h-8 w-8",children:e.jsx(Gs,{className:"bg-primary/10 text-primary text-xs",children:m})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("p",{className:"text-sm font-medium",children:[t==null?void 0:t.nombre," ",t==null?void 0:t.apellido]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:t==null?void 0:t.rol})]}),e.jsx(ot,{className:k("h-4 w-4 text-muted-foreground transition-transform",i&&"rotate-180")})]}),i&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-card border rounded-lg shadow-lg overflow-hidden",children:e.jsxs("button",{onClick:d,className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-destructive hover:bg-muted transition-colors",children:[e.jsx(Go,{className:"h-4 w-4"}),"Cerrar sesión"]})})]})})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsxs("header",{className:"sticky top-0 z-30 flex items-center h-16 px-4 bg-background/80 backdrop-blur border-b",children:[e.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 -ml-2 hover:bg-muted rounded-lg",children:e.jsx(Wo,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"hidden lg:flex items-center gap-3",children:[e.jsx(Fi,{}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t==null?void 0:t.nombre," ",t==null?void 0:t.apellido]}),e.jsx(Hs,{className:"h-8 w-8",children:e.jsx(Gs,{className:"bg-primary/10 text-primary text-xs",children:m})})]})]}),e.jsx("main",{className:"p-4 lg:p-6",children:e.jsx(dn,{})})]}),e.jsx(_i,{}),e.jsx(Oi,{})]})}function qi(){const s=Ks(),t=ie(N=>N.setUser),[a,n]=l.useState("login"),[o,r]=l.useState(!1),[i,c]=l.useState(null),[d,m]=l.useState(""),[x,u]=l.useState(""),[g,w]=l.useState(""),[b,p]=l.useState(""),[h,y]=l.useState(""),v=async N=>{N.preventDefault(),c(null),r(!0);try{let M;a==="login"?M=await Mn(d,x):M=await Dn(d,x,g,b,h),t(M),s("/")}catch(M){console.error("Auth error:",M),c(Ui(M.code||M.message))}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(D,{className:"w-full max-w-md",children:[e.jsxs(Y,{className:"space-y-1 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:e.jsx(He,{className:"h-8 w-8 text-primary"})})}),e.jsx(K,{className:"text-2xl font-bold",children:"Mantenimiento Industrial"}),e.jsx(va,{children:a==="login"?"Ingresa tus credenciales para continuar":"Registra tu cuenta con el código de invitación"})]}),e.jsxs(z,{children:[e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a==="register"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"nombre",children:"Nombre"}),e.jsx(X,{id:"nombre",placeholder:"Juan",value:g,onChange:N=>w(N.target.value),required:!0,disabled:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"apellido",children:"Apellido"}),e.jsx(X,{id:"apellido",placeholder:"Pérez",value:b,onChange:N=>p(N.target.value),required:!0,disabled:o})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"inviteCode",children:"Código de Invitación"}),e.jsx(X,{id:"inviteCode",placeholder:"XXXX-XXXX",value:h,onChange:N=>y(N.target.value.toUpperCase()),required:!0,disabled:o,className:"uppercase tracking-widest"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(X,{id:"email",type:"email",placeholder:"usuario@empresa.com",value:d,onChange:N=>m(N.target.value),required:!0,disabled:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"password",children:"Contraseña"}),e.jsx(X,{id:"password",type:"password",placeholder:"••••••••",value:x,onChange:N=>u(N.target.value),required:!0,disabled:o,minLength:6})]}),i&&e.jsx("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:i}),e.jsx(S,{type:"submit",className:"w-full",disabled:o,children:o?e.jsx(Ye,{size:"sm"}):a==="login"?e.jsxs(e.Fragment,{children:[e.jsx(Ho,{className:"h-4 w-4"}),"Iniciar Sesión"]}):e.jsxs(e.Fragment,{children:[e.jsx(si,{className:"h-4 w-4"}),"Registrarse"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:()=>{n(a==="login"?"register":"login"),c(null)},className:"text-sm text-muted-foreground hover:text-primary transition-colors",disabled:o,children:a==="login"?"¿Tienes un código de invitación? Regístrate":"¿Ya tienes cuenta? Inicia sesión"})})]})]})})}function Ui(s){return{"auth/invalid-credential":"Credenciales inválidas","auth/invalid-email":"Correo electrónico inválido","auth/user-disabled":"Usuario desactivado","auth/user-not-found":"Usuario no encontrado","auth/wrong-password":"Contraseña incorrecta","auth/email-already-in-use":"Este correo ya está registrado","auth/weak-password":"La contraseña debe tener al menos 6 caracteres","auth/too-many-requests":"Demasiados intentos. Intenta más tarde."}[s]||s}function Bi(){const s=Ks(),t=ie(d=>d.user),{incidents:a,equipment:n,zones:o}=ss(),r={incidentesActivos:a.filter(d=>["pendiente","confirmada","en_proceso"].includes(d.status)).length,incidentesCriticos:a.filter(d=>d.prioridad==="critica"&&d.status!=="cerrada").length,equiposOperativos:n.filter(d=>d.estado==="operativo").length,equiposTotal:n.length,zonasConIncidentes:new Set(a.filter(d=>d.status!=="cerrada").map(d=>d.zoneId)).size},i=a.slice(0,5),c=a.filter(d=>d.prioridad==="critica"&&d.status!=="cerrada");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Bienvenido, ",(t==null?void 0:t.nombre)||"Usuario"]}),e.jsx("p",{className:"text-muted-foreground",children:"Panel de control de mantenimiento industrial"})]}),e.jsxs(S,{onClick:()=>s("/incidents"),children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Nueva Incidencia"]})]}),c.length>0&&e.jsxs(D,{className:"border-destructive bg-destructive/10",children:[e.jsx(Y,{className:"pb-2",children:e.jsxs(K,{className:"text-destructive flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),"Alertas Críticas (",c.length,")"]})}),e.jsx(z,{children:e.jsx("div",{className:"space-y-2",children:c.slice(0,3).map(d=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card rounded cursor-pointer hover:bg-muted",onClick:()=>s("/incidents"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"font-medium",children:d.titulo})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:Bs(d.createdAt)})]},d.id))})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>s("/incidents"),children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Incidencias Activas"}),e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.incidentesActivos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.incidentesCriticos>0&&e.jsxs("span",{className:"text-destructive font-medium",children:[r.incidentesCriticos," críticas"]})})]})]}),e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>s("/equipment"),children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Equipos"}),e.jsx(He,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r.equiposOperativos,"/",r.equiposTotal]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"operativos"})]})]}),e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>s("/map"),children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Zonas"}),e.jsx(Be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.zonasConIncidentes," con incidencias"]})]})]}),e.jsxs(D,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(K,{className:"text-sm font-medium",children:"Tasa Resolución"}),e.jsx(Qo,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.length>0?Math.round(a.filter(d=>d.status==="cerrada").length/a.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"incidencias cerradas"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx(Y,{children:e.jsxs(K,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Últimas Incidencias"}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>s("/incidents"),children:"Ver todas"})]})}),e.jsx(z,{children:i.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ie,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay incidencias recientes"})]}):e.jsx("div",{className:"space-y-4",children:i.map(d=>e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer hover:bg-muted p-2 rounded -mx-2",onClick:()=>s("/incidents"),children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${d.prioridad==="critica"?"bg-destructive":d.prioridad==="alta"?"bg-warning":"bg-primary"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:d.titulo}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.status==="pendiente"&&"Pendiente",d.status==="confirmada"&&"Confirmada",d.status==="en_proceso"&&"En proceso",d.status==="cerrada"&&"Cerrada"]})]}),e.jsx("span",{className:"text-sm text-muted-foreground shrink-0",children:Bs(d.createdAt)})]},d.id))})})]}),e.jsxs(D,{children:[e.jsx(Y,{children:e.jsxs(K,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Incidencias por Zona"}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>s("/map"),children:"Ver mapa"})]})}),e.jsx(z,{children:o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Be,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"})]}):e.jsx("div",{className:"space-y-4",children:o.map(d=>{const m=a.filter(u=>u.zoneId===d.id&&u.status!=="cerrada"),x=m.filter(u=>u.prioridad==="critica").length;return e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer hover:bg-muted p-2 rounded -mx-2",onClick:()=>s("/map"),children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:d.color||"#2196f3"}}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium",children:d.nombre})}),e.jsxs("div",{className:"flex items-center gap-2",children:[x>0&&e.jsx(J,{variant:"destructive",children:x}),e.jsx(J,{variant:"outline",children:m.length})]})]},d.id)})})})]})]})]})}const Ts="incidents";async function Zi(s){const t=nt(),a={...s,id:t,createdAt:new Date,updatedAt:new Date};return await Ze(ee(U,Ts,t),{...a,createdAt:ae(),updatedAt:ae()}),a}async function Hi(s){const t=ee(U,Ts,s),a=await Qs(t);return a.exists()?Nr(a):null}async function xt(s,t){const a=ee(U,Ts,s);await Je(a,{...t,updatedAt:ae()})}async function Gi(s,t){await xt(s,{status:"confirmada",validatedBy:t,validatedAt:new Date,confirmedAt:new Date})}async function Wi(s,t,a){await xt(s,{status:"rechazada",validatedBy:t,validatedAt:new Date,rejectionReason:a})}async function Xi(s,t,a,n){const o=await Hi(s);if(!o)throw new Error("Incidencia no encontrada");const r=new Date,i=o.confirmedAt?Math.round((r.getTime()-o.confirmedAt.getTime())/6e4):void 0;await xt(s,{status:"cerrada",resolucion:t,closedAt:r,tiempoResolucionMinutos:i,repuestosUsados:a,firmaCierre:n})}function yr(s,t){const a=[];t!=null&&t.status&&t.status.length>0&&a.push(Qe("status","in",t.status)),a.push(Le("createdAt","desc")),a.push(Nn(100));const n=ke(me(U,Ts),...a);return wn(n,o=>{const r=o.docs.map(Nr);s(r)})}function Nr(s){const t=s.data();return{...t,id:s.id,createdAt:ds(t.createdAt),updatedAt:ds(t.updatedAt),confirmedAt:ds(t.confirmedAt),closedAt:ds(t.closedAt),validatedAt:ds(t.validatedAt)}}function ds(s){if(s)return s instanceof Ee?s.toDate():s instanceof Date?s:new Date(s)}async function Yi(s,t){const a=t.name.split(".").pop()||"jpg",n=`${nt()}.${a}`,o=ks(Es,`incidents/${s}/${n}`);return await ta(o,t),et(o)}async function Ki(s,t=1920,a=.8){return new Promise((n,o)=>{const r=new Image;r.src=URL.createObjectURL(s),r.onload=()=>{const i=document.createElement("canvas");let{width:c,height:d}=r;c>t&&(d=d*t/c,c=t),i.width=c,i.height=d;const m=i.getContext("2d");if(!m){o(new Error("No se pudo crear contexto de canvas"));return}m.drawImage(r,0,0,c,d),i.toBlob(x=>{if(x){const u=new File([x],s.name,{type:"image/jpeg",lastModified:Date.now()});n(u)}else o(new Error("No se pudo comprimir la imagen"))},"image/jpeg",a),URL.revokeObjectURL(r.src)},r.onerror=()=>{o(new Error("Error cargando imagen"))}})}async function Ji(s){const t=s.name.split(".").pop()||"png",a=`map_${Date.now()}.${t}`,n=ks(Es,`maps/${a}`);return await ta(n,s),et(n)}async function Qi(){try{const s=ks(Es,"maps"),t=await Cn(s);return await Promise.all(t.items.map(n=>et(n)))}catch(s){return console.error("Error obteniendo mapas:",s),[]}}async function ec(s){try{const t=ks(Es,s);await Sn(t)}catch(t){console.error("Error eliminando mapa:",t)}}function sc({onClose:s,onSuccess:t}){const a=ie(h=>h.user),{zones:n}=ss(),o=l.useRef(null),[r,i]=l.useState(!1),[c,d]=l.useState([]),[m,x]=l.useState([]),[u,g]=l.useState({titulo:"",descripcion:"",zoneId:"",prioridad:"media",sintomas:""}),w=async h=>{const y=Array.from(h.target.files||[]);for(const v of y){if(c.length>=5)break;const N=await Ki(v,1920,.8);d(Z=>[...Z,N]);const M=new FileReader;M.onloadend=()=>{x(Z=>[...Z,M.result])},M.readAsDataURL(N)}},b=h=>{d(y=>y.filter((v,N)=>N!==h)),x(y=>y.filter((v,N)=>N!==h))},p=async h=>{if(h.preventDefault(),!!a){i(!0);try{const y=await Zi({tipo:"correctivo",titulo:u.titulo,descripcion:u.descripcion,zoneId:u.zoneId,prioridad:u.prioridad,status:"pendiente",sintomas:u.sintomas?u.sintomas.split(",").map(v=>v.trim()):void 0,fotos:[],reportadoPor:a.id,requiresValidation:!0});c.length>0&&await Promise.all(c.map(v=>Yi(y.id,v))),t()}catch(y){console.error("Error creating incident:",y)}finally{i(!1)}}};return e.jsx(be,{open:!0,onOpenChange:s,children:e.jsxs(pe,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Reportar Incidencia"})}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"titulo",children:"Título *"}),e.jsx(X,{id:"titulo",value:u.titulo,onChange:h=>g({...u,titulo:h.target.value}),placeholder:"Ej: Fuga de aceite en bomba principal",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"zoneId",children:"Zona *"}),e.jsxs(ne,{value:u.zoneId,onValueChange:h=>g({...u,zoneId:h}),children:[e.jsxs(se,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),e.jsx(oe,{placeholder:"Seleccionar zona"})]}),e.jsx(te,{children:n.map(h=>e.jsx(F,{value:h.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:h.color||"#2196f3"}}),h.nombre]})},h.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"prioridad",children:"Prioridad *"}),e.jsxs(ne,{value:u.prioridad,onValueChange:h=>g({...u,prioridad:h}),children:[e.jsx(se,{children:e.jsx(oe,{})}),e.jsxs(te,{children:[e.jsxs(F,{value:"critica",children:[e.jsx("span",{className:"text-destructive font-medium",children:"Crítica"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Detiene producción"})]}),e.jsxs(F,{value:"alta",children:[e.jsx("span",{className:"text-warning font-medium",children:"Alta"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Afecta operación"})]}),e.jsxs(F,{value:"media",children:[e.jsx("span",{className:"text-primary font-medium",children:"Media"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Requiere atención"})]}),e.jsxs(F,{value:"baja",children:[e.jsx("span",{className:"font-medium",children:"Baja"}),e.jsx("span",{className:"text-muted-foreground ml-2",children:"- Puede esperar"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"descripcion",children:"Descripción *"}),e.jsx(_e,{id:"descripcion",value:u.descripcion,onChange:h=>g({...u,descripcion:h.target.value}),placeholder:"Describe el problema con el mayor detalle posible...",rows:3,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"sintomas",children:"Síntomas observados"}),e.jsx(X,{id:"sintomas",value:u.sintomas,onChange:h=>g({...u,sintomas:h.target.value}),placeholder:"Ej: Vibración, ruido, calentamiento (separar con comas)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Fotos (máx. 5)"}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[m.map((h,y)=>e.jsxs("div",{className:"relative aspect-square",children:[e.jsx("img",{src:h,alt:`Foto ${y+1}`,className:"w-full h-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>b(y),className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground rounded-full p-0.5",children:e.jsx(es,{className:"h-3 w-3"})})]},y)),c.length<5&&e.jsxs("button",{type:"button",onClick:()=>{var h;return(h=o.current)==null?void 0:h.click()},className:"aspect-square border-2 border-dashed border-muted rounded-md flex flex-col items-center justify-center text-muted-foreground hover:border-primary hover:text-primary transition-colors",children:[e.jsx(Na,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs mt-1",children:"Agregar"})]})]}),e.jsx("input",{ref:o,type:"file",accept:"image/*",multiple:!0,onChange:w,className:"hidden",capture:"environment"})]}),e.jsxs(rs,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:s,children:"Cancelar"}),e.jsx(S,{type:"submit",disabled:r||!u.zoneId,children:r?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{size:"sm"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Reportar Incidencia"]})})]})]})]})})}const tc={pendiente:{label:"Pendiente de validación",icon:qe,color:"text-warning"},confirmada:{label:"Confirmada",icon:Ie,color:"text-primary"},rechazada:{label:"Rechazada",icon:it,color:"text-destructive"},en_proceso:{label:"En proceso",icon:xe,color:"text-blue-400"},cerrada:{label:"Cerrada",icon:Ie,color:"text-success"}},ac={critica:{label:"Crítica",className:"bg-destructive text-destructive-foreground"},alta:{label:"Alta",className:"bg-warning text-warning-foreground"},media:{label:"Media",className:"bg-primary text-primary-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function rc({incident:s,onClose:t,canValidate:a}){const n=ie(T=>T.user),[o,r]=l.useState(!1),[i,c]=l.useState(!1),[d,m]=l.useState(!1),[x,u]=l.useState(""),[g,w]=l.useState(""),[b,p]=l.useState(null),h=tc[s.status],y=ac[s.prioridad],v=h.icon,N=async()=>{if(n){r(!0);try{await Gi(s.id,n.id),t()}catch(T){console.error("Error confirming incident:",T)}finally{r(!1)}}},M=async()=>{if(!(!n||!x.trim())){r(!0);try{await Wi(s.id,n.id,x),t()}catch(T){console.error("Error rejecting incident:",T)}finally{r(!1)}}},Z=async()=>{if(g.trim()){r(!0);try{await Xi(s.id,g),t()}catch(T){console.error("Error closing incident:",T)}finally{r(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(be,{open:!0,onOpenChange:t,children:e.jsxs(pe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ne,{className:"text-xl",children:s.titulo}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(qe,{className:"h-4 w-4"}),fa(s.createdAt)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:y.className,children:y.label}),e.jsxs(J,{variant:"outline",className:h.color,children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),h.label]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Descripción"}),e.jsx("p",{className:"text-muted-foreground",children:s.descripcion})]}),s.sintomas&&s.sintomas.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Síntomas observados"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.sintomas.map((T,Q)=>e.jsx(J,{variant:"outline",children:T},Q))})]}),s.fotos.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Na,{className:"h-4 w-4"}),"Fotos (",s.fotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.fotos.map((T,Q)=>e.jsx("img",{src:T,alt:`Foto ${Q+1}`,className:"aspect-square object-cover rounded-md cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>p(T)},Q))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsxs("span",{children:["Zona: ",s.zoneId]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs("span",{children:["Reportado por: ",s.reportadoPor]})]})]}),s.asignadoA&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs("span",{children:["Asignado a: ",s.asignadoA]})]})})]}),s.status==="rechazada"&&s.rejectionReason&&e.jsxs("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:[e.jsx("h4",{className:"font-medium text-destructive mb-2",children:"Motivo de rechazo"}),e.jsx("p",{className:"text-sm",children:s.rejectionReason})]}),s.status==="cerrada"&&s.resolucion&&e.jsxs("div",{className:"p-4 bg-success/10 rounded-lg border border-success/20",children:[e.jsx("h4",{className:"font-medium text-success mb-2",children:"Resolución"}),e.jsx("p",{className:"text-sm",children:s.resolucion}),s.tiempoResolucionMinutos&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Tiempo de resolución: ",Math.round(s.tiempoResolucionMinutos/60),"h ",s.tiempoResolucionMinutos%60,"min"]})]}),i&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Rechazar incidencia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"rejectionReason",children:"Motivo del rechazo *"}),e.jsx(_e,{id:"rejectionReason",value:x,onChange:T=>u(T.target.value),placeholder:"Explica por qué se rechaza esta incidencia...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(S,{variant:"destructive",onClick:M,disabled:o||!x.trim(),children:o?e.jsx(Ye,{size:"sm"}):"Confirmar Rechazo"})]})]}),d&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Cerrar incidencia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"resolution",children:"Resolución aplicada *"}),e.jsx(_e,{id:"resolution",value:g,onChange:T=>w(T.target.value),placeholder:"Describe cómo se resolvió el problema...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(S,{variant:"success",onClick:Z,disabled:o||!g.trim(),children:o?e.jsx(Ye,{size:"sm"}):"Cerrar Incidencia"})]})]})]}),e.jsxs(rs,{className:"flex-wrap gap-2",children:[s.status==="pendiente"&&a&&!i&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{variant:"outline",onClick:()=>c(!0),children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Rechazar"]}),e.jsx(S,{onClick:N,disabled:o,children:o?e.jsx(Ye,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Confirmar"]})})]}),(s.status==="confirmada"||s.status==="en_proceso")&&!d&&e.jsxs(S,{variant:"success",onClick:()=>m(!0),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Cerrar Incidencia"]}),e.jsx(S,{variant:"outline",onClick:t,children:"Cerrar"})]})]})}),b&&e.jsx(be,{open:!0,onOpenChange:()=>p(null),children:e.jsxs(pe,{className:"max-w-4xl p-0",children:[e.jsx("button",{onClick:()=>p(null),className:"absolute top-2 right-2 z-10 bg-background/80 rounded-full p-2",children:e.jsx(es,{className:"h-4 w-4"})}),e.jsx("img",{src:b,alt:"Foto ampliada",className:"w-full h-auto max-h-[80vh] object-contain"})]})})]})}const nc={pendiente:{label:"Pendiente",icon:qe,variant:"warning"},confirmada:{label:"Confirmada",icon:Ie,variant:"default"},rechazada:{label:"Rechazada",icon:it,variant:"destructive"},en_proceso:{label:"En Proceso",icon:xe,variant:"secondary"},cerrada:{label:"Cerrada",icon:Ie,variant:"success"}},oc={critica:{label:"Crítica",className:"bg-destructive text-destructive-foreground"},alta:{label:"Alta",className:"bg-warning text-warning-foreground"},media:{label:"Media",className:"bg-primary text-primary-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function ic(){const s=Vn(),{incidents:t,setIncidents:a,selectedIncident:n,setSelectedIncident:o}=ss(),[r,i]=l.useState(!1),[c,d]=l.useState(""),[m,x]=l.useState("all"),[u,g]=l.useState("all");l.useEffect(()=>{const p=yr(h=>{a(h)});return()=>p()},[a]);const w=t.filter(p=>{const h=p.titulo.toLowerCase().includes(c.toLowerCase())||p.descripcion.toLowerCase().includes(c.toLowerCase()),y=m==="all"||p.status===m,v=u==="all"||p.prioridad===u;return h&&y&&v}),b={total:t.length,pendientes:t.filter(p=>p.status==="pendiente").length,enProceso:t.filter(p=>p.status==="en_proceso").length,criticas:t.filter(p=>p.prioridad==="critica"&&p.status!=="cerrada").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Incidencias"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de mantenimiento correctivo"})]}),e.jsxs(S,{onClick:()=>i(!0),children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Nueva Incidencia"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:b.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]})}),e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:b.pendientes}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pendientes"})]})}),e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:b.enProceso}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En Proceso"})]})}),e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:b.criticas}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Críticas"})]})})]}),e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Aa,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(X,{placeholder:"Buscar incidencias...",value:c,onChange:p=>d(p.target.value),className:"pl-9"})]}),e.jsxs(ne,{value:m,onValueChange:x,children:[e.jsxs(se,{className:"w-full sm:w-[180px]",children:[e.jsx(Ca,{className:"h-4 w-4 mr-2"}),e.jsx(oe,{placeholder:"Estado"})]}),e.jsxs(te,{children:[e.jsx(F,{value:"all",children:"Todos los estados"}),e.jsx(F,{value:"pendiente",children:"Pendiente"}),e.jsx(F,{value:"confirmada",children:"Confirmada"}),e.jsx(F,{value:"en_proceso",children:"En Proceso"}),e.jsx(F,{value:"cerrada",children:"Cerrada"}),e.jsx(F,{value:"rechazada",children:"Rechazada"})]})]}),e.jsxs(ne,{value:u,onValueChange:g,children:[e.jsx(se,{className:"w-full sm:w-[180px]",children:e.jsx(oe,{placeholder:"Prioridad"})}),e.jsxs(te,{children:[e.jsx(F,{value:"all",children:"Todas las prioridades"}),e.jsx(F,{value:"critica",children:"Crítica"}),e.jsx(F,{value:"alta",children:"Alta"}),e.jsx(F,{value:"media",children:"Media"}),e.jsx(F,{value:"baja",children:"Baja"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsx(D,{children:e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(xe,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No hay incidencias"}),e.jsx("p",{className:"text-muted-foreground",children:c||m!=="all"||u!=="all"?"No se encontraron incidencias con los filtros aplicados":"Comienza creando una nueva incidencia"})]})}):w.map(p=>e.jsx(cc,{incident:p,onClick:()=>o(p)},p.id))}),r&&e.jsx(sc,{onClose:()=>i(!1),onSuccess:()=>i(!1)}),n&&e.jsx(rc,{incident:n,onClose:()=>o(null),canValidate:s})]})}function cc({incident:s,onClick:t}){const a=nc[s.status],n=oc[s.prioridad],o=a.icon;return e.jsx(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:t,children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(J,{variant:a.variant,className:"gap-1",children:[e.jsx(o,{className:"h-3 w-3"}),a.label]}),e.jsx(J,{className:n.className,children:n.label})]}),e.jsx("h3",{className:"font-medium truncate",children:s.titulo}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.descripcion})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground shrink-0",children:[e.jsx("div",{children:Bs(s.createdAt)}),s.fotos.length>0&&e.jsxs("div",{className:"text-xs mt-1",children:[s.fotos.length," foto(s)"]})]})]})})})}const ms="zones";async function lc(s){const t={...s,createdAt:new Date,updatedAt:new Date};return await Ze(ee(U,ms,s.id),{...t,createdAt:ae(),updatedAt:ae()}),t}async function Ke(s){let t=ke(me(U,ms),Le("id"));return s!=null&&s.nivel&&(t=ke(me(U,ms),Qe("nivel","==",s.nivel),Le("id"))),s!=null&&s.parentId&&(t=ke(me(U,ms),Qe("parentId","==",s.parentId),Le("id"))),(await Oe(t)).docs.map(hc)}async function dc(){return Ke({nivel:1})}async function uc(s){return Ke({parentId:s})}async function mc(s){if((await uc(s)).length>0)throw new Error("No se puede eliminar una zona que tiene subzonas");await st(ee(U,ms,s))}function hc(s){const t=s.data();return{id:s.id,parentId:t.parentId||null,nivel:t.nivel||1,nombre:t.nombre||"",codigo:t.codigo||t.id||"",tipo:t.tipo||"otro",descripcion:t.descripcion||"",polygon:t.polygon||[],bounds:t.bounds||void 0,color:t.color||"#2196f3",activa:t.activa!==!1,createdAt:Ot(t.createdAt),updatedAt:Ot(t.updatedAt)}}function Ot(s){return s?s instanceof Ee?s.toDate():s instanceof Date?s:new Date(s):new Date}const Os="/mantenimiento-planta/";function wr(s){if(s.startsWith("http://")||s.startsWith("https://")||s.startsWith("blob:"))return s;const t=s.startsWith("/")?s:`/${s}`;return`${Os.endsWith("/")?Os.slice(0,-1):Os}${t}`}function Cr(s){return s.includes("firebasestorage.googleapis.com")||s.includes(".firebasestorage.app")}const Ge=[{value:"produccion",label:"Producción",color:"#2196f3",icon:"🏭"},{value:"almacen",label:"Almacén",color:"#4caf50",icon:"📦"},{value:"oficinas",label:"Oficinas",color:"#9c27b0",icon:"🏢"},{value:"mantenimiento",label:"Mantenimiento",color:"#ff9800",icon:"🔧"},{value:"carga_descarga",label:"Carga/Descarga",color:"#795548",icon:"🚚"},{value:"servicios",label:"Servicios",color:"#00bcd4",icon:"🚿"},{value:"seguridad",label:"Seguridad",color:"#f44336",icon:"🛡️"},{value:"maquina",label:"Máquina/Equipo",color:"#ff5722",icon:"⚙️"},{value:"otro",label:"Otro",color:"#607d8b",icon:"📍"}],xc=["#e91e63","#673ab7","#3f51b5","#009688","#8bc34a","#cddc39","#ffc107","#ff5722"];function pc(){var wt;const{user:s}=ie(),{zones:t,setZones:a,mapImage:n,setMapImage:o,equipment:r}=ss(),[i,c]=l.useState("select"),[d,m]=l.useState(1),[x,u]=l.useState({x:0,y:0}),[g,w]=l.useState(!1),[b,p]=l.useState({x:0,y:0}),[h,y]=l.useState(!1),[v,N]=l.useState(null),[M,Z]=l.useState(!1),[T,Q]=l.useState(null),[Me,ce]=l.useState(!1),[$,le]=l.useState({nombre:"",codigo:"",tipo:"produccion",descripcion:"",color:"#2196f3",equipmentId:""}),[V,L]=l.useState(!1),[q,he]=l.useState([]),[we,De]=l.useState(!1),[fe,ge]=l.useState(!1),je=l.useRef(null),de=l.useRef(null),C=l.useRef(null),B=l.useRef(null),H=(s==null?void 0:s.rol)==="admin",[G,Re]=l.useState({width:1400,height:800}),$e=typeof window<"u"&&window.devicePixelRatio||1;l.useEffect(()=>{Ke().then(a),ns()},[a]);const ns=async()=>{try{const j=await Qi();he(j),!n&&j.length>0&&o(j[0])}catch(j){console.error("Error cargando mapas:",j)}};l.useEffect(()=>{if(!n){L(!1);return}const j=new Image;j.crossOrigin="anonymous",j.onload=()=>{C.current=j;const f=1600,E=900;let I=j.naturalWidth,P=j.naturalHeight;I>f&&(P=f/I*P,I=f),P>E&&(I=E/P*I,P=E),Re({width:Math.floor(I),height:Math.floor(P)}),L(!0)},j.onerror=()=>{console.error("Error cargando imagen del mapa"),L(!1)},j.src=Cr(n)?n:wr(n)},[n]);const os=j=>{if(j.length===0)return;let f=1/0,E=1/0,I=-1/0,P=-1/0;return j.forEach(O=>{f=Math.min(f,O.x),E=Math.min(E,O.y),I=Math.max(I,O.x),P=Math.max(P,O.y)}),{minX:f,minY:E,maxX:I,maxY:P}},Te=(j,f)=>{let E=!1;for(let I=0,P=f.length-1;I<f.length;P=I++){const O=f[I],re=f[P];O.y>j.y!=re.y>j.y&&j.x<(re.x-O.x)*(j.y-O.y)/(re.y-O.y)+O.x&&(E=!E)}return E},gt=l.useCallback(()=>{const j=je.current,f=j==null?void 0:j.getContext("2d");if(!j||!f)return;f.setTransform($e,0,0,$e,0,0);const E=G.width,I=G.height;if(f.clearRect(0,0,E,I),C.current&&V)f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(C.current,0,0,E,I);else{f.fillStyle="#1a1a2e",f.fillRect(0,0,E,I),f.strokeStyle="#2a2a4e",f.lineWidth=1;const P=50;for(let O=0;O<=E;O+=P)f.beginPath(),f.moveTo(O,0),f.lineTo(O,I),f.stroke();for(let O=0;O<=I;O+=P)f.beginPath(),f.moveTo(0,O),f.lineTo(E,O),f.stroke();f.fillStyle="#666",f.font="18px Inter, sans-serif",f.textAlign="center",f.fillText("Sube una imagen del plano para comenzar",E/2,I/2)}if(t.forEach(P=>{if(!P.polygon||P.polygon.length<3)return;const O=(T==null?void 0:T.id)===P.id,re=P.color||"#2196f3",ve=P.polygon.map(ue=>({x:ue.x*E,y:ue.y*I}));f.beginPath(),f.moveTo(ve[0].x,ve[0].y),ve.slice(1).forEach(ue=>f.lineTo(ue.x,ue.y)),f.closePath(),f.fillStyle=O?`${re}55`:`${re}33`,f.fill(),f.strokeStyle=re,f.lineWidth=O?3:2,f.stroke();const fs=ve.reduce((ue,zs)=>ue+zs.x,0)/ve.length,gs=ve.reduce((ue,zs)=>ue+zs.y,0)/ve.length,Ps=Ge.find(ue=>ue.value===P.tipo);f.fillStyle="#fff",f.font="bold 14px Inter, sans-serif",f.textAlign="center",f.shadowColor="rgba(0,0,0,0.8)",f.shadowBlur=4,f.fillText(`${(Ps==null?void 0:Ps.icon)||"📍"} ${P.codigo}`,fs,gs-8),f.font="12px Inter, sans-serif",f.fillText(P.nombre,fs,gs+10),f.shadowBlur=0,O&&ve.forEach(ue=>{f.beginPath(),f.arc(ue.x,ue.y,6,0,Math.PI*2),f.fillStyle=re,f.fill(),f.strokeStyle="#fff",f.lineWidth=2,f.stroke()})}),v&&v.points.length>0){const P=v.points.map(O=>({x:O.x*E,y:O.y*I}));f.beginPath(),f.moveTo(P[0].x,P[0].y),P.slice(1).forEach(O=>f.lineTo(O.x,O.y)),f.strokeStyle=$.color,f.lineWidth=2,f.setLineDash([5,5]),f.stroke(),f.setLineDash([]),P.forEach((O,re)=>{f.beginPath(),f.arc(O.x,O.y,re===0?10:6,0,Math.PI*2),re===0&&M&&P.length>=3?(f.fillStyle="#4caf50",f.strokeStyle="#fff",f.lineWidth=3):(f.fillStyle=re===0?$.color:"#fff",f.strokeStyle=$.color,f.lineWidth=2),f.fill(),f.stroke(),f.fillStyle=re===0?"#fff":$.color,f.font="bold 10px Inter, sans-serif",f.textAlign="center",f.textBaseline="middle",f.fillText(`${re+1}`,O.x,O.y)}),P.length>=3&&(f.fillStyle="#4caf50",f.font="14px Inter, sans-serif",f.textAlign="left",f.fillText("✓ Click en punto 1 para cerrar el polígono",20,I-20))}},[t,v,M,V,T,$.color,G,$e]);l.useEffect(()=>{gt()},[gt]);const jt=j=>{const f=je.current;if(!f)return{x:0,y:0};const E=f.getBoundingClientRect(),I=G.width/E.width,P=G.height/E.height;return{x:(j.clientX-E.left)*I/G.width,y:(j.clientY-E.top)*P/G.height}},vt=(j,f)=>{const E=(j.x-f.x)*G.width,I=(j.y-f.y)*G.height;return Math.sqrt(E*E+I*I)},Ir=j=>{if(!je.current)return;const E=jt(j);if(i==="draw"&&H){if(!v)N({points:[E],isComplete:!1});else if(!v.isComplete){const I=v.points[0],P=vt(E,I);v.points.length>=3&&P<20?(N({...v,isComplete:!0}),ce(!0)):N({...v,points:[...v.points,E]})}}else if(i==="select"){const I=t.find(P=>P.polygon&&P.polygon.length>=3&&Te(E,P.polygon));Q(I||null)}},Ar=j=>{if(je.current){if(i==="draw"&&v&&!v.isComplete&&v.points.length>=3){const E=jt(j),I=v.points[0],P=vt(E,I);Z(P<20)}g&&i==="select"&&u({x:j.clientX-b.x,y:j.clientY-b.y})}},Mr=j=>{i==="select"&&j.button===0&&(w(!0),p({x:j.clientX-x.x,y:j.clientY-x.y}))},bt=()=>{w(!1)},Dr=()=>{v&&v.points.length>1?N({...v,points:v.points.slice(0,-1)}):v&&v.points.length===1&&N(null)},is=()=>{N(null),ce(!1),Z(!1),Rr()},Rr=()=>{le({nombre:"",codigo:"",tipo:"produccion",descripcion:"",color:"#2196f3",equipmentId:void 0})},Tr=async()=>{if(!v||!v.isComplete||v.points.length<3)return;const j=os(v.points),f=$.codigo||`Z${t.length+1}`,E={id:`zone_${Date.now()}`,nombre:$.nombre||`Zona ${f}`,codigo:f,tipo:$.tipo,descripcion:$.descripcion,polygon:v.points,bounds:j,color:$.color,parentId:null,nivel:1,activa:!0,...$.tipo==="maquina"&&$.equipmentId?{equipmentId:$.equipmentId}:{}};try{await lc(E),await Ke().then(a),is(),c("select")}catch(I){console.error("Error creando zona:",I),alert("Error al guardar la zona")}},Pr=async j=>{if(confirm("¿Estás seguro de eliminar esta zona?"))try{await mc(j),await Ke().then(a),Q(null)}catch(f){console.error("Error eliminando zona:",f)}},zr=async j=>{var E;const f=(E=j.target.files)==null?void 0:E[0];if(f){if(!f.type.startsWith("image/")){alert("Por favor selecciona una imagen");return}if(f.size>10*1024*1024){alert("La imagen es muy grande. Máximo 10MB");return}ge(!0);try{const I=await Ji(f);o(I),await ns()}catch(I){console.error("Error subiendo mapa:",I),alert("Error al subir la imagen")}finally{ge(!1),B.current&&(B.current.value="")}}},yt=j=>{m(f=>Math.max(.3,Math.min(5,f+j)))},Lr=()=>{m(1),u({x:0,y:0})},Fr=l.useCallback(j=>{j.preventDefault();const f=de.current;if(!f)return;const E=j.deltaY<0?1.1:.9,I=Math.max(.3,Math.min(5,d*E)),P=f.getBoundingClientRect(),O=j.clientX-P.left,re=j.clientY-P.top,ve=I/d,fs=O-(O-x.x)*ve,gs=re-(re-x.y)*ve;m(I),u({x:fs,y:gs})},[d,x]),_r=j=>{j.button===1&&(j.preventDefault(),y(!0),w(!0),p({x:j.clientX-x.x,y:j.clientY-x.y}))},Or=j=>{h&&g&&u({x:j.clientX-b.x,y:j.clientY-b.y})},Nt=()=>{y(!1),w(!1)},$r=j=>{const f=Ge.find(E=>E.value===j);le({...$,tipo:j,color:(f==null?void 0:f.color)||$.color})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Herramientas:"}),e.jsxs(S,{variant:i==="select"?"default":"outline",size:"sm",onClick:()=>{c("select"),is()},children:[e.jsx(Xo,{className:"h-4 w-4 mr-1"}),"Seleccionar"]}),H&&e.jsxs(S,{variant:i==="draw"?"default":"outline",size:"sm",onClick:()=>c("draw"),disabled:!V,children:[e.jsx(Tt,{className:"h-4 w-4 mr-1"}),"Dibujar Zona"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"icon",onClick:()=>yt(.25),children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm w-12 text-center",children:[Math.round(d*100),"%"]}),e.jsx(S,{variant:"outline",size:"icon",onClick:()=>yt(-.25),children:e.jsx(Ra,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"icon",onClick:Lr,children:e.jsx(Ia,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[H&&e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:B,type:"file",accept:"image/*",className:"hidden",onChange:zr}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>{var j;return(j=B.current)==null?void 0:j.click()},disabled:fe,children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),fe?"Subiendo...":"Subir Plano"]})]}),q.length>1&&e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>De(!0),children:[e.jsx(Rt,{className:"h-4 w-4 mr-1"}),"Mapas (",q.length,")"]})]})]}),i==="draw"&&v&&e.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t",children:[e.jsxs(J,{variant:"secondary",children:[v.points.length," puntos"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:Dr,disabled:v.points.length===0,children:[e.jsx(ei,{className:"h-4 w-4 mr-1"}),"Deshacer"]}),e.jsxs(S,{variant:"destructive",size:"sm",onClick:is,children:[e.jsx(es,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),v.isComplete&&e.jsxs(S,{size:"sm",onClick:()=>ce(!0),children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),"Completar Zona"]})]})]})}),e.jsx(D,{className:"overflow-hidden",children:e.jsx(z,{className:"p-0",children:e.jsxs("div",{ref:de,className:k("relative w-full overflow-hidden bg-muted",i==="select"?"cursor-grab active:cursor-grabbing":"cursor-crosshair",h&&"cursor-grabbing"),style:{height:"70vh",minHeight:"500px"},onWheel:Fr,onMouseDown:_r,onMouseMove:Or,onMouseUp:Nt,onMouseLeave:Nt,children:[e.jsx("div",{className:"absolute transition-transform duration-75",style:{transform:`translate(${x.x}px, ${x.y}px) scale(${d})`,transformOrigin:"top left"},children:e.jsx("canvas",{ref:je,width:G.width*$e,height:G.height*$e,style:{width:G.width,height:G.height},onClick:Ir,onMouseMove:Ar,onMouseDown:Mr,onMouseUp:bt,onMouseLeave:bt,className:"block"})}),i==="draw"&&e.jsxs("div",{className:"absolute top-4 left-4 bg-primary/90 text-primary-foreground px-4 py-2 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Modo Dibujo"})]}),e.jsx("p",{className:"text-sm mt-1 opacity-90",children:v?v.points.length<3?`Click para agregar punto ${v.points.length+1}`:"Click en punto 1 para cerrar o continúa agregando puntos":"Click para colocar el primer punto"})]}),T&&i==="select"&&e.jsxs("div",{className:"absolute bottom-4 left-4 bg-card/95 backdrop-blur p-4 rounded-lg shadow-lg border max-w-xs",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(J,{style:{backgroundColor:T.color},children:T.codigo}),H&&e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>Pr(T.id),children:e.jsx(xs,{className:"h-4 w-4"})})]}),e.jsx("h4",{className:"font-medium",children:T.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(wt=Ge.find(j=>j.value===T.tipo))==null?void 0:wt.label}),T.descripcion&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:T.descripcion})]})]})})}),e.jsxs(D,{children:[e.jsx(Y,{className:"pb-3",children:e.jsx(K,{className:"text-lg flex items-center justify-between",children:e.jsxs("span",{children:["Zonas Configuradas (",t.length,")"]})})}),e.jsx(z,{children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Rt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"}),H&&V&&e.jsx("p",{className:"text-sm mt-1",children:'Usa "Dibujar Zona" para crear polígonos punto a punto'}),!V&&e.jsx("p",{className:"text-sm mt-1",children:"Primero sube una imagen del plano de la planta"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:t.map(j=>{const f=Ge.find(I=>I.value===j.tipo),E=(T==null?void 0:T.id)===j.id;return e.jsxs("div",{className:k("p-3 rounded-lg border-2 cursor-pointer transition-all hover:shadow-md",E?"ring-2 ring-primary":""),style:{borderColor:j.color},onClick:()=>Q(E?null:j),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{children:f==null?void 0:f.icon}),e.jsx(J,{className:"text-xs",style:{backgroundColor:j.color},children:j.codigo})]}),e.jsx("h4",{className:"font-medium text-sm truncate",children:j.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:f==null?void 0:f.label})]},j.id)})})})]}),e.jsx(be,{open:Me,onOpenChange:j=>!j&&is(),children:e.jsxs(pe,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Configurar Nueva Zona"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{htmlFor:"zoneCodigo",children:"Código"}),e.jsx(X,{id:"zoneCodigo",value:$.codigo,onChange:j=>le({...$,codigo:j.target.value.toUpperCase()}),placeholder:"A, B, PROD-1...",maxLength:10})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"zoneTipo",children:"Tipo de Zona"}),e.jsxs(ne,{value:$.tipo,onValueChange:j=>$r(j),children:[e.jsx(se,{children:e.jsx(oe,{})}),e.jsx(te,{children:Ge.map(j=>e.jsx(F,{value:j.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:j.icon}),e.jsx("span",{children:j.label})]})},j.value))})]})]})]}),$.tipo==="maquina"&&e.jsxs("div",{children:[e.jsx(R,{htmlFor:"zoneEquipment",children:"Equipo Vinculado"}),e.jsxs(ne,{value:$.equipmentId||"",onValueChange:j=>{const f=r.find(E=>E.id===j);le({...$,equipmentId:j,nombre:f?`${f.nombre}`:$.nombre,codigo:(f==null?void 0:f.codigo)||$.codigo})},children:[e.jsx(se,{children:e.jsx(oe,{placeholder:"Seleccionar equipo..."})}),e.jsxs(te,{children:[e.jsx(F,{value:"",children:"Sin vincular"}),r.map(j=>e.jsx(F,{value:j.id,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"⚙️"}),e.jsxs("span",{children:[j.codigo," - ",j.nombre]})]})},j.id))]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Al vincular un equipo, se usará su nombre y código"})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"zoneName",children:"Nombre de la Zona"}),e.jsx(X,{id:"zoneName",value:$.nombre,onChange:j=>le({...$,nombre:j.target.value}),placeholder:"Ej: Línea de producción 1"})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"zoneDescription",children:"Descripción (opcional)"}),e.jsx(_e,{id:"zoneDescription",value:$.descripcion,onChange:j=>le({...$,descripcion:j.target.value}),placeholder:"Descripción detallada de la zona...",rows:2})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Color"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:[...Ge.map(j=>j.color),...xc].map(j=>e.jsx("button",{className:k("w-8 h-8 rounded-full border-2 transition-all",$.color===j?"scale-110 border-white ring-2 ring-primary":"border-transparent"),style:{backgroundColor:j},onClick:()=>le({...$,color:j})},j))})]}),e.jsx("div",{className:"bg-muted rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Polígono:"})," ",(v==null?void 0:v.points.length)||0," puntos"]})})]}),e.jsxs(rs,{children:[e.jsxs(S,{variant:"outline",onClick:is,children:[e.jsx(es,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),e.jsxs(S,{onClick:Tr,children:[e.jsx(ct,{className:"h-4 w-4 mr-1"}),"Guardar Zona"]})]})]})}),e.jsx(be,{open:we,onOpenChange:De,children:e.jsxs(pe,{children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Seleccionar Plano"})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto",children:q.map((j,f)=>e.jsxs("div",{className:k("relative aspect-video rounded-lg overflow-hidden border-2 transition-all group",n===j?"border-primary ring-2 ring-primary":"border-muted hover:border-primary/50"),children:[e.jsx("img",{src:j,alt:`Plano ${f+1}`,className:"w-full h-full object-cover cursor-pointer",onClick:()=>{o(j),De(!1)}}),n===j&&e.jsx("div",{className:"absolute inset-0 bg-primary/20 flex items-center justify-center pointer-events-none",children:e.jsx(Cs,{className:"h-8 w-8 text-primary"})}),H&&q.length>1&&e.jsx(S,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:async E=>{if(E.stopPropagation(),confirm("¿Eliminar este plano?"))try{if(await ec(j),n===j){const I=q.find(P=>P!==j);o(I||null)}await ns()}catch(I){console.error("Error eliminando mapa:",I),alert("Error al eliminar el mapa")}},children:e.jsx(xs,{className:"h-4 w-4"})})]},j))}),q.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:'No hay planos subidos. Usa el botón "Subir plano" para agregar uno.'})]})})]})}function fc(){const{user:s}=ie(),{zones:t,setZones:a,setSelectedZone:n,incidents:o,setIncidents:r,mapImage:i}=ss(),[c,d]=l.useState("view"),m=i?Cr(i)?i:wr(i):null,[x,u]=l.useState(1),[g,w]=l.useState({x:0,y:0}),[b,p]=l.useState(!1),[h,y]=l.useState({x:0,y:0}),v=l.useRef(null),N=(s==null?void 0:s.rol)==="admin";l.useEffect(()=>{Ke().then(a)},[a]),l.useEffect(()=>{const L=yr(r,{status:["pendiente","confirmada","en_proceso"]});return()=>L()},[r]);const M=o.reduce((L,q)=>(L[q.zoneId]||(L[q.zoneId]=[]),L[q.zoneId].push(q),L),{}),Z=L=>{u(q=>Math.max(.5,Math.min(3,q+L)))},T=()=>{u(1),w({x:0,y:0})},Q=L=>{L.button===0&&(p(!0),y({x:L.clientX-g.x,y:L.clientY-g.y}))},Me=L=>{b&&w({x:L.clientX-h.x,y:L.clientY-h.y})},ce=()=>{p(!1)},$=L=>{const q=L.touches[0];L.touches.length===1&&q&&(p(!0),y({x:q.clientX-g.x,y:q.clientY-g.y}))},le=L=>{const q=L.touches[0];b&&L.touches.length===1&&q&&w({x:q.clientX-h.x,y:q.clientY-h.y})},V=()=>{p(!1)};return c==="edit"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Editor de Zonas"}),e.jsx("p",{className:"text-muted-foreground",children:"Dibuja zonas poligonales punto a punto sobre el plano"})]}),e.jsxs(S,{variant:"outline",onClick:()=>d("view"),children:[e.jsx(Uo,{className:"h-4 w-4 mr-2"}),"Volver a Vista"]})]}),e.jsx(pc,{})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mapa de Planta"}),e.jsx("p",{className:"text-muted-foreground",children:"Vista general de zonas e incidencias"})]}),e.jsxs("div",{className:"flex gap-2",children:[N&&e.jsxs(S,{variant:"outline",onClick:()=>d("edit"),children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"Editar Zonas"]}),e.jsx(S,{variant:"outline",size:"icon",onClick:()=>Z(.25),children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"icon",onClick:()=>Z(-.25),children:e.jsx(Ra,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"icon",onClick:T,children:e.jsx(Ia,{className:"h-4 w-4"})})]})]}),e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-destructive"}),e.jsx("span",{children:"Incidencias críticas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-warning"}),e.jsx("span",{children:"Incidencias altas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-primary"}),e.jsx("span",{children:"Incidencias medias"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-success"}),e.jsx("span",{children:"Sin incidencias"})]})]})})}),e.jsx(D,{className:"overflow-hidden",children:e.jsx(z,{className:"p-0",children:e.jsxs("div",{ref:v,className:"relative w-full h-[500px] overflow-hidden bg-muted cursor-grab active:cursor-grabbing",onMouseDown:Q,onMouseMove:Me,onMouseUp:ce,onMouseLeave:ce,onTouchStart:$,onTouchMove:le,onTouchEnd:V,children:[e.jsx("div",{className:"absolute transition-transform duration-100",style:{transform:`translate(${g.x}px, ${g.y}px) scale(${x})`,transformOrigin:"top left",width:"100%",height:"100%"},children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:m,alt:"Plano de planta",className:"absolute inset-0 w-full h-full object-contain opacity-50",onError:L=>{L.currentTarget.style.display="none"}}),t.length>0?t.map(L=>e.jsx(gc,{zone:L,incidents:M[L.id]||[],onClick:()=>n(L)},L.id)):e.jsxs("div",{className:"absolute inset-0 grid grid-cols-2 grid-rows-2 gap-2 p-4",children:[e.jsx(vs,{name:"Zona A",color:"#2196f3"}),e.jsx(vs,{name:"Zona B",color:"#4caf50"}),e.jsx(vs,{name:"Zona C",color:"#ff9800"}),e.jsx(vs,{name:"Zona D",color:"#9c27b0"})]})]})}),e.jsxs("div",{className:"absolute bottom-4 right-4 bg-card/80 backdrop-blur px-3 py-1 rounded text-sm",children:["Zoom: ",Math.round(x*100),"%"]})]})})}),t.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map(L=>{const q=M[L.id]||[],he=q.filter(we=>we.prioridad==="critica").length;return e.jsxs(D,{className:k("cursor-pointer hover:border-primary/50 transition-colors",he>0&&"border-destructive"),onClick:()=>n(L),children:[e.jsx(Y,{className:"p-4 pb-2",children:e.jsxs(K,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:L.color||"#2196f3"}}),L.nombre]})}),e.jsxs(z,{className:"p-4 pt-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl font-bold",children:q.length}),he>0&&e.jsxs(J,{variant:"destructive",className:"gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),he]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"incidencias activas"})]})]},L.id)})})]})}function gc({zone:s,incidents:t,onClick:a}){const n=t.filter(i=>i.prioridad==="critica").length,o=t.filter(i=>i.prioridad==="alta").length;let r="border-success/50 bg-success/10";if(n>0?r="border-destructive bg-destructive/20":o>0?r="border-warning bg-warning/20":t.length>0&&(r="border-primary bg-primary/20"),s.bounds){const i={position:"absolute",left:`${s.bounds.minX*100}%`,top:`${s.bounds.minY*100}%`,width:`${(s.bounds.maxX-s.bounds.minX)*100}%`,height:`${(s.bounds.maxY-s.bounds.minY)*100}%`,borderColor:s.color};return e.jsxs("div",{className:k("rounded-lg border-2 cursor-pointer transition-all hover:scale-[1.02]",r),style:i,onClick:a,children:[e.jsx("div",{className:"absolute top-1 left-1",children:e.jsx(J,{style:{backgroundColor:s.color},className:"text-white text-xs",children:s.id})}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-2",children:[e.jsx("h3",{className:"font-medium text-center text-sm",children:s.nombre}),t.length>0&&e.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3 text-warning"}),e.jsx("span",{className:"text-xs",children:t.length})]})]}),t.slice(0,3).map((c,d)=>e.jsx("div",{className:k("absolute w-2 h-2 rounded-full animate-pulse",c.prioridad==="critica"?"bg-destructive":c.prioridad==="alta"?"bg-warning":"bg-primary"),style:{top:`${20+d*20}%`,right:`${10+d*10}%`}},c.id))]})}return null}function vs({name:s,color:t}){return e.jsxs("div",{className:"relative rounded-lg border-2 border-dashed p-4 flex flex-col items-center justify-center",style:{borderColor:t,backgroundColor:`${t}10`},children:[e.jsx(Be,{className:"h-8 w-8 mb-2",style:{color:t}}),e.jsx("h3",{className:"font-medium",children:s}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sin configurar"})]})}const pt="equipment";async function jc(s){const t=nt(),a={...s,id:t,createdAt:new Date,updatedAt:new Date};return await Ze(ee(U,pt,t),{...a,createdAt:ae(),updatedAt:ae()}),a}async function Ws(s){let t=ke(me(U,pt),Le("nombre"));return(await Oe(t)).docs.map(bc)}async function vc(s,t){const a=ee(U,pt,s);await Je(a,{...t,updatedAt:ae()})}function bc(s){const t=s.data();return{...t,id:s.id,createdAt:$s(t.createdAt),updatedAt:$s(t.updatedAt),fechaInstalacion:$s(t.fechaInstalacion)}}function $s(s){if(s)return s instanceof Ee?s.toDate():s instanceof Date?s:new Date(s)}const yc={operativo:{label:"Operativo",className:"bg-success text-success-foreground"},en_mantenimiento:{label:"En Mantenimiento",className:"bg-warning text-warning-foreground"},fuera_servicio:{label:"Fuera de Servicio",className:"bg-destructive text-destructive-foreground"}},Nc={alta:{label:"Alta",className:"bg-destructive text-destructive-foreground"},media:{label:"Media",className:"bg-warning text-warning-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function wc(){const{equipment:s,setEquipment:t,zones:a,setZones:n}=ss(),[o,r]=l.useState(!1),[i,c]=l.useState(null),[d,m]=l.useState(""),[x,u]=l.useState("all"),[g,w]=l.useState("all");l.useEffect(()=>{Ws().then(t),dc().then(n)},[t,n]);const b=s.filter(N=>{const M=N.nombre.toLowerCase().includes(d.toLowerCase())||N.codigo.toLowerCase().includes(d.toLowerCase()),Z=x==="all"||N.zoneId===x,T=g==="all"||N.estado===g;return M&&Z&&T}),p={total:s.length,operativos:s.filter(N=>N.estado==="operativo").length,enMantenimiento:s.filter(N=>N.estado==="en_mantenimiento").length,fueraServicio:s.filter(N=>N.estado==="fuera_servicio").length},h=N=>{c(N),r(!0)},y=()=>{r(!1),c(null)},v=async()=>{y();const N=await Ws();t(N)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Equipos"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de activos y máquinas"})]}),e.jsxs(S,{onClick:()=>r(!0),children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Nuevo Equipo"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:p.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]})}),e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-success",children:p.operativos}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Operativos"})]})}),e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:p.enMantenimiento}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En Mantenimiento"})]})}),e.jsx(D,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:p.fueraServicio}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Fuera de Servicio"})]})})]}),e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Aa,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(X,{placeholder:"Buscar por nombre o código...",value:d,onChange:N=>m(N.target.value),className:"pl-9"})]}),e.jsxs(ne,{value:x,onValueChange:u,children:[e.jsxs(se,{className:"w-full sm:w-[180px]",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),e.jsx(oe,{placeholder:"Zona"})]}),e.jsxs(te,{children:[e.jsx(F,{value:"all",children:"Todas las zonas"}),a.map(N=>e.jsx(F,{value:N.id,children:N.nombre},N.id))]})]}),e.jsxs(ne,{value:g,onValueChange:w,children:[e.jsx(se,{className:"w-full sm:w-[180px]",children:e.jsx(oe,{placeholder:"Estado"})}),e.jsxs(te,{children:[e.jsx(F,{value:"all",children:"Todos los estados"}),e.jsx(F,{value:"operativo",children:"Operativo"}),e.jsx(F,{value:"en_mantenimiento",children:"En Mantenimiento"}),e.jsx(F,{value:"fuera_servicio",children:"Fuera de Servicio"})]})]})]})})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.length===0?e.jsx(D,{className:"md:col-span-2 lg:col-span-3",children:e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(He,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No hay equipos"}),e.jsx("p",{className:"text-muted-foreground",children:d||x!=="all"||g!=="all"?"No se encontraron equipos con los filtros aplicados":"Comienza agregando un nuevo equipo"})]})}):b.map(N=>e.jsx(Cc,{equipment:N,zone:a.find(M=>M.id===N.zoneId),onClick:()=>h(N)},N.id))}),o&&e.jsx(Sc,{equipment:i,zones:a,onClose:y,onSuccess:v})]})}function Cc({equipment:s,zone:t,onClick:a}){const n=yc[s.estado],o=Nc[s.criticidad];return e.jsxs(D,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:a,children:[e.jsx(Y,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(K,{className:"text-base",children:s.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:s.codigo})]}),e.jsx(J,{className:n.className,children:n.label})]})}),e.jsx(z,{className:"p-4 pt-2",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[t&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Be,{className:"h-4 w-4"}),t.nombre]}),s.marca&&e.jsxs("div",{className:"text-muted-foreground",children:[s.marca," ",s.modelo]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Criticidad:"}),e.jsx(J,{variant:"outline",className:o.className,children:o.label})]})]})})]})}function Sc({equipment:s,zones:t,onClose:a,onSuccess:n}){const[o,r]=l.useState(!1),[i,c]=l.useState({codigo:(s==null?void 0:s.codigo)||"",nombre:(s==null?void 0:s.nombre)||"",descripcion:(s==null?void 0:s.descripcion)||"",marca:(s==null?void 0:s.marca)||"",modelo:(s==null?void 0:s.modelo)||"",numeroSerie:(s==null?void 0:s.numeroSerie)||"",zoneId:(s==null?void 0:s.zoneId)||"",criticidad:(s==null?void 0:s.criticidad)||"media",estado:(s==null?void 0:s.estado)||"operativo"}),d=async m=>{m.preventDefault(),r(!0);try{s?await vc(s.id,i):await jc({...i,zonePath:[i.zoneId],position:{x:0,y:0}}),n()}catch(x){console.error("Error saving equipment:",x)}finally{r(!1)}};return e.jsx(be,{open:!0,onOpenChange:a,children:e.jsxs(pe,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsx(Ne,{children:s?"Editar Equipo":"Nuevo Equipo"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"codigo",children:"Código *"}),e.jsx(X,{id:"codigo",value:i.codigo,onChange:m=>c({...i,codigo:m.target.value}),placeholder:"EQ-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"zoneId",children:"Zona *"}),e.jsxs(ne,{value:i.zoneId,onValueChange:m=>c({...i,zoneId:m}),children:[e.jsx(se,{children:e.jsx(oe,{placeholder:"Seleccionar zona"})}),e.jsx(te,{children:t.map(m=>e.jsx(F,{value:m.id,children:m.nombre},m.id))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"nombre",children:"Nombre *"}),e.jsx(X,{id:"nombre",value:i.nombre,onChange:m=>c({...i,nombre:m.target.value}),placeholder:"Bomba centrífuga principal",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(_e,{id:"descripcion",value:i.descripcion,onChange:m=>c({...i,descripcion:m.target.value}),placeholder:"Descripción del equipo...",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"marca",children:"Marca"}),e.jsx(X,{id:"marca",value:i.marca,onChange:m=>c({...i,marca:m.target.value}),placeholder:"Siemens"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"modelo",children:"Modelo"}),e.jsx(X,{id:"modelo",value:i.modelo,onChange:m=>c({...i,modelo:m.target.value}),placeholder:"XYZ-100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"criticidad",children:"Criticidad"}),e.jsxs(ne,{value:i.criticidad,onValueChange:m=>c({...i,criticidad:m}),children:[e.jsx(se,{children:e.jsx(oe,{})}),e.jsxs(te,{children:[e.jsx(F,{value:"alta",children:"Alta"}),e.jsx(F,{value:"media",children:"Media"}),e.jsx(F,{value:"baja",children:"Baja"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"estado",children:"Estado"}),e.jsxs(ne,{value:i.estado,onValueChange:m=>c({...i,estado:m}),children:[e.jsx(se,{children:e.jsx(oe,{})}),e.jsxs(te,{children:[e.jsx(F,{value:"operativo",children:"Operativo"}),e.jsx(F,{value:"en_mantenimiento",children:"En Mantenimiento"}),e.jsx(F,{value:"fuera_servicio",children:"Fuera de Servicio"})]})]})]})]}),e.jsxs(rs,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(S,{type:"submit",disabled:o,children:o?"Guardando...":s?"Guardar Cambios":"Crear Equipo"})]})]})]})})}function kc(){const{user:s}=ie(),[t,a]=l.useState("general");if((s==null?void 0:s.rol)!=="admin")return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs(D,{className:"p-8 text-center",children:[e.jsx(Ko,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),e.jsx("h2",{className:"text-xl font-bold",children:"Acceso Denegado"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Solo los administradores pueden acceder a esta página."})]})});const n=[{id:"general",label:"General",icon:As},{id:"users",label:"Usuarios",icon:ti},{id:"invites",label:"Invitaciones",icon:Bo},{id:"notifications",label:"Notificaciones",icon:Fo}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Configuración"}),e.jsx("p",{className:"text-muted-foreground",children:"Administra la configuración del sistema"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-border pb-2",children:n.map(o=>e.jsxs(S,{variant:t===o.id?"default":"ghost",onClick:()=>a(o.id),className:"gap-2",children:[e.jsx(o.icon,{className:"h-4 w-4"}),o.label]},o.id))}),t==="general"&&e.jsx(Ec,{}),t==="users"&&e.jsx(Ic,{}),t==="invites"&&e.jsx(Ac,{}),t==="notifications"&&e.jsx(Mc,{})]})}function Ec(){const[s,t]=l.useState(!0),[a,n]=l.useState(!1),[o,r]=l.useState(!1),[i,c]=l.useState(!1),d=async()=>{r(!0);try{await Ze(ee(U,"settings","general"),{requireValidation:s,autoAssign:a,updatedAt:ae()},{merge:!0}),c(!0),setTimeout(()=>c(!1),2e3)}catch(m){console.error("Error guardando:",m)}r(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx(Y,{children:e.jsx(K,{children:"Flujo de Incidencias"})}),e.jsxs(z,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(R,{children:"Validación de Incidencias"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Requiere que un supervisor valide las incidencias reportadas"})]}),e.jsx(Ue,{checked:s,onCheckedChange:t})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(R,{children:"Auto-asignación"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Asigna automáticamente incidencias a técnicos disponibles"})]}),e.jsx(Ue,{checked:a,onCheckedChange:n})]})]})]}),e.jsxs(D,{children:[e.jsx(Y,{children:e.jsx(K,{children:"Prioridades"})}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Tiempo respuesta crítica (min)"}),e.jsx(X,{type:"number",defaultValue:15,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Tiempo respuesta alta (min)"}),e.jsx(X,{type:"number",defaultValue:30,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Tiempo respuesta media (min)"}),e.jsx(X,{type:"number",defaultValue:60,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Tiempo respuesta baja (min)"}),e.jsx(X,{type:"number",defaultValue:120,className:"mt-1"})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{onClick:d,disabled:o,children:o?"Guardando...":i?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Guardado"]}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})})]})}function Ic(){const[s,t]=l.useState([]),[a,n]=l.useState(!0);l.useEffect(()=>{o()},[]);const o=async()=>{try{const m=(await Oe(me(U,"users"))).docs.map(x=>({id:x.id,...x.data()}));t(m)}catch(d){console.error("Error cargando usuarios:",d)}n(!1)},r=async(d,m)=>{try{await Je(ee(U,"users",d),{activo:!m,updatedAt:ae()}),o()}catch(x){console.error("Error actualizando usuario:",x)}},i=async(d,m)=>{try{await Je(ee(U,"users",d),{rol:m,updatedAt:ae()}),o()}catch(x){console.error("Error actualizando rol:",x)}},c=d=>{const m={admin:{label:"Admin",className:"bg-destructive"},supervisor:{label:"Supervisor",className:"bg-warning"},tecnico:{label:"Técnico",className:"bg-primary"}},{label:x,className:u}=m[d]||m.tecnico;return e.jsx(J,{className:u,children:x})};return a?e.jsx("div",{className:"text-center py-8",children:"Cargando usuarios..."}):e.jsxs(D,{children:[e.jsx(Y,{children:e.jsxs(K,{children:["Usuarios del Sistema (",s.length,")"]})}),e.jsx(z,{children:e.jsx("div",{className:"divide-y divide-border",children:s.map(d=>e.jsxs("div",{className:"py-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[d.nombre," ",d.apellido]}),c(d.rol),!d.activo&&e.jsx(J,{variant:"outline",className:"text-destructive",children:"Inactivo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:d.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ne,{value:d.rol,onValueChange:m=>i(d.id,m),children:[e.jsx(se,{className:"w-32",children:e.jsx(oe,{})}),e.jsxs(te,{children:[e.jsx(F,{value:"admin",children:"Admin"}),e.jsx(F,{value:"supervisor",children:"Supervisor"}),e.jsx(F,{value:"tecnico",children:"Técnico"})]})]}),e.jsx(Ue,{checked:d.activo,onCheckedChange:()=>r(d.id,d.activo)})]})]},d.id))})})]})}function Ac(){const{user:s}=ie(),[t,a]=l.useState([]),[n,o]=l.useState(!0),[r,i]=l.useState(!1),[c,d]=l.useState("tecnico"),[m,x]=l.useState(!1);l.useEffect(()=>{u()},[]);const u=async()=>{try{const y=(await Oe(me(U,"inviteCodes"))).docs.map(v=>({...v.data(),code:v.id}));a(y)}catch(h){console.error("Error cargando invitaciones:",h)}o(!1)},g=()=>Math.random().toString(36).substring(2,8).toUpperCase(),w=async()=>{if(s){x(!0);try{const h=g(),y=new Date;y.setDate(y.getDate()+7),await Ze(ee(U,"inviteCodes",h),{rol:c,createdBy:s.id,createdAt:ae(),expiresAt:y,used:!1,usedBy:null,usedAt:null}),i(!1),u()}catch(h){console.error("Error creando invitación:",h)}x(!1)}},b=async h=>{if(confirm("¿Eliminar este código de invitación?"))try{await st(ee(U,"inviteCodes",h)),u()}catch(y){console.error("Error eliminando invitación:",y)}},p=h=>{navigator.clipboard.writeText(h)};return n?e.jsx("div",{className:"text-center py-8",children:"Cargando invitaciones..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Códigos de Invitación"}),e.jsxs(S,{onClick:()=>i(!0),children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Nuevo Código"]})]}),e.jsx(D,{children:e.jsx(z,{className:"p-0",children:t.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No hay códigos de invitación activos"}):e.jsx("div",{className:"divide-y divide-border",children:t.map(h=>{const y=h.usosActuales>=h.usosMaximos;return e.jsxs("div",{className:k("p-4 flex items-center justify-between",y&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("code",{className:"bg-muted px-3 py-1 rounded text-lg font-mono",children:h.code}),e.jsxs("div",{children:[e.jsx(J,{variant:"outline",children:h.rol==="admin"?"Admin":h.rol==="supervisor"?"Supervisor":"Técnico"}),y&&e.jsx(J,{className:"ml-2 bg-muted text-muted-foreground",children:"Usado"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!y&&e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>p(h.code),children:e.jsx(qo,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>b(h.code),children:e.jsx(xs,{className:"h-4 w-4"})})]})]},h.code)})})})}),e.jsx(be,{open:r,onOpenChange:i,children:e.jsxs(pe,{children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Crear Código de Invitación"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Rol del nuevo usuario"}),e.jsxs(ne,{value:c,onValueChange:d,children:[e.jsx(se,{className:"mt-1",children:e.jsx(oe,{})}),e.jsxs(te,{children:[e.jsx(F,{value:"tecnico",children:"Técnico"}),e.jsx(F,{value:"supervisor",children:"Supervisor"}),e.jsx(F,{value:"admin",children:"Administrador"})]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"El código expirará en 7 días"})]}),e.jsxs(rs,{children:[e.jsx(S,{variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(S,{onClick:w,disabled:m,children:m?"Creando...":"Crear Código"})]})]})})]})}function Mc(){const[s,t]=l.useState(!0),[a,n]=l.useState(!1),[o,r]=l.useState(!0),[i,c]=l.useState(!1),[d,m]=l.useState(!1),x=async()=>{c(!0);try{await Ze(ee(U,"settings","notifications"),{emailNotifications:s,pushNotifications:a,criticalAlerts:o,updatedAt:ae()},{merge:!0}),m(!0),setTimeout(()=>m(!1),2e3)}catch(u){console.error("Error guardando:",u)}c(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx(Y,{children:e.jsx(K,{children:"Notificaciones"})}),e.jsxs(z,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(R,{children:"Notificaciones por Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recibir resumen diario de incidencias"})]}),e.jsx(Ue,{checked:s,onCheckedChange:t})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(R,{children:"Notificaciones Push"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recibir alertas en tiempo real (requiere PWA instalada)"})]}),e.jsx(Ue,{checked:a,onCheckedChange:n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(R,{children:"Alertas Críticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notificar inmediatamente incidencias críticas"})]}),e.jsx(Ue,{checked:o,onCheckedChange:r})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{onClick:x,disabled:i,children:i?"Guardando...":d?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Guardado"]}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})})]})}const ps="preventiveTasks",ft="preventiveExecutions";async function Sr(s){let t=ke(me(U,ps),Le("proximaEjecucion","asc"));return(await Oe(t)).docs.map(n=>{var o;return{id:n.id,...n.data(),ultimaEjecucion:(o=n.data().ultimaEjecucion)==null?void 0:o.toDate(),proximaEjecucion:n.data().proximaEjecucion.toDate(),createdAt:n.data().createdAt.toDate(),updatedAt:n.data().updatedAt.toDate()}})}async function Dc(s){var o;const t=ee(U,ps,s),a=await Qs(t);if(!a.exists())return null;const n=a.data();return{id:a.id,...n,ultimaEjecucion:(o=n.ultimaEjecucion)==null?void 0:o.toDate(),proximaEjecucion:n.proximaEjecucion.toDate(),createdAt:n.createdAt.toDate(),updatedAt:n.updatedAt.toDate()}}async function Rc(s){return(await aa(me(U,ps),{...s,proximaEjecucion:Ee.fromDate(s.proximaEjecucion),ultimaEjecucion:s.ultimaEjecucion?Ee.fromDate(s.ultimaEjecucion):null,createdAt:ae(),updatedAt:ae()})).id}async function kr(s,t){const a=ee(U,ps,s),n={...t,updatedAt:ae()};t.proximaEjecucion&&(n.proximaEjecucion=Ee.fromDate(t.proximaEjecucion)),t.ultimaEjecucion&&(n.ultimaEjecucion=Ee.fromDate(t.ultimaEjecucion)),await Je(a,n)}async function Tc(s){await st(ee(U,ps,s))}async function Pc(s){let t=ke(me(U,ft),Le("fechaEjecucion","desc"));return(await Oe(t)).docs.map(n=>({id:n.id,...n.data(),fechaEjecucion:n.data().fechaEjecucion.toDate()}))}async function zc(s){const t=await aa(me(U,ft),{...s,fechaEjecucion:Ee.fromDate(s.fechaEjecucion)}),a=await Dc(s.taskId);if(a){const n=new Date(s.fechaEjecucion);n.setDate(n.getDate()+a.frecuenciaDias),await kr(s.taskId,{ultimaEjecucion:s.fechaEjecucion,proximaEjecucion:n})}return t.id}async function Lc(){const s=await Sr(),t=new Date,a=s.filter(r=>r.activo&&r.proximaEjecucion<t).length,n=s.filter(r=>{if(!r.activo)return!1;const c=(r.proximaEjecucion.getTime()-t.getTime())/(1e3*60*60*24);return c>0&&c<=7}).length,o=await Fc();return{totalTasks:s.filter(r=>r.activo).length,overdue:a,upcoming7Days:n,completedThisMonth:o.length}}async function Fc(){const s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=ke(me(U,ft),Qe("fechaEjecucion",">=",Ee.fromDate(t)),Le("fechaEjecucion","desc"));return(await Oe(a)).docs.map(o=>({id:o.id,...o.data(),fechaEjecucion:o.data().fechaEjecucion.toDate()}))}const Er=[{value:"inspeccion",label:"Inspección visual"},{value:"lubricacion",label:"Lubricación"},{value:"limpieza",label:"Limpieza"},{value:"calibracion",label:"Calibración"},{value:"cambio_filtro",label:"Cambio de filtro"},{value:"cambio_aceite",label:"Cambio de aceite"},{value:"ajuste",label:"Ajuste/Torque"},{value:"verificacion_electrica",label:"Verificación eléctrica"},{value:"verificacion_neumatica",label:"Verificación neumática"},{value:"revision_seguridad",label:"Revisión de seguridad"},{value:"otro",label:"Otro"}],_c=[{value:1,label:"Diario"},{value:7,label:"Semanal"},{value:14,label:"Quincenal"},{value:30,label:"Mensual"},{value:60,label:"Bimestral"},{value:90,label:"Trimestral"},{value:180,label:"Semestral"},{value:365,label:"Anual"}];function Oc(){const s=ie(C=>C.user),[t,a]=l.useState([]),[n,o]=l.useState([]),[r,i]=l.useState([]),[c,d]=l.useState(!0),[m,x]=l.useState({totalTasks:0,overdue:0,upcoming7Days:0,completedThisMonth:0}),[u,g]=l.useState(new Date),[w,b]=l.useState(null),[p,h]=l.useState(!1),[y,v]=l.useState(!1),[N,M]=l.useState(null),[Z,T]=l.useState(null),[Q,Me]=l.useState("all");l.useEffect(()=>{ce()},[]);const ce=async()=>{d(!0);try{const[C,B,H,G]=await Promise.all([Sr(),Ws(),Lc(),Pc()]);a(C),i(B),x(H),o(G)}catch(C){console.error("Error loading data:",C)}finally{d(!1)}},le=(C=>{const B=C.getFullYear(),H=C.getMonth(),G=new Date(B,H,1),$e=new Date(B,H+1,0).getDate(),ns=G.getDay(),os=[];for(let Te=0;Te<ns;Te++)os.push(null);for(let Te=1;Te<=$e;Te++)os.push(new Date(B,H,Te));return os})(u),V=C=>t.filter(B=>{if(!B.activo)return!1;const H=new Date(B.proximaEjecucion);return H.getDate()===C.getDate()&&H.getMonth()===C.getMonth()&&H.getFullYear()===C.getFullYear()}),L=l.useMemo(()=>t.filter(C=>!(Q!=="all"&&C.equipmentId!==Q)),[t,Q]),q=L.filter(C=>C.activo&&C.proximaEjecucion<new Date),he=L.filter(C=>{if(!C.activo)return!1;const B=new Date,G=(C.proximaEjecucion.getTime()-B.getTime())/(1e3*60*60*24);return G>=0&&G<=7}),we=()=>{g(new Date(u.getFullYear(),u.getMonth()-1))},De=()=>{g(new Date(u.getFullYear(),u.getMonth()+1))},fe=async C=>{if(confirm("¿Estás seguro de eliminar esta tarea?"))try{await Tc(C),ce()}catch(B){console.error("Error deleting task:",B)}},ge=C=>{const B=new Date;return C.getDate()===B.getDate()&&C.getMonth()===B.getMonth()&&C.getFullYear()===B.getFullYear()},je=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],de=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mantenimiento Preventivo"}),e.jsx("p",{className:"text-muted-foreground",children:"Planifica y ejecuta tareas de mantenimiento programado"})]}),e.jsxs(be,{open:p,onOpenChange:h,children:[e.jsx(ai,{asChild:!0,children:e.jsxs(S,{onClick:()=>M(null),children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Nueva Tarea"]})}),e.jsx($c,{task:N,equipment:r,onClose:()=>{h(!1),M(null)},onSave:ce})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(Dt,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tareas"}),e.jsx("p",{className:"text-2xl font-bold",children:m.totalTasks})]})]})})}),e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(xe,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vencidas"}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:m.overdue})]})]})})}),e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx(qe,{className:"h-5 w-5 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Próximos 7 días"}),e.jsx("p",{className:"text-2xl font-bold",children:m.upcoming7Days})]})]})})}),e.jsx(D,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(Zs,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completadas (mes)"}),e.jsx("p",{className:"text-2xl font-bold",children:m.completedThisMonth})]})]})})})]}),e.jsxs(Ti,{defaultValue:"calendar",className:"space-y-4",children:[e.jsxs(vr,{children:[e.jsxs(ys,{value:"calendar",children:[e.jsx(_o,{className:"h-4 w-4 mr-2"}),"Calendario"]}),e.jsxs(ys,{value:"list",children:[e.jsx(Dt,{className:"h-4 w-4 mr-2"}),"Lista de Tareas"]}),e.jsxs(ys,{value:"history",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Historial"]})]}),e.jsxs(Ns,{value:"calendar",className:"space-y-4",children:[e.jsxs(D,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(S,{variant:"outline",size:"icon",onClick:we,children:e.jsx(Oo,{className:"h-4 w-4"})}),e.jsxs(K,{className:"text-lg",children:[je[u.getMonth()]," ",u.getFullYear()]}),e.jsx(S,{variant:"outline",size:"icon",onClick:De,children:e.jsx(wa,{className:"h-4 w-4"})})]}),e.jsxs(ne,{value:Q,onValueChange:Me,children:[e.jsxs(se,{className:"w-48",children:[e.jsx(Ca,{className:"h-4 w-4 mr-2"}),e.jsx(oe,{placeholder:"Filtrar por equipo"})]}),e.jsxs(te,{children:[e.jsx(F,{value:"all",children:"Todos los equipos"}),r.map(C=>e.jsx(F,{value:C.id,children:C.nombre},C.id))]})]})]}),e.jsxs(z,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:de.map(C=>e.jsx("div",{className:"text-center text-sm font-medium text-muted-foreground py-2",children:C},C))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:le.map((C,B)=>{if(!C)return e.jsx("div",{className:"h-24"},`empty-${B}`);const H=V(C),G=H.some(Re=>Re.proximaEjecucion<new Date);return e.jsxs("div",{className:k("h-24 p-1 border rounded-lg overflow-hidden cursor-pointer transition-colors",ge(C)&&"bg-primary/5 border-primary",(w==null?void 0:w.toDateString())===C.toDateString()&&"ring-2 ring-primary"),onClick:()=>b(C),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:k("text-sm font-medium",ge(C)&&"text-primary"),children:C.getDate()}),G&&e.jsx(xe,{className:"h-3 w-3 text-red-500"})]}),e.jsxs("div",{className:"space-y-0.5 overflow-y-auto max-h-16",children:[H.slice(0,3).map(Re=>e.jsx("div",{className:k("text-xs px-1 py-0.5 rounded truncate",Re.proximaEjecucion<new Date?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:Re.nombre},Re.id)),H.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:["+",H.length-3," más"]})]})]},C.toISOString())})})]})]}),w&&e.jsxs(D,{children:[e.jsx(Y,{children:e.jsxs(K,{className:"text-lg",children:["Tareas del ",w.getDate()," de ",je[w.getMonth()]]})}),e.jsx(z,{children:V(w).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas programadas para este día"}):e.jsx("div",{className:"space-y-2",children:V(w).map(C=>e.jsx(bs,{task:C,equipment:r,onEdit:()=>{M(C),h(!0)},onExecute:()=>{T(C),v(!0)},onDelete:()=>fe(C.id)},C.id))})})]})]}),e.jsxs(Ns,{value:"list",className:"space-y-4",children:[q.length>0&&e.jsxs(D,{className:"border-red-500/50",children:[e.jsx(Y,{children:e.jsxs(K,{className:"text-lg flex items-center gap-2 text-red-500",children:[e.jsx(xe,{className:"h-5 w-5"}),"Tareas Vencidas (",q.length,")"]})}),e.jsx(z,{className:"space-y-2",children:q.map(C=>e.jsx(bs,{task:C,equipment:r,onEdit:()=>{M(C),h(!0)},onExecute:()=>{T(C),v(!0)},onDelete:()=>fe(C.id)},C.id))})]}),e.jsxs(D,{children:[e.jsx(Y,{children:e.jsxs(K,{className:"text-lg flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5 text-yellow-500"}),"Próximos 7 días (",he.length,")"]})}),e.jsx(z,{className:"space-y-2",children:he.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas programadas para los próximos 7 días"}):he.map(C=>e.jsx(bs,{task:C,equipment:r,onEdit:()=>{M(C),h(!0)},onExecute:()=>{T(C),v(!0)},onDelete:()=>fe(C.id)},C.id))})]}),e.jsxs(D,{children:[e.jsx(Y,{children:e.jsx(K,{className:"text-lg",children:"Todas las Tareas"})}),e.jsx(z,{className:"space-y-2",children:L.filter(C=>C.activo).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas activas"}):L.filter(C=>C.activo).map(C=>e.jsx(bs,{task:C,equipment:r,onEdit:()=>{M(C),h(!0)},onExecute:()=>{T(C),v(!0)},onDelete:()=>fe(C.id)},C.id))})]})]}),e.jsx(Ns,{value:"history",children:e.jsxs(D,{children:[e.jsx(Y,{children:e.jsx(K,{className:"text-lg",children:"Historial de Ejecuciones"})}),e.jsx(z,{children:n.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No hay ejecuciones registradas"}):e.jsx("div",{className:"space-y-3",children:n.map(C=>{const B=t.find(G=>G.id===C.taskId),H=r.find(G=>G.id===C.equipmentId);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(Zs,{className:"h-4 w-4 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(B==null?void 0:B.nombre)||"Tarea eliminada"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(H==null?void 0:H.nombre)||"Equipo"," • ",C.duracionMinutos," min"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm",children:C.fechaEjecucion.toLocaleDateString("es-ES")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:C.fechaEjecucion.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]},C.id)})})})]})})]}),e.jsx(be,{open:y,onOpenChange:v,children:e.jsx(pe,{className:"max-w-lg",children:Z&&e.jsx(Vc,{task:Z,equipment:r,userId:(s==null?void 0:s.id)||"",onClose:()=>{v(!1),T(null)},onSave:ce})})})]})}function bs({task:s,equipment:t,onEdit:a,onExecute:n,onDelete:o}){const r=t.find(d=>d.id===s.equipmentId),i=s.proximaEjecucion<new Date,c=Er.find(d=>d.value===s.tipo);return e.jsxs("div",{className:k("flex items-center justify-between p-3 rounded-lg border",i?"border-red-500/50 bg-red-500/5":"bg-muted/50"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:k("p-2 rounded-lg",i?"bg-red-500/10":"bg-blue-500/10"),children:e.jsx(He,{className:k("h-4 w-4",i?"text-red-500":"text-blue-500")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.nombre}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:(r==null?void 0:r.nombre)||"Sin equipo"}),e.jsx("span",{children:"•"}),e.jsx(J,{variant:"outline",className:"text-xs",children:(c==null?void 0:c.label)||s.tipo})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:["Próxima: ",s.proximaEjecucion.toLocaleDateString("es-ES"),s.ultimaEjecucion&&e.jsxs(e.Fragment,{children:[" • Última: ",s.ultimaEjecucion.toLocaleDateString("es-ES")]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:n,title:"Ejecutar",children:e.jsx(Yo,{className:"h-4 w-4 text-green-500"})}),e.jsx(S,{variant:"ghost",size:"icon",onClick:a,title:"Editar",children:e.jsx(Jo,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"icon",onClick:o,title:"Eliminar",children:e.jsx(xs,{className:"h-4 w-4 text-destructive"})})]})]})}function $c({task:s,equipment:t,onClose:a,onSave:n}){var w;const o=()=>s!=null&&s.proximaEjecucion?s.proximaEjecucion.toISOString().split("T")[0]||new Date().toISOString().substring(0,10):new Date().toISOString().substring(0,10),[r,i]=l.useState({equipmentId:(s==null?void 0:s.equipmentId)||"",tipo:(s==null?void 0:s.tipo)||"",nombre:(s==null?void 0:s.nombre)||"",descripcion:(s==null?void 0:s.descripcion)||"",frecuenciaDias:(s==null?void 0:s.frecuenciaDias)||30,proximaEjecucion:o(),asignadoA:(s==null?void 0:s.asignadoA)||"",checklist:((w=s==null?void 0:s.checklist)==null?void 0:w.map(b=>({id:b.id,tarea:b.tarea,completado:b.completado})))||[{id:"1",tarea:"",completado:!1}]}),[c,d]=l.useState(!1),m=async b=>{b.preventDefault(),d(!0);try{const p={...r,proximaEjecucion:new Date(r.proximaEjecucion),checklist:r.checklist.filter(h=>h.tarea.trim()!==""),activo:!0};s?await kr(s.id,p):await Rc(p),n(),a()}catch(p){console.error("Error saving task:",p)}finally{d(!1)}},x=()=>{i({...r,checklist:[...r.checklist,{id:String(Date.now()),tarea:"",completado:!1}]})},u=(b,p)=>{const h=[...r.checklist],y=h[b];y&&(h[b]={id:y.id,tarea:p,completado:y.completado},i({...r,checklist:h}))},g=b=>{i({...r,checklist:r.checklist.filter((p,h)=>h!==b)})};return e.jsxs(pe,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{children:e.jsx(Ne,{children:s?"Editar Tarea":"Nueva Tarea Preventiva"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Equipo *"}),e.jsxs(ne,{value:r.equipmentId,onValueChange:b=>i({...r,equipmentId:b}),required:!0,children:[e.jsx(se,{children:e.jsx(oe,{placeholder:"Seleccionar equipo"})}),e.jsx(te,{children:t.map(b=>e.jsxs(F,{value:b.id,children:[b.nombre," (",b.codigo,")"]},b.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Tipo de Tarea *"}),e.jsxs(ne,{value:r.tipo,onValueChange:b=>i({...r,tipo:b}),required:!0,children:[e.jsx(se,{children:e.jsx(oe,{placeholder:"Seleccionar tipo"})}),e.jsx(te,{children:Er.map(b=>e.jsx(F,{value:b.value,children:b.label},b.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Frecuencia *"}),e.jsxs(ne,{value:String(r.frecuenciaDias),onValueChange:b=>i({...r,frecuenciaDias:Number(b)}),children:[e.jsx(se,{children:e.jsx(oe,{placeholder:"Seleccionar"})}),e.jsx(te,{children:_c.map(b=>e.jsx(F,{value:String(b.value),children:b.label},b.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Nombre de la Tarea *"}),e.jsx(X,{value:r.nombre,onChange:b=>i({...r,nombre:b.target.value}),placeholder:"Ej: Lubricación de rodamientos",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Descripción"}),e.jsx(_e,{value:r.descripcion,onChange:b=>i({...r,descripcion:b.target.value}),placeholder:"Instrucciones adicionales...",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Próxima Ejecución *"}),e.jsx(X,{type:"date",value:r.proximaEjecucion,onChange:b=>i({...r,proximaEjecucion:b.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Checklist de Tareas"}),e.jsxs("div",{className:"space-y-2",children:[r.checklist.map((b,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(X,{value:b.tarea,onChange:h=>u(p,h.target.value),placeholder:`Paso ${p+1}`}),r.checklist.length>1&&e.jsx(S,{type:"button",variant:"ghost",size:"icon",onClick:()=>g(p),children:e.jsx(xs,{className:"h-4 w-4"})})]},b.id)),e.jsxs(S,{type:"button",variant:"outline",size:"sm",onClick:x,children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Agregar paso"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(S,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(S,{type:"submit",disabled:c,children:c?"Guardando...":s?"Actualizar":"Crear Tarea"})]})]})]})}function Vc({task:s,equipment:t,userId:a,onClose:n,onSave:o}){const r=t.find(h=>h.id===s.equipmentId),[i,c]=l.useState(s.checklist.map(h=>({...h,completado:!1,observacion:""}))),[d,m]=l.useState(""),[x,u]=l.useState(30),[g,w]=l.useState(!1),b=i.every(h=>h.completado),p=async h=>{if(h.preventDefault(),!b){alert("Debes completar todas las tareas del checklist");return}w(!0);try{await zc({taskId:s.id,equipmentId:s.equipmentId,ejecutadoPor:a,fechaEjecucion:new Date,checklistCompletado:i,observaciones:d,fotos:[],duracionMinutos:x}),o(),n()}catch(y){console.error("Error executing task:",y)}finally{w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsxs(Ne,{children:["Ejecutar: ",s.nombre]})}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:["Equipo: ",e.jsx("span",{className:"font-medium text-foreground",children:r==null?void 0:r.nombre})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Checklist"}),e.jsx("div",{className:"space-y-2 border rounded-lg p-3",children:i.map((h,y)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xa,{id:`check-${h.id}`,checked:h.completado,onCheckedChange:v=>{const N=[...i];N[y]={...h,completado:v},c(N)}}),e.jsx("label",{htmlFor:`check-${h.id}`,className:k("text-sm cursor-pointer",h.completado&&"line-through text-muted-foreground"),children:h.tarea})]}),h.completado&&e.jsx(X,{placeholder:"Observación (opcional)",value:h.observacion,onChange:v=>{const N=[...i];N[y]={...h,observacion:v.target.value},c(N)},className:"ml-6 text-xs h-8"})]},h.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Duración (minutos)"}),e.jsx(X,{type:"number",value:x,onChange:h=>u(Number(h.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Observaciones generales"}),e.jsx(_e,{value:d,onChange:h=>m(h.target.value),placeholder:"Notas adicionales...",rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(S,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),e.jsx(S,{type:"submit",disabled:g||!b,children:g?"Guardando...":"Completar Ejecución"})]})]})]})}function qc({children:s}){const{isAuthenticated:t,isLoading:a}=ie();return a?e.jsx(nr,{}):t?e.jsx(e.Fragment,{children:s}):e.jsx(Js,{to:"/login",replace:!0})}function Uc({children:s}){const{isAuthenticated:t,isLoading:a}=ie();return a?e.jsx(nr,{}):t?e.jsx(Js,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:s})}function Bc(){const{setUser:s,setLoading:t}=ie();return l.useEffect(()=>{const a=Pn(async n=>{if(n)try{const o=await ra(n.uid);s(o)}catch(o){console.error("Error fetching user:",o),s(null)}else s(null)});return()=>a()},[s,t]),e.jsx(Pi,{children:e.jsx(un,{basename:"/mantenimiento-planta",children:e.jsxs(mn,{children:[e.jsx(Ce,{path:"/login",element:e.jsx(Uc,{children:e.jsx(qi,{})})}),e.jsxs(Ce,{path:"/",element:e.jsx(qc,{children:e.jsx(Vi,{})}),children:[e.jsx(Ce,{index:!0,element:e.jsx(Bi,{})}),e.jsx(Ce,{path:"incidents",element:e.jsx(ic,{})}),e.jsx(Ce,{path:"map",element:e.jsx(fc,{})}),e.jsx(Ce,{path:"equipment",element:e.jsx(wc,{})}),e.jsx(Ce,{path:"preventive",element:e.jsx(Oc,{})}),e.jsx(Ce,{path:"settings",element:e.jsx(kc,{})})]}),e.jsx(Ce,{path:"*",element:e.jsx(Js,{to:"/",replace:!0})})]})})})}In.createRoot(document.getElementById("root")).render(e.jsx(us.StrictMode,{children:e.jsx(Bc,{})}));
