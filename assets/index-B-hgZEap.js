import{j as e,c as qr,O as qt,P as Ur,C as Ut,a as Br,T as Bt,D as Ht,R as Hr,b as Gr,d as Gt,I as Zr,S as Zt,e as Yt,f as Yr,g as Wt,V as Wr,L as Xt,h as Kt,i as Xr,k as Kr,l as Jt,m as Jr,n as Qr,u as ks,o as Ks,p as Js,q as ze,r as Je,s as Qt,t as ea,v as sa,w as en,x as qs,y as ta,z as sn,A as tn,B as an,E as rn}from"./ui-DkQ0Gqwz.js";import{e as nn,g as on,d as us,a as c,R as cn,r as ln,u as Qs,N as dn,O as un,B as mn,f as hn,h as Me,i as et}from"./vendor-BtbATzP-.js";import{i as xn,g as pn,c as fn,d as gn,o as jn,s as vn,e as aa,f as bn,u as yn,h as We,j as te,k as ts,l as Nn,m as st,q as Re,w as as,n as ge,p as Ue,r as re,t as _e,v as wn,x as Cn,T as Te,y as Es,z as Sn,A as tt,B as kn,C as ra,D as at,E as na}from"./firebase-CyPWyDAX.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();var bs={},Et;function En(){if(Et)return bs;Et=1;var s=nn();return bs.createRoot=s.createRoot,bs.hydrateRoot=s.hydrateRoot,bs}var In=En();const An=on(In),Mn={apiKey:"AIzaSyBsJSh6x3ZGEyuXsM18dSWsJKyU7--KJss",authDomain:"mantenimiento-planta-771a3.firebaseapp.com",projectId:"mantenimiento-planta-771a3",storageBucket:"mantenimiento-planta-771a3.firebasestorage.app",messagingSenderId:"1019421112530",appId:"1:1019421112530:web:9afd9962e0b53152f8d50b"},rt=xn(Mn),hs=pn(rt),H=fn(rt),Is=gn(rt);async function Dn(s,t){const a=await vn(hs,s,t),n=await oa(a.user.uid);if(!n)throw new Error("Usuario no encontrado en la base de datos");if(!n.activo)throw await aa(hs),new Error("Usuario desactivado. Contacte al administrador.");return n}async function Rn(s,t,a,n,o){const r=await Pn(o);if(!r)throw new Error("Código de invitación inválido o expirado");const i=await bn(hs,s,t);await yn(i.user,{displayName:`${a} ${n}`});const l={id:i.user.uid,email:s,nombre:a,apellido:n,rol:r.rol,activo:!0,createdAt:new Date,updatedAt:new Date};return await We(te(H,"users",i.user.uid),{...l,createdAt:re(),updatedAt:re()}),await ts(te(H,"inviteCodes",r.id),{usosActuales:Nn(1)}),l}async function Tn(){await aa(hs)}async function oa(s){var o,r;const t=te(H,"users",s),a=await st(t);if(!a.exists())return null;const n=a.data();return{id:a.id,...n,createdAt:((o=n.createdAt)==null?void 0:o.toDate())||new Date,updatedAt:((r=n.updatedAt)==null?void 0:r.toDate())||new Date}}async function Pn(s){var i,l;const t=Re(ge(H,"inviteCodes"),as("code","==",s.toUpperCase()),as("activo","==",!0)),a=await Ue(t);if(a.empty)return null;const n=a.docs[0];if(!n)return null;const o=n.data(),r={id:n.id,code:o.code,rol:o.rol,usosMaximos:o.usosMaximos,usosActuales:o.usosActuales,activo:o.activo,createdBy:o.createdBy,createdAt:((i=o.createdAt)==null?void 0:i.toDate())||new Date,expiresAt:(l=o.expiresAt)==null?void 0:l.toDate()};return r.expiresAt&&r.expiresAt<new Date||r.usosActuales>=r.usosMaximos?null:r}function zn(s){return jn(hs,s)}const It=s=>{let t;const a=new Set,n=(u,h)=>{const m=typeof u=="function"?u(t):u;if(!Object.is(m,t)){const b=t;t=h??(typeof m!="object"||m===null)?m:Object.assign({},t,m),a.forEach(C=>C(t,b))}},o=()=>t,l={setState:n,getState:o,getInitialState:()=>d,subscribe:u=>(a.add(u),()=>a.delete(u))},d=t=s(n,o,l);return l},Ln=(s=>s?It(s):It),Fn=s=>s;function _n(s,t=Fn){const a=us.useSyncExternalStore(s.subscribe,us.useCallback(()=>t(s.getState()),[s,t]),us.useCallback(()=>t(s.getInitialState()),[s,t]));return us.useDebugValue(a),a}const At=s=>{const t=Ln(s),a=n=>_n(t,n);return Object.assign(a,t),a},ia=(s=>s?At(s):At);function On(s,t){let a;try{a=s()}catch{return}return{getItem:o=>{var r;const i=d=>d===null?null:JSON.parse(d,void 0),l=(r=a.getItem(o))!=null?r:null;return l instanceof Promise?l.then(i):i(l)},setItem:(o,r)=>a.setItem(o,JSON.stringify(r,void 0)),removeItem:o=>a.removeItem(o)}}const Us=s=>t=>{try{const a=s(t);return a instanceof Promise?a:{then(n){return Us(n)(a)},catch(n){return this}}}catch(a){return{then(n){return this},catch(n){return Us(n)(a)}}}},$n=(s,t)=>(a,n,o)=>{let r={storage:On(()=>localStorage),partialize:p=>p,version:0,merge:(p,x)=>({...x,...p}),...t},i=!1;const l=new Set,d=new Set;let u=r.storage;if(!u)return s((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...p)},n,o);const h=()=>{const p=r.partialize({...n()});return u.setItem(r.name,{state:p,version:r.version})},m=o.setState;o.setState=(p,x)=>(m(p,x),h());const b=s((...p)=>(a(...p),h()),n,o);o.getInitialState=()=>b;let C;const j=()=>{var p,x;if(!u)return;i=!1,l.forEach(y=>{var g;return y((g=n())!=null?g:b)});const w=((x=r.onRehydrateStorage)==null?void 0:x.call(r,(p=n())!=null?p:b))||void 0;return Us(u.getItem.bind(u))(r.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==r.version){if(r.migrate){const g=r.migrate(y.state,y.version);return g instanceof Promise?g.then(I=>[!0,I]):[!0,g]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var g;const[I,Z]=y;if(C=r.merge(Z,(g=n())!=null?g:b),a(C,!0),I)return h()}).then(()=>{w==null||w(C,void 0),C=n(),i=!0,d.forEach(y=>y(C))}).catch(y=>{w==null||w(void 0,y)})};return o.persist={setOptions:p=>{r={...r,...p},p.storage&&(u=p.storage)},clearStorage:()=>{u==null||u.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>j(),hasHydrated:()=>i,onHydrate:p=>(l.add(p),()=>{l.delete(p)}),onFinishHydration:p=>(d.add(p),()=>{d.delete(p)})},r.skipHydration||j(),C||b},Vn=$n,oe=ia()(Vn(s=>({user:null,isAuthenticated:!1,isLoading:!0,setUser:t=>s({user:t,isAuthenticated:!!t,isLoading:!1}),setLoading:t=>s({isLoading:t}),logout:()=>s({user:null,isAuthenticated:!1,isLoading:!1})}),{name:"auth-storage",partialize:s=>({user:s.user,isAuthenticated:s.isAuthenticated})}));function ca(){const s=oe(t=>t.user);return(s==null?void 0:s.rol)==="admin"}function qn(){const s=oe(t=>t.user);return(s==null?void 0:s.rol)==="supervisor"||(s==null?void 0:s.rol)==="admin"}const rs=ia(s=>({incidents:[],selectedIncident:null,setIncidents:t=>s({incidents:t}),setSelectedIncident:t=>s({selectedIncident:t}),addIncident:t=>s(a=>({incidents:[t,...a.incidents]})),updateIncident:(t,a)=>s(n=>({incidents:n.incidents.map(o=>o.id===t?{...o,...a}:o)})),removeIncident:t=>s(a=>({incidents:a.incidents.filter(n=>n.id!==t)})),zones:[],selectedZone:null,setZones:t=>s({zones:t}),setSelectedZone:t=>s({selectedZone:t}),equipment:[],selectedEquipment:null,setEquipment:t=>s({equipment:t}),setSelectedEquipment:t=>s({selectedEquipment:t}),sidebarOpen:!0,toggleSidebar:()=>s(t=>({sidebarOpen:!t.sidebarOpen})),setSidebarOpen:t=>s({sidebarOpen:t}),mapImage:null,setMapImage:t=>s({mapImage:t})}));var Un=Symbol.for("react.lazy"),Cs=cn[" use ".trim().toString()];function Bn(s){return typeof s=="object"&&s!==null&&"then"in s}function la(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===Un&&"_payload"in s&&Bn(s._payload)}function da(s){const t=Gn(s),a=c.forwardRef((n,o)=>{let{children:r,...i}=n;la(r)&&typeof Cs=="function"&&(r=Cs(r._payload));const l=c.Children.toArray(r),d=l.find(Yn);if(d){const u=d.props.children,h=l.map(m=>m===d?c.Children.count(u)>1?c.Children.only(null):c.isValidElement(u)?u.props.children:null:m);return e.jsx(t,{...i,ref:o,children:c.isValidElement(u)?c.cloneElement(u,void 0,h):null})}return e.jsx(t,{...i,ref:o,children:r})});return a.displayName=`${s}.Slot`,a}var Hn=da("Slot");function Gn(s){const t=c.forwardRef((a,n)=>{let{children:o,...r}=a;if(la(o)&&typeof Cs=="function"&&(o=Cs(o._payload)),c.isValidElement(o)){const i=Xn(o),l=Wn(r,o.props);return o.type!==c.Fragment&&(l.ref=n?qr(n,i):i),c.cloneElement(o,l)}return c.Children.count(o)>1?c.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var Zn=Symbol("radix.slottable");function Yn(s){return c.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Zn}function Wn(s,t){const a={...t};for(const n in t){const o=s[n],r=t[n];/^on[A-Z]/.test(n)?o&&r?a[n]=(...l)=>{const d=r(...l);return o(...l),d}:o&&(a[n]=o):n==="style"?a[n]={...o,...r}:n==="className"&&(a[n]=[o,r].filter(Boolean).join(" "))}return{...s,...a}}function Xn(s){var n,o;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,a=t&&"isReactWarning"in t&&t.isReactWarning;return a?s.ref:(t=(o=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:o.get,a=t&&"isReactWarning"in t&&t.isReactWarning,a?s.props.ref:s.props.ref||s.ref)}function ua(s){var t,a,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var o=s.length;for(t=0;t<o;t++)s[t]&&(a=ua(s[t]))&&(n&&(n+=" "),n+=a)}else for(a in s)s[a]&&(n&&(n+=" "),n+=a);return n}function ma(){for(var s,t,a=0,n="",o=arguments.length;a<o;a++)(s=arguments[a])&&(t=ua(s))&&(n&&(n+=" "),n+=t);return n}const Mt=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,Dt=ma,nt=(s,t)=>a=>{var n;if((t==null?void 0:t.variants)==null)return Dt(s,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:o,defaultVariants:r}=t,i=Object.keys(o).map(u=>{const h=a==null?void 0:a[u],m=r==null?void 0:r[u];if(h===null)return null;const b=Mt(h)||Mt(m);return o[u][b]}),l=a&&Object.entries(a).reduce((u,h)=>{let[m,b]=h;return b===void 0||(u[m]=b),u},{}),d=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,h)=>{let{class:m,className:b,...C}=h;return Object.entries(C).every(j=>{let[p,x]=j;return Array.isArray(x)?x.includes({...r,...l}[p]):{...r,...l}[p]===x})?[...u,m,b]:u},[]);return Dt(s,i,d,a==null?void 0:a.class,a==null?void 0:a.className)},ot="-",Kn=s=>{const t=Qn(s),{conflictingClassGroups:a,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:i=>{const l=i.split(ot);return l[0]===""&&l.length!==1&&l.shift(),ha(l,t)||Jn(i)},getConflictingClassGroupIds:(i,l)=>{const d=a[i]||[];return l&&n[i]?[...d,...n[i]]:d}}},ha=(s,t)=>{var i;if(s.length===0)return t.classGroupId;const a=s[0],n=t.nextPart.get(a),o=n?ha(s.slice(1),n):void 0;if(o)return o;if(t.validators.length===0)return;const r=s.join(ot);return(i=t.validators.find(({validator:l})=>l(r)))==null?void 0:i.classGroupId},Rt=/^\[(.+)\]$/,Jn=s=>{if(Rt.test(s)){const t=Rt.exec(s)[1],a=t==null?void 0:t.substring(0,t.indexOf(":"));if(a)return"arbitrary.."+a}},Qn=s=>{const{theme:t,prefix:a}=s,n={nextPart:new Map,validators:[]};return so(Object.entries(s.classGroups),a).forEach(([r,i])=>{Bs(i,n,r,t)}),n},Bs=(s,t,a,n)=>{s.forEach(o=>{if(typeof o=="string"){const r=o===""?t:Tt(t,o);r.classGroupId=a;return}if(typeof o=="function"){if(eo(o)){Bs(o(n),t,a,n);return}t.validators.push({validator:o,classGroupId:a});return}Object.entries(o).forEach(([r,i])=>{Bs(i,Tt(t,r),a,n)})})},Tt=(s,t)=>{let a=s;return t.split(ot).forEach(n=>{a.nextPart.has(n)||a.nextPart.set(n,{nextPart:new Map,validators:[]}),a=a.nextPart.get(n)}),a},eo=s=>s.isThemeGetter,so=(s,t)=>t?s.map(([a,n])=>{const o=n.map(r=>typeof r=="string"?t+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([i,l])=>[t+i,l])):r);return[a,o]}):s,to=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,a=new Map,n=new Map;const o=(r,i)=>{a.set(r,i),t++,t>s&&(t=0,n=a,a=new Map)};return{get(r){let i=a.get(r);if(i!==void 0)return i;if((i=n.get(r))!==void 0)return o(r,i),i},set(r,i){a.has(r)?a.set(r,i):o(r,i)}}},xa="!",ao=s=>{const{separator:t,experimentalParseClassName:a}=s,n=t.length===1,o=t[0],r=t.length,i=l=>{const d=[];let u=0,h=0,m;for(let x=0;x<l.length;x++){let w=l[x];if(u===0){if(w===o&&(n||l.slice(x,x+r)===t)){d.push(l.slice(h,x)),h=x+r;continue}if(w==="/"){m=x;continue}}w==="["?u++:w==="]"&&u--}const b=d.length===0?l:l.substring(h),C=b.startsWith(xa),j=C?b.substring(1):b,p=m&&m>h?m-h:void 0;return{modifiers:d,hasImportantModifier:C,baseClassName:j,maybePostfixModifierPosition:p}};return a?l=>a({className:l,parseClassName:i}):i},ro=s=>{if(s.length<=1)return s;const t=[];let a=[];return s.forEach(n=>{n[0]==="["?(t.push(...a.sort(),n),a=[]):a.push(n)}),t.push(...a.sort()),t},no=s=>({cache:to(s.cacheSize),parseClassName:ao(s),...Kn(s)}),oo=/\s+/,io=(s,t)=>{const{parseClassName:a,getClassGroupId:n,getConflictingClassGroupIds:o}=t,r=[],i=s.trim().split(oo);let l="";for(let d=i.length-1;d>=0;d-=1){const u=i[d],{modifiers:h,hasImportantModifier:m,baseClassName:b,maybePostfixModifierPosition:C}=a(u);let j=!!C,p=n(j?b.substring(0,C):b);if(!p){if(!j){l=u+(l.length>0?" "+l:l);continue}if(p=n(b),!p){l=u+(l.length>0?" "+l:l);continue}j=!1}const x=ro(h).join(":"),w=m?x+xa:x,y=w+p;if(r.includes(y))continue;r.push(y);const g=o(p,j);for(let I=0;I<g.length;++I){const Z=g[I];r.push(w+Z)}l=u+(l.length>0?" "+l:l)}return l};function co(){let s=0,t,a,n="";for(;s<arguments.length;)(t=arguments[s++])&&(a=pa(t))&&(n&&(n+=" "),n+=a);return n}const pa=s=>{if(typeof s=="string")return s;let t,a="";for(let n=0;n<s.length;n++)s[n]&&(t=pa(s[n]))&&(a&&(a+=" "),a+=t);return a};function lo(s,...t){let a,n,o,r=i;function i(d){const u=t.reduce((h,m)=>m(h),s());return a=no(u),n=a.cache.get,o=a.cache.set,r=l,l(d)}function l(d){const u=n(d);if(u)return u;const h=io(d,a);return o(d,h),h}return function(){return r(co.apply(null,arguments))}}const X=s=>{const t=a=>a[s]||[];return t.isThemeGetter=!0,t},fa=/^\[(?:([a-z-]+):)?(.+)\]$/i,uo=/^\d+\/\d+$/,mo=new Set(["px","full","screen"]),ho=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xo=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,po=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,fo=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,go=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,De=s=>Qe(s)||mo.has(s)||uo.test(s),Le=s=>ns(s,"length",So),Qe=s=>!!s&&!Number.isNaN(Number(s)),Fs=s=>ns(s,"number",Qe),cs=s=>!!s&&Number.isInteger(Number(s)),jo=s=>s.endsWith("%")&&Qe(s.slice(0,-1)),_=s=>fa.test(s),Fe=s=>ho.test(s),vo=new Set(["length","size","percentage"]),bo=s=>ns(s,vo,ga),yo=s=>ns(s,"position",ga),No=new Set(["image","url"]),wo=s=>ns(s,No,Eo),Co=s=>ns(s,"",ko),ls=()=>!0,ns=(s,t,a)=>{const n=fa.exec(s);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):a(n[2]):!1},So=s=>xo.test(s)&&!po.test(s),ga=()=>!1,ko=s=>fo.test(s),Eo=s=>go.test(s),Io=()=>{const s=X("colors"),t=X("spacing"),a=X("blur"),n=X("brightness"),o=X("borderColor"),r=X("borderRadius"),i=X("borderSpacing"),l=X("borderWidth"),d=X("contrast"),u=X("grayscale"),h=X("hueRotate"),m=X("invert"),b=X("gap"),C=X("gradientColorStops"),j=X("gradientColorStopPositions"),p=X("inset"),x=X("margin"),w=X("opacity"),y=X("padding"),g=X("saturate"),I=X("scale"),Z=X("sepia"),A=X("skew"),W=X("space"),pe=X("translate"),le=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],de=()=>["auto",_,t],q=()=>[_,t],fe=()=>["",De,Le],ae=()=>["auto",Qe,_],Se=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ke=()=>["solid","dashed","dotted","double","none"],Ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],S=()=>["start","end","center","between","around","evenly","stretch"],T=()=>["","0",_],se=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[Qe,_];return{cacheSize:500,separator:":",theme:{colors:[ls],spacing:[De,Le],blur:["none","",Fe,_],brightness:K(),borderColor:[s],borderRadius:["none","","full",Fe,_],borderSpacing:q(),borderWidth:fe(),contrast:K(),grayscale:T(),hueRotate:K(),invert:T(),gap:q(),gradientColorStops:[s],gradientColorStopPositions:[jo,Le],inset:de(),margin:de(),opacity:K(),padding:q(),saturate:K(),scale:K(),sepia:T(),skew:K(),space:q(),translate:q()},classGroups:{aspect:[{aspect:["auto","square","video",_]}],container:["container"],columns:[{columns:[Fe]}],"break-after":[{"break-after":se()}],"break-before":[{"break-before":se()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Se(),_]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:le()}],"overscroll-x":[{"overscroll-x":le()}],"overscroll-y":[{"overscroll-y":le()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",cs,_]}],basis:[{basis:de()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",_]}],grow:[{grow:T()}],shrink:[{shrink:T()}],order:[{order:["first","last","none",cs,_]}],"grid-cols":[{"grid-cols":[ls]}],"col-start-end":[{col:["auto",{span:["full",cs,_]},_]}],"col-start":[{"col-start":ae()}],"col-end":[{"col-end":ae()}],"grid-rows":[{"grid-rows":[ls]}],"row-start-end":[{row:["auto",{span:[cs,_]},_]}],"row-start":[{"row-start":ae()}],"row-end":[{"row-end":ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",_]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",_]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...S()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...S(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...S(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[W]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[W]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",_,t]}],"min-w":[{"min-w":[_,t,"min","max","fit"]}],"max-w":[{"max-w":[_,t,"none","full","min","max","fit","prose",{screen:[Fe]},Fe]}],h:[{h:[_,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[_,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[_,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[_,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Fe,Le]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Fs]}],"font-family":[{font:[ls]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",_]}],"line-clamp":[{"line-clamp":["none",Qe,Fs]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",De,_]}],"list-image":[{"list-image":["none",_]}],"list-style-type":[{list:["none","disc","decimal",_]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[s]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[s]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ke(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",De,Le]}],"underline-offset":[{"underline-offset":["auto",De,_]}],"text-decoration-color":[{decoration:[s]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:q()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Se(),yo]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",bo]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},wo]}],"bg-color":[{bg:[s]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[C]}],"gradient-via":[{via:[C]}],"gradient-to":[{to:[C]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...ke(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:ke()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...ke()]}],"outline-offset":[{"outline-offset":[De,_]}],"outline-w":[{outline:[De,Le]}],"outline-color":[{outline:[s]}],"ring-w":[{ring:fe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[s]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[De,Le]}],"ring-offset-color":[{"ring-offset":[s]}],shadow:[{shadow:["","inner","none",Fe,Co]}],"shadow-color":[{shadow:[ls]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...Ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Ee()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Fe,_]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[m]}],saturate:[{saturate:[g]}],sepia:[{sepia:[Z]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[g]}],"backdrop-sepia":[{"backdrop-sepia":[Z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",_]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",_]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",_]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[cs,_]}],"translate-x":[{"translate-x":[pe]}],"translate-y":[{"translate-y":[pe]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",_]}],accent:[{accent:["auto",s]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_]}],"caret-color":[{caret:[s]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":q()}],"scroll-mx":[{"scroll-mx":q()}],"scroll-my":[{"scroll-my":q()}],"scroll-ms":[{"scroll-ms":q()}],"scroll-me":[{"scroll-me":q()}],"scroll-mt":[{"scroll-mt":q()}],"scroll-mr":[{"scroll-mr":q()}],"scroll-mb":[{"scroll-mb":q()}],"scroll-ml":[{"scroll-ml":q()}],"scroll-p":[{"scroll-p":q()}],"scroll-px":[{"scroll-px":q()}],"scroll-py":[{"scroll-py":q()}],"scroll-ps":[{"scroll-ps":q()}],"scroll-pe":[{"scroll-pe":q()}],"scroll-pt":[{"scroll-pt":q()}],"scroll-pr":[{"scroll-pr":q()}],"scroll-pb":[{"scroll-pb":q()}],"scroll-pl":[{"scroll-pl":q()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_]}],fill:[{fill:[s,"none"]}],"stroke-w":[{stroke:[De,Le,Fs]}],stroke:[{stroke:[s,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Ao=lo(Io);function E(...s){return Ao(ma(s))}function ja(s){return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(s))}function xs(s){const t=new Date,a=new Date(s),n=t.getTime()-a.getTime(),o=Math.floor(n/6e4),r=Math.floor(n/36e5),i=Math.floor(n/864e5);return o<1?"Hace un momento":o<60?`Hace ${o} min`:r<24?`Hace ${r}h`:i<7?`Hace ${i} días`:ja(s)}function it(){return`${Date.now()}-${Math.random().toString(36).substring(2,9)}`}const Mo=nt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90",warning:"bg-warning text-warning-foreground hover:bg-warning/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),k=c.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...o},r)=>{const i=n?Hn:"button";return e.jsx(i,{className:E(Mo({variant:t,size:a,className:s})),ref:r,...o})});k.displayName="Button";const J=c.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:E("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...a}));J.displayName="Input";var Do=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],As=Do.reduce((s,t)=>{const a=da(`Primitive.${t}`),n=c.forwardRef((o,r)=>{const{asChild:i,...l}=o,d=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...l,ref:r})});return n.displayName=`Primitive.${t}`,{...s,[t]:n}},{}),Ro="Label",va=c.forwardRef((s,t)=>e.jsx(As.label,{...s,ref:t,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=s.onMouseDown)==null||o.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));va.displayName=Ro;var ba=va;const To=nt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),z=c.forwardRef(({className:s,...t},a)=>e.jsx(ba,{ref:a,className:E(To(),s),...t}));z.displayName=ba.displayName;const P=c.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:E("rounded-lg border border-border bg-card text-card-foreground shadow-sm",s),...t}));P.displayName="Card";const Q=c.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:E("flex flex-col space-y-1.5 p-6",s),...t}));Q.displayName="CardHeader";const ee=c.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:E("text-2xl font-semibold leading-none tracking-tight",s),...t}));ee.displayName="CardTitle";const ya=c.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:E("text-sm text-muted-foreground",s),...t}));ya.displayName="CardDescription";const F=c.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:E("p-6 pt-0",s),...t}));F.displayName="CardContent";const Po=c.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:E("flex items-center p-6 pt-0",s),...t}));Po.displayName="CardFooter";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Na=(...s)=>s.filter((t,a,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===a).join(" ").trim();/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=c.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:o="",children:r,iconNode:i,...l},d)=>c.createElement("svg",{ref:d,...Lo,width:t,height:t,stroke:s,strokeWidth:n?Number(a)*24/Number(t):a,className:Na("lucide",o),...l},[...i.map(([u,h])=>c.createElement(u,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=(s,t)=>{const a=c.forwardRef(({className:n,...o},r)=>c.createElement(Fo,{ref:r,iconNode:t,className:Na(`lucide-${zo(s)}`,n),...o}));return a.displayName=`${s}`,a};/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=R("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=R("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=R("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=R("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=R("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=R("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=R("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=R("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=R("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=R("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=R("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=R("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=R("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=R("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=R("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=R("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=R("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=R("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=R("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=R("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=R("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=R("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=R("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=R("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=R("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=R("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=R("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=R("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=R("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=R("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=R("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=R("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=R("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=R("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=R("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=R("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=R("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=R("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=R("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=R("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=R("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=R("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=R("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=R("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=R("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=R("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=R("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=R("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=R("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=R("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),be=Hr,ri=Gr,ni=Ur,Ta=c.forwardRef(({className:s,...t},a)=>e.jsx(qt,{ref:a,className:E("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Ta.displayName=qt.displayName;const je=c.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(ni,{children:[e.jsx(Ta,{}),e.jsxs(Ut,{ref:n,"aria-describedby":void 0,className:E("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-card p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(Br,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Cerrar"})]})]})]}));je.displayName=Ut.displayName;const ye=({className:s,...t})=>e.jsx("div",{className:E("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});ye.displayName="DialogHeader";const fs=({className:s,...t})=>e.jsx("div",{className:E("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});fs.displayName="DialogFooter";const Ne=c.forwardRef(({className:s,...t},a)=>e.jsx(Bt,{ref:a,className:E("text-lg font-semibold leading-none tracking-tight",s),...t}));Ne.displayName=Bt.displayName;const oi=c.forwardRef(({className:s,...t},a)=>e.jsx(Ht,{ref:a,className:E("text-sm text-muted-foreground",s),...t}));oi.displayName=Ht.displayName;const me=Jr,he=Qr,ie=c.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(Gt,{ref:n,className:E("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(Zr,{asChild:!0,children:e.jsx(lt,{className:"h-4 w-4 opacity-50"})})]}));ie.displayName=Gt.displayName;const Pa=c.forwardRef(({className:s,...t},a)=>e.jsx(Zt,{ref:a,className:E("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Vo,{className:"h-4 w-4"})}));Pa.displayName=Zt.displayName;const za=c.forwardRef(({className:s,...t},a)=>e.jsx(Yt,{ref:a,className:E("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(lt,{className:"h-4 w-4"})}));za.displayName=Yt.displayName;const ce=c.forwardRef(({className:s,children:t,position:a="popper",...n},o)=>e.jsx(Yr,{children:e.jsxs(Wt,{ref:o,className:E("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...n,children:[e.jsx(Pa,{}),e.jsx(Wr,{className:E("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(za,{})]})}));ce.displayName=Wt.displayName;const ii=c.forwardRef(({className:s,...t},a)=>e.jsx(Xt,{ref:a,className:E("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));ii.displayName=Xt.displayName;const O=c.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(Kt,{ref:n,className:E("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Xr,{children:e.jsx(Ss,{className:"h-4 w-4"})})}),e.jsx(Kr,{children:t})]}));O.displayName=Kt.displayName;const ci=c.forwardRef(({className:s,...t},a)=>e.jsx(Jt,{ref:a,className:E("-mx-1 my-1 h-px bg-muted",s),...t}));ci.displayName=Jt.displayName;var Ds="Switch",[li]=Js(Ds),[di,ui]=li(Ds),La=c.forwardRef((s,t)=>{const{__scopeSwitch:a,name:n,checked:o,defaultChecked:r,required:i,disabled:l,value:d="on",onCheckedChange:u,form:h,...m}=s,[b,C]=c.useState(null),j=ks(t,g=>C(g)),p=c.useRef(!1),x=b?h||!!b.closest("form"):!0,[w,y]=Ks({prop:o,defaultProp:r??!1,onChange:u,caller:Ds});return e.jsxs(di,{scope:a,checked:w,disabled:l,children:[e.jsx(ze.button,{type:"button",role:"switch","aria-checked":w,"aria-required":i,"data-state":$a(w),"data-disabled":l?"":void 0,disabled:l,value:d,...m,ref:j,onClick:Je(s.onClick,g=>{y(I=>!I),x&&(p.current=g.isPropagationStopped(),p.current||g.stopPropagation())})}),x&&e.jsx(Oa,{control:b,bubbles:!p.current,name:n,value:d,checked:w,required:i,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});La.displayName=Ds;var Fa="SwitchThumb",_a=c.forwardRef((s,t)=>{const{__scopeSwitch:a,...n}=s,o=ui(Fa,a);return e.jsx(ze.span,{"data-state":$a(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:t})});_a.displayName=Fa;var mi="SwitchBubbleInput",Oa=c.forwardRef(({__scopeSwitch:s,control:t,checked:a,bubbles:n=!0,...o},r)=>{const i=c.useRef(null),l=ks(i,r),d=Qt(a),u=ea(t);return c.useEffect(()=>{const h=i.current;if(!h)return;const m=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(m,"checked").set;if(d!==a&&C){const j=new Event("click",{bubbles:n});C.call(h,a),h.dispatchEvent(j)}},[d,a,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...o,tabIndex:-1,ref:l,style:{...o.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Oa.displayName=mi;function $a(s){return s?"checked":"unchecked"}var Va=La,hi=_a;const Ze=c.forwardRef(({className:s,...t},a)=>e.jsx(Va,{className:E("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,children:e.jsx(hi,{className:E("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ze.displayName=Va.displayName;var Rs="Checkbox",[xi]=Js(Rs),[pi,ht]=xi(Rs);function fi(s){const{__scopeCheckbox:t,checked:a,children:n,defaultChecked:o,disabled:r,form:i,name:l,onCheckedChange:d,required:u,value:h="on",internal_do_not_use_render:m}=s,[b,C]=Ks({prop:a,defaultProp:o??!1,onChange:d,caller:Rs}),[j,p]=c.useState(null),[x,w]=c.useState(null),y=c.useRef(!1),g=j?!!i||!!j.closest("form"):!0,I={checked:b,disabled:r,setChecked:C,control:j,setControl:p,name:l,form:i,value:h,hasConsumerStoppedPropagationRef:y,required:u,defaultChecked:$e(o)?!1:o,isFormControl:g,bubbleInput:x,setBubbleInput:w};return e.jsx(pi,{scope:t,...I,children:gi(m)?m(I):n})}var qa="CheckboxTrigger",Ua=c.forwardRef(({__scopeCheckbox:s,onKeyDown:t,onClick:a,...n},o)=>{const{control:r,value:i,disabled:l,checked:d,required:u,setControl:h,setChecked:m,hasConsumerStoppedPropagationRef:b,isFormControl:C,bubbleInput:j}=ht(qa,s),p=ks(o,h),x=c.useRef(d);return c.useEffect(()=>{const w=r==null?void 0:r.form;if(w){const y=()=>m(x.current);return w.addEventListener("reset",y),()=>w.removeEventListener("reset",y)}},[r,m]),e.jsx(ze.button,{type:"button",role:"checkbox","aria-checked":$e(d)?"mixed":d,"aria-required":u,"data-state":Ya(d),"data-disabled":l?"":void 0,disabled:l,value:i,...n,ref:p,onKeyDown:Je(t,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:Je(a,w=>{m(y=>$e(y)?!0:!y),j&&C&&(b.current=w.isPropagationStopped(),b.current||w.stopPropagation())})})});Ua.displayName=qa;var xt=c.forwardRef((s,t)=>{const{__scopeCheckbox:a,name:n,checked:o,defaultChecked:r,required:i,disabled:l,value:d,onCheckedChange:u,form:h,...m}=s;return e.jsx(fi,{__scopeCheckbox:a,checked:o,defaultChecked:r,disabled:l,required:i,onCheckedChange:u,name:n,form:h,value:d,internal_do_not_use_render:({isFormControl:b})=>e.jsxs(e.Fragment,{children:[e.jsx(Ua,{...m,ref:t,__scopeCheckbox:a}),b&&e.jsx(Za,{__scopeCheckbox:a})]})})});xt.displayName=Rs;var Ba="CheckboxIndicator",Ha=c.forwardRef((s,t)=>{const{__scopeCheckbox:a,forceMount:n,...o}=s,r=ht(Ba,a);return e.jsx(sa,{present:n||$e(r.checked)||r.checked===!0,children:e.jsx(ze.span,{"data-state":Ya(r.checked),"data-disabled":r.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...s.style}})})});Ha.displayName=Ba;var Ga="CheckboxBubbleInput",Za=c.forwardRef(({__scopeCheckbox:s,...t},a)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:r,defaultChecked:i,required:l,disabled:d,name:u,value:h,form:m,bubbleInput:b,setBubbleInput:C}=ht(Ga,s),j=ks(a,C),p=Qt(r),x=ea(n);c.useEffect(()=>{const y=b;if(!y)return;const g=window.HTMLInputElement.prototype,Z=Object.getOwnPropertyDescriptor(g,"checked").set,A=!o.current;if(p!==r&&Z){const W=new Event("click",{bubbles:A});y.indeterminate=$e(r),Z.call(y,$e(r)?!1:r),y.dispatchEvent(W)}},[b,p,r,o]);const w=c.useRef($e(r)?!1:r);return e.jsx(ze.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??w.current,required:l,disabled:d,name:u,value:h,form:m,...t,tabIndex:-1,ref:j,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Za.displayName=Ga;function gi(s){return typeof s=="function"}function $e(s){return s==="indeterminate"}function Ya(s){return $e(s)?"indeterminate":s?"checked":"unchecked"}const Wa=c.forwardRef(({className:s,...t},a)=>e.jsx(xt,{ref:a,className:E("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(Ha,{className:E("flex items-center justify-center text-current"),children:e.jsx(Ss,{className:"h-4 w-4"})})}));Wa.displayName=xt.displayName;function ji(s,t=[]){let a=[];function n(r,i){const l=c.createContext(i);l.displayName=r+"Context";const d=a.length;a=[...a,i];const u=m=>{var w;const{scope:b,children:C,...j}=m,p=((w=b==null?void 0:b[s])==null?void 0:w[d])||l,x=c.useMemo(()=>j,Object.values(j));return e.jsx(p.Provider,{value:x,children:C})};u.displayName=r+"Provider";function h(m,b){var p;const C=((p=b==null?void 0:b[s])==null?void 0:p[d])||l,j=c.useContext(C);if(j)return j;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${r}\``)}return[u,h]}const o=()=>{const r=a.map(i=>c.createContext(i));return function(l){const d=(l==null?void 0:l[s])||r;return c.useMemo(()=>({[`__scope${s}`]:{...l,[s]:d}}),[l,d])}};return o.scopeName=s,[n,vi(o,...t)]}function vi(...s){const t=s[0];if(s.length===1)return t;const a=()=>{const n=s.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(r){const i=n.reduce((l,{useScope:d,scopeName:u})=>{const m=d(r)[`__scope${u}`];return{...l,...m}},{});return c.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return a.scopeName=t.scopeName,a}var _s={exports:{}},Os={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ft;function bi(){if(Ft)return Os;Ft=1;var s=ln();function t(m,b){return m===b&&(m!==0||1/m===1/b)||m!==m&&b!==b}var a=typeof Object.is=="function"?Object.is:t,n=s.useState,o=s.useEffect,r=s.useLayoutEffect,i=s.useDebugValue;function l(m,b){var C=b(),j=n({inst:{value:C,getSnapshot:b}}),p=j[0].inst,x=j[1];return r(function(){p.value=C,p.getSnapshot=b,d(p)&&x({inst:p})},[m,C,b]),o(function(){return d(p)&&x({inst:p}),m(function(){d(p)&&x({inst:p})})},[m]),i(C),C}function d(m){var b=m.getSnapshot;m=m.value;try{var C=b();return!a(m,C)}catch{return!0}}function u(m,b){return b()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return Os.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:h,Os}var _t;function yi(){return _t||(_t=1,_s.exports=bi()),_s.exports}var Ni=yi();function wi(){return Ni.useSyncExternalStore(Ci,()=>!0,()=>!1)}function Ci(){return()=>{}}var pt="Avatar",[Si]=ji(pt),[ki,Xa]=Si(pt),Ka=c.forwardRef((s,t)=>{const{__scopeAvatar:a,...n}=s,[o,r]=c.useState("idle");return e.jsx(ki,{scope:a,imageLoadingStatus:o,onImageLoadingStatusChange:r,children:e.jsx(As.span,{...n,ref:t})})});Ka.displayName=pt;var Ja="AvatarImage",Qa=c.forwardRef((s,t)=>{const{__scopeAvatar:a,src:n,onLoadingStatusChange:o=()=>{},...r}=s,i=Xa(Ja,a),l=Ei(n,r),d=en(u=>{o(u),i.onImageLoadingStatusChange(u)});return qs(()=>{l!=="idle"&&d(l)},[l,d]),l==="loaded"?e.jsx(As.img,{...r,ref:t,src:n}):null});Qa.displayName=Ja;var er="AvatarFallback",sr=c.forwardRef((s,t)=>{const{__scopeAvatar:a,delayMs:n,...o}=s,r=Xa(er,a),[i,l]=c.useState(n===void 0);return c.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(d)}},[n]),i&&r.imageLoadingStatus!=="loaded"?e.jsx(As.span,{...o,ref:t}):null});sr.displayName=er;function Ot(s,t){return s?t?(s.src!==t&&(s.src=t),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Ei(s,{referrerPolicy:t,crossOrigin:a}){const n=wi(),o=c.useRef(null),r=n?(o.current||(o.current=new window.Image),o.current):null,[i,l]=c.useState(()=>Ot(r,s));return qs(()=>{l(Ot(r,s))},[r,s]),qs(()=>{const d=m=>()=>{l(m)};if(!r)return;const u=d("loaded"),h=d("error");return r.addEventListener("load",u),r.addEventListener("error",h),t&&(r.referrerPolicy=t),typeof a=="string"&&(r.crossOrigin=a),()=>{r.removeEventListener("load",u),r.removeEventListener("error",h)}},[r,a,t]),i}var tr=Ka,ar=Qa,rr=sr;const Zs=c.forwardRef(({className:s,...t},a)=>e.jsx(tr,{ref:a,className:E("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));Zs.displayName=tr.displayName;const Ii=c.forwardRef(({className:s,...t},a)=>e.jsx(ar,{ref:a,className:E("aspect-square h-full w-full",s),...t}));Ii.displayName=ar.displayName;const Ys=c.forwardRef(({className:s,...t},a)=>e.jsx(rr,{ref:a,className:E("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));Ys.displayName=rr.displayName;const Ai=nt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-warning text-warning-foreground hover:bg-warning/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Y({className:s,variant:t,...a}){return e.jsx("div",{className:E(Ai({variant:t}),s),...a})}const qe=c.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:E("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...t}));qe.displayName="Textarea";const Mi={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};function es({className:s,size:t="md"}){return e.jsx(Go,{className:E("animate-spin text-primary",Mi[t],s)})}function nr({message:s="Cargando..."}){return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center justify-center gap-4 bg-background",children:[e.jsx(es,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:s})]})}var Ts="Tabs",[Di]=Js(Ts,[ta]),or=ta(),[Ri,ft]=Di(Ts),ir=c.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,onValueChange:o,defaultValue:r,orientation:i="horizontal",dir:l,activationMode:d="automatic",...u}=s,h=an(l),[m,b]=Ks({prop:n,onChange:o,defaultProp:r??"",caller:Ts});return e.jsx(Ri,{scope:a,baseId:rn(),value:m,onValueChange:b,orientation:i,dir:h,activationMode:d,children:e.jsx(ze.div,{dir:h,"data-orientation":i,...u,ref:t})})});ir.displayName=Ts;var cr="TabsList",lr=c.forwardRef((s,t)=>{const{__scopeTabs:a,loop:n=!0,...o}=s,r=ft(cr,a),i=or(a);return e.jsx(sn,{asChild:!0,...i,orientation:r.orientation,dir:r.dir,loop:n,children:e.jsx(ze.div,{role:"tablist","aria-orientation":r.orientation,...o,ref:t})})});lr.displayName=cr;var dr="TabsTrigger",ur=c.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,disabled:o=!1,...r}=s,i=ft(dr,a),l=or(a),d=xr(i.baseId,n),u=pr(i.baseId,n),h=n===i.value;return e.jsx(tn,{asChild:!0,...l,focusable:!o,active:h,children:e.jsx(ze.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":u,"data-state":h?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:d,...r,ref:t,onMouseDown:Je(s.onMouseDown,m=>{!o&&m.button===0&&m.ctrlKey===!1?i.onValueChange(n):m.preventDefault()}),onKeyDown:Je(s.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&i.onValueChange(n)}),onFocus:Je(s.onFocus,()=>{const m=i.activationMode!=="manual";!h&&!o&&m&&i.onValueChange(n)})})})});ur.displayName=dr;var mr="TabsContent",hr=c.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,forceMount:o,children:r,...i}=s,l=ft(mr,a),d=xr(l.baseId,n),u=pr(l.baseId,n),h=n===l.value,m=c.useRef(h);return c.useEffect(()=>{const b=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(b)},[]),e.jsx(sa,{present:o||h,children:({present:b})=>e.jsx(ze.div,{"data-state":h?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":d,hidden:!b,id:u,tabIndex:0,...i,ref:t,style:{...s.style,animationDuration:m.current?"0s":void 0},children:b&&r})})});hr.displayName=mr;function xr(s,t){return`${s}-trigger-${t}`}function pr(s,t){return`${s}-content-${t}`}var Ti=ir,fr=lr,gr=ur,jr=hr;const Pi=Ti,vr=c.forwardRef(({className:s,...t},a)=>e.jsx(fr,{ref:a,className:E("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));vr.displayName=fr.displayName;const Ns=c.forwardRef(({className:s,...t},a)=>e.jsx(gr,{ref:a,className:E("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));Ns.displayName=gr.displayName;const ws=c.forwardRef(({className:s,...t},a)=>e.jsx(jr,{ref:a,className:E("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));ws.displayName=jr.displayName;const br=c.createContext(null);function gt(){const s=c.useContext(br);if(!s)throw new Error("useHelp must be used within HelpProvider");return s}function zi({children:s}){const[t,a]=c.useState(!1),[n,o]=c.useState(null),[r,i]=c.useState(()=>localStorage.getItem("help-tour-completed")==="true"),l=()=>{i(!0),localStorage.setItem("help-tour-completed","true")};return e.jsx(br.Provider,{value:{showHelp:t,setShowHelp:a,currentTip:n,setCurrentTip:o,hasSeenTour:r,completeTour:l},children:s})}const Li=[{id:"dashboard",title:"Dashboard",description:"Vista general con estadísticas de incidencias, equipos y alertas críticas. Desde aquí puedes ver el estado general de la planta.",icon:Sa},{id:"incidents",title:"Incidencias",description:"Reporta y gestiona problemas en la planta. Puedes crear nuevas incidencias, filtrar por estado/prioridad y dar seguimiento.",icon:ue},{id:"preventive",title:"Mantenimiento Preventivo",description:"Programa y gestiona tareas de mantenimiento preventivo. Evita fallas configurando revisiones periódicas.",icon:wa},{id:"map",title:"Mapa de Planta",description:"Vista visual de las zonas de la planta. Los colores indican el estado: 🟢 Sin problemas, 🔵 Medio, 🟠 Alto, 🔴 Crítico.",icon:Ea},{id:"equipment",title:"Equipos",description:"Inventario de maquinaria y equipos. Registra información técnica, ubicación y estado de cada equipo.",icon:Xe},{id:"settings",title:"Configuración",description:"Solo administradores. Gestiona usuarios, zonas, categorías y configuración general del sistema.",icon:Ms,forAdmin:!0}],Fi=[{step:1,title:"Configurar Planta",description:"El administrador sube el plano y crea las zonas de trabajo",tasks:["Subir imagen del plano de planta","Dibujar zonas con la herramienta de polígonos","Asignar nombres y tipos a cada zona"],forAdmin:!0},{step:2,title:"Reportar Incidencias",description:"Los usuarios reportan problemas encontrados",tasks:["Ir a Incidencias → Nueva Incidencia","Seleccionar la zona afectada","Describir el problema y prioridad","Agregar fotos si es necesario"],forAdmin:!1},{step:3,title:"Gestionar Incidencias",description:"Técnicos y supervisores dan seguimiento",tasks:["Revisar incidencias pendientes","Asignar técnico responsable","Actualizar estado (en proceso → resuelta)","Documentar la solución aplicada"],forAdmin:!1},{step:4,title:"Monitorear Estado",description:"Ver el estado general en el mapa",tasks:["El mapa muestra zonas por color según incidencias","Dashboard muestra estadísticas en tiempo real","Alertas críticas aparecen destacadas"],forAdmin:!1}];function _i(){const{showHelp:s,setShowHelp:t}=gt();return e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>t(!s),className:E("relative",s&&"bg-primary text-primary-foreground"),title:"Ayuda",children:e.jsx(qo,{className:"h-5 w-5"})})}function Oi(){const{showHelp:s,setShowHelp:t,hasSeenTour:a,completeTour:n}=gt(),o=ca(),[r,i]=c.useState("tour"),[l,d]=c.useState(0),u=Li.filter(m=>!m.forAdmin||o),h=Fi.filter(m=>!m.forAdmin||o);return e.jsx(be,{open:s,onOpenChange:t,children:e.jsxs(je,{className:"max-w-2xl max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-5 w-5 text-yellow-500"}),"Centro de Ayuda"]})}),e.jsxs("div",{className:"flex gap-2 border-b pb-2",children:[e.jsx(k,{variant:r==="tour"?"default":"ghost",size:"sm",onClick:()=>i("tour"),children:"Tour de la App"}),e.jsx(k,{variant:r==="workflow"?"default":"ghost",size:"sm",onClick:()=>i("workflow"),children:"Flujo de Trabajo"}),e.jsx(k,{variant:r==="tips"?"default":"ghost",size:"sm",onClick:()=>i("tips"),children:"Tips Rápidos"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r==="tour"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"grid gap-3",children:u.map((m,b)=>e.jsx(P,{className:E("cursor-pointer transition-all hover:border-primary",l===b&&"border-primary bg-primary/5"),onClick:()=>d(b),children:e.jsxs(F,{className:"p-4 flex items-start gap-4",children:[e.jsx("div",{className:E("p-2 rounded-lg",l===b?"bg-primary text-primary-foreground":"bg-muted"),children:e.jsx(m.icon,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:m.title}),m.forAdmin&&e.jsx(Y,{variant:"outline",className:"text-xs",children:"Admin"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m.description})]})]})},m.id))}),!a&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(k,{onClick:n,children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Marcar como visto"]})})]}),r==="workflow"&&e.jsx("div",{className:"space-y-4 py-4",children:h.map((m,b)=>e.jsxs(P,{children:[e.jsx(Q,{className:"pb-2",children:e.jsxs(ee,{className:"text-base flex items-center gap-3",children:[e.jsx("span",{className:E("flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold","bg-primary text-primary-foreground"),children:b+1}),m.title,m.forAdmin&&e.jsx(Y,{variant:"outline",className:"text-xs",children:"Solo Admin"})]})}),e.jsxs(F,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:m.description}),e.jsx("ul",{className:"space-y-2",children:m.tasks.map((C,j)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(dt,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{children:C})]},j))})]})]},m.step))}),r==="tips"&&e.jsxs("div",{className:"space-y-3 py-4",children:[e.jsx(Ge,{emoji:"🗺️",title:"Colores del Mapa",description:"Verde = sin incidencias, Azul = medias, Naranja = altas, Rojo = críticas"}),e.jsx(Ge,{emoji:"📸",title:"Fotos en Incidencias",description:"Agrega fotos al reportar para documentar mejor el problema"}),e.jsx(Ge,{emoji:"⚡",title:"Prioridades",description:"Usa 'Crítica' solo para problemas que detengan la producción"}),e.jsx(Ge,{emoji:"🔔",title:"Alertas",description:"Las incidencias críticas aparecen destacadas en el Dashboard"}),e.jsx(Ge,{emoji:"📍",title:"Zonas",description:"Haz clic en una zona del mapa para ver sus incidencias activas"}),o&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{emoji:"✏️",title:"Editar Zonas",description:"Usa 'Editar Zonas' en el mapa para dibujar polígonos punto a punto"}),e.jsx(Ge,{emoji:"🗑️",title:"Eliminar Mapas",description:"En el selector de mapas, pasa el mouse sobre uno para ver el botón de eliminar"})]})]})]})]})})}function Ge({emoji:s,title:t,description:a}){return e.jsx(P,{children:e.jsxs(F,{className:"p-4 flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:s}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]})]})})}function $i(){const{hasSeenTour:s,setShowHelp:t,completeTour:a}=gt(),[n,o]=c.useState(!s),r=oe(i=>i.user);return s||!n?null:e.jsx(be,{open:n,onOpenChange:o,children:e.jsxs(je,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"text-center",children:["👋 ¡Bienvenido, ",r==null?void 0:r.nombre,"!"]})}),e.jsxs("div",{className:"text-center space-y-4 py-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"Esta es tu primera vez en el Sistema de Mantenimiento Industrial."}),e.jsx("p",{className:"text-muted-foreground",children:"¿Te gustaría ver un tour rápido de cómo funciona la aplicación?"}),e.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[e.jsx(k,{variant:"outline",onClick:()=>{o(!1),a()},children:"Ahora no"}),e.jsxs(k,{onClick:()=>{o(!1),t(!0)},children:[e.jsx(ka,{className:"h-4 w-4 mr-2"}),"Ver Tour"]})]})]})]})})}const $t=[{name:"Dashboard",href:"/",icon:Sa},{name:"Incidencias",href:"/incidents",icon:ue},{name:"Preventivo",href:"/preventive",icon:wa},{name:"Mapa",href:"/map",icon:Ea},{name:"Equipos",href:"/equipment",icon:Xe}],Vi=[{name:"Configuración",href:"/settings",icon:Ms}];function qi(){const s=Qs(),t=oe(m=>m.user),a=oe(m=>m.logout),n=ca(),[o,r]=c.useState(!1),[i,l]=c.useState(!1),d=async()=>{await Tn(),a(),s("/login")},u=t?`${t.nombre.charAt(0)}${t.apellido.charAt(0)}`.toUpperCase():"U",h=n?[...$t,...Vi]:$t;return e.jsxs("div",{className:"min-h-screen bg-background",children:[o&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>r(!1)}),e.jsx("aside",{className:E("fixed inset-y-0 left-0 z-50 w-64 bg-card border-r transform transition-transform duration-200 ease-in-out lg:translate-x-0",o?"translate-x-0":"-translate-x-full"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Xe,{className:"h-5 w-5 text-primary"})}),e.jsx("span",{className:"font-semibold",children:"Mantenimiento"})]}),e.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 hover:bg-muted rounded",children:e.jsx(Ye,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:h.map(m=>e.jsxs(dn,{to:m.href,onClick:()=>r(!1),className:({isActive:b})=>E("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",b?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"),children:[e.jsx(m.icon,{className:"h-5 w-5"}),m.name]},m.href))}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-muted transition-colors",children:[e.jsx(Zs,{className:"h-8 w-8",children:e.jsx(Ys,{className:"bg-primary/10 text-primary text-xs",children:u})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("p",{className:"text-sm font-medium",children:[t==null?void 0:t.nombre," ",t==null?void 0:t.apellido]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:t==null?void 0:t.rol})]}),e.jsx(lt,{className:E("h-4 w-4 text-muted-foreground transition-transform",i&&"rotate-180")})]}),i&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-card border rounded-lg shadow-lg overflow-hidden",children:e.jsxs("button",{onClick:d,className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-destructive hover:bg-muted transition-colors",children:[e.jsx(Yo,{className:"h-4 w-4"}),"Cerrar sesión"]})})]})})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsxs("header",{className:"sticky top-0 z-30 flex items-center h-16 px-4 bg-background/80 backdrop-blur border-b",children:[e.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 -ml-2 hover:bg-muted rounded-lg",children:e.jsx(Wo,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"hidden lg:flex items-center gap-3",children:[e.jsx(_i,{}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t==null?void 0:t.nombre," ",t==null?void 0:t.apellido]}),e.jsx(Zs,{className:"h-8 w-8",children:e.jsx(Ys,{className:"bg-primary/10 text-primary text-xs",children:u})})]})]}),e.jsx("main",{className:"p-4 lg:p-6",children:e.jsx(un,{})})]}),e.jsx(Oi,{}),e.jsx($i,{})]})}function Ui(){const s=Qs(),t=oe(g=>g.setUser),[a,n]=c.useState("login"),[o,r]=c.useState(!1),[i,l]=c.useState(null),[d,u]=c.useState(""),[h,m]=c.useState(""),[b,C]=c.useState(""),[j,p]=c.useState(""),[x,w]=c.useState(""),y=async g=>{g.preventDefault(),l(null),r(!0);try{let I;a==="login"?I=await Dn(d,h):I=await Rn(d,h,b,j,x),t(I),s("/")}catch(I){console.error("Auth error:",I),l(Bi(I.code||I.message))}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(P,{className:"w-full max-w-md",children:[e.jsxs(Q,{className:"space-y-1 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:e.jsx(Xe,{className:"h-8 w-8 text-primary"})})}),e.jsx(ee,{className:"text-2xl font-bold",children:"Mantenimiento Industrial"}),e.jsx(ya,{children:a==="login"?"Ingresa tus credenciales para continuar":"Registra tu cuenta con el código de invitación"})]}),e.jsxs(F,{children:[e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a==="register"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"nombre",children:"Nombre"}),e.jsx(J,{id:"nombre",placeholder:"Juan",value:b,onChange:g=>C(g.target.value),required:!0,disabled:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"apellido",children:"Apellido"}),e.jsx(J,{id:"apellido",placeholder:"Pérez",value:j,onChange:g=>p(g.target.value),required:!0,disabled:o})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"inviteCode",children:"Código de Invitación"}),e.jsx(J,{id:"inviteCode",placeholder:"XXXX-XXXX",value:x,onChange:g=>w(g.target.value.toUpperCase()),required:!0,disabled:o,className:"uppercase tracking-widest"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(J,{id:"email",type:"email",placeholder:"usuario@empresa.com",value:d,onChange:g=>u(g.target.value),required:!0,disabled:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"password",children:"Contraseña"}),e.jsx(J,{id:"password",type:"password",placeholder:"••••••••",value:h,onChange:g=>m(g.target.value),required:!0,disabled:o,minLength:6})]}),i&&e.jsx("div",{className:"p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:i}),e.jsx(k,{type:"submit",className:"w-full",disabled:o,children:o?e.jsx(es,{size:"sm"}):a==="login"?e.jsxs(e.Fragment,{children:[e.jsx(Zo,{className:"h-4 w-4"}),"Iniciar Sesión"]}):e.jsxs(e.Fragment,{children:[e.jsx(ti,{className:"h-4 w-4"}),"Registrarse"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{type:"button",onClick:()=>{n(a==="login"?"register":"login"),l(null)},className:"text-sm text-muted-foreground hover:text-primary transition-colors",disabled:o,children:a==="login"?"¿Tienes un código de invitación? Regístrate":"¿Ya tienes cuenta? Inicia sesión"})})]})]})})}function Bi(s){return{"auth/invalid-credential":"Credenciales inválidas","auth/invalid-email":"Correo electrónico inválido","auth/user-disabled":"Usuario desactivado","auth/user-not-found":"Usuario no encontrado","auth/wrong-password":"Contraseña incorrecta","auth/email-already-in-use":"Este correo ya está registrado","auth/weak-password":"La contraseña debe tener al menos 6 caracteres","auth/too-many-requests":"Demasiados intentos. Intenta más tarde."}[s]||s}function Hi(){const s=Qs(),t=oe(d=>d.user),{incidents:a,equipment:n,zones:o}=rs(),r={incidentesActivos:a.filter(d=>["pendiente","confirmada","en_proceso"].includes(d.status)).length,incidentesCriticos:a.filter(d=>d.prioridad==="critica"&&d.status!=="cerrada").length,equiposOperativos:n.filter(d=>d.estado==="operativo").length,equiposTotal:n.length,zonasConIncidentes:new Set(a.filter(d=>d.status!=="cerrada").map(d=>d.zoneId)).size},i=a.slice(0,5),l=a.filter(d=>d.prioridad==="critica"&&d.status!=="cerrada");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Bienvenido, ",(t==null?void 0:t.nombre)||"Usuario"]}),e.jsx("p",{className:"text-muted-foreground",children:"Panel de control de mantenimiento industrial"})]}),e.jsxs(k,{onClick:()=>s("/incidents"),children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Nueva Incidencia"]})]}),l.length>0&&e.jsxs(P,{className:"border-destructive bg-destructive/10",children:[e.jsx(Q,{className:"pb-2",children:e.jsxs(ee,{className:"text-destructive flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Alertas Críticas (",l.length,")"]})}),e.jsx(F,{children:e.jsx("div",{className:"space-y-2",children:l.slice(0,3).map(d=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card rounded cursor-pointer hover:bg-muted",onClick:()=>s("/incidents"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"font-medium",children:d.titulo})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:xs(d.createdAt)})]},d.id))})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(P,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>s("/incidents"),children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Incidencias Activas"}),e.jsx(Oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(F,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.incidentesActivos}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.incidentesCriticos>0&&e.jsxs("span",{className:"text-destructive font-medium",children:[r.incidentesCriticos," críticas"]})})]})]}),e.jsxs(P,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>s("/equipment"),children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Equipos"}),e.jsx(Xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(F,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r.equiposOperativos,"/",r.equiposTotal]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"operativos"})]})]}),e.jsxs(P,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>s("/map"),children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Zonas"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(F,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.zonasConIncidentes," con incidencias"]})]})]}),e.jsxs(P,{children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Tasa Resolución"}),e.jsx(ei,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(F,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.length>0?Math.round(a.filter(d=>d.status==="cerrada").length/a.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"incidencias cerradas"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(ee,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Últimas Incidencias"}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>s("/incidents"),children:"Ver todas"})]})}),e.jsx(F,{children:i.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Pe,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay incidencias recientes"})]}):e.jsx("div",{className:"space-y-4",children:i.map(d=>e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer hover:bg-muted p-2 rounded -mx-2",onClick:()=>s("/incidents"),children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${d.prioridad==="critica"?"bg-destructive":d.prioridad==="alta"?"bg-warning":"bg-primary"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:d.titulo}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.status==="pendiente"&&"Pendiente",d.status==="confirmada"&&"Confirmada",d.status==="en_proceso"&&"En proceso",d.status==="cerrada"&&"Cerrada"]})]}),e.jsx("span",{className:"text-sm text-muted-foreground shrink-0",children:xs(d.createdAt)})]},d.id))})})]}),e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(ee,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Incidencias por Zona"}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>s("/map"),children:"Ver mapa"})]})}),e.jsx(F,{children:o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ve,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"})]}):e.jsx("div",{className:"space-y-4",children:o.map(d=>{const u=a.filter(m=>m.zoneId===d.id&&m.status!=="cerrada"),h=u.filter(m=>m.prioridad==="critica").length;return e.jsxs("div",{className:"flex items-center gap-4 cursor-pointer hover:bg-muted p-2 rounded -mx-2",onClick:()=>s("/map"),children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:d.color||"#2196f3"}}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium",children:d.nombre})}),e.jsxs("div",{className:"flex items-center gap-2",children:[h>0&&e.jsx(Y,{variant:"destructive",children:h}),e.jsx(Y,{variant:"outline",children:u.length})]})]},d.id)})})})]})]})]})}const Ps="incidents";async function Gi(s){const t=it(),a={...s,id:t,createdAt:new Date,updatedAt:new Date};return await We(te(H,Ps,t),{...a,createdAt:re(),updatedAt:re()}),a}async function Zi(s){const t=te(H,Ps,s),a=await st(t);return a.exists()?Nr(a):null}async function jt(s,t){const a=te(H,Ps,s);await ts(a,{...t,updatedAt:re()})}async function Yi(s,t){await jt(s,{status:"confirmada",validatedBy:t,validatedAt:new Date,confirmedAt:new Date})}async function Wi(s,t,a){await jt(s,{status:"rechazada",validatedBy:t,validatedAt:new Date,rejectionReason:a})}async function Xi(s,t,a,n){const o=await Zi(s);if(!o)throw new Error("Incidencia no encontrada");const r=new Date,i=o.confirmedAt?Math.round((r.getTime()-o.confirmedAt.getTime())/6e4):void 0;await jt(s,{status:"cerrada",resolucion:t,closedAt:r,tiempoResolucionMinutos:i,repuestosUsados:a,firmaCierre:n})}function yr(s,t){const a=[];t!=null&&t.status&&t.status.length>0&&a.push(as("status","in",t.status)),a.push(_e("createdAt","desc")),a.push(wn(100));const n=Re(ge(H,Ps),...a);return Cn(n,o=>{const r=o.docs.map(Nr);s(r)})}function Nr(s){const t=s.data();return{...t,id:s.id,createdAt:ds(t.createdAt),updatedAt:ds(t.updatedAt),confirmedAt:ds(t.confirmedAt),closedAt:ds(t.closedAt),validatedAt:ds(t.validatedAt)}}function ds(s){if(s)return s instanceof Te?s.toDate():s instanceof Date?s:new Date(s)}async function Ki(s,t){const a=t.name.split(".").pop()||"jpg",n=`${it()}.${a}`,o=Es(Is,`incidents/${s}/${n}`);return await ra(o,t),tt(o)}async function Ji(s,t=1920,a=.8){return new Promise((n,o)=>{const r=new Image;r.src=URL.createObjectURL(s),r.onload=()=>{const i=document.createElement("canvas");let{width:l,height:d}=r;l>t&&(d=d*t/l,l=t),i.width=l,i.height=d;const u=i.getContext("2d");if(!u){o(new Error("No se pudo crear contexto de canvas"));return}u.drawImage(r,0,0,l,d),i.toBlob(h=>{if(h){const m=new File([h],s.name,{type:"image/jpeg",lastModified:Date.now()});n(m)}else o(new Error("No se pudo comprimir la imagen"))},"image/jpeg",a),URL.revokeObjectURL(r.src)},r.onerror=()=>{o(new Error("Error cargando imagen"))}})}async function Qi(s){const t=s.name.split(".").pop()||"png",a=`map_${Date.now()}.${t}`,n=Es(Is,`maps/${a}`);return await ra(n,s),tt(n)}async function ec(){try{const s=Es(Is,"maps"),t=await Sn(s);return await Promise.all(t.items.map(n=>tt(n)))}catch(s){return console.error("Error obteniendo mapas:",s),[]}}async function sc(s){try{const t=Es(Is,s);await kn(t)}catch(t){console.error("Error eliminando mapa:",t)}}const tc=[{value:"critica",label:"🔴 Crítica",desc:"Detiene producción",color:"bg-red-500"},{value:"alta",label:"🟠 Alta",desc:"Afecta operación",color:"bg-orange-500"},{value:"media",label:"🔵 Media",desc:"Requiere atención",color:"bg-blue-500"},{value:"baja",label:"⚪ Baja",desc:"Puede esperar",color:"bg-gray-400"}],ac=["Vibración","Ruido anormal","Calentamiento","Fuga de aceite","Fuga de agua","Humo","Olor extraño","No enciende","Se detiene solo"];function rc({onClose:s,onSuccess:t,preselectedZoneId:a}){const n=oe(g=>g.user),{zones:o}=rs(),r=c.useRef(null),[i,l]=c.useState(!1),[d,u]=c.useState([]),[h,m]=c.useState([]),[b,C]=c.useState([]),[j,p]=c.useState({titulo:"",descripcion:"",zoneId:a||"",prioridad:"media"});c.useEffect(()=>{a&&p(g=>({...g,zoneId:a}))},[a]);const x=async g=>{const I=Array.from(g.target.files||[]);for(const Z of I){if(d.length>=5)break;const A=await Ji(Z,1920,.8);u(pe=>[...pe,A]);const W=new FileReader;W.onloadend=()=>{m(pe=>[...pe,W.result])},W.readAsDataURL(A)}},w=g=>{u(I=>I.filter((Z,A)=>A!==g)),m(I=>I.filter((Z,A)=>A!==g))},y=async g=>{if(g.preventDefault(),!!n){l(!0);try{const I=await Gi({tipo:"correctivo",titulo:j.titulo,descripcion:j.descripcion,zoneId:j.zoneId,prioridad:j.prioridad,status:"pendiente",sintomas:b.length>0?b:void 0,fotos:[],reportadoPor:n.id,requiresValidation:!0});d.length>0&&await Promise.all(d.map(Z=>Ki(I.id,Z))),t()}catch(I){console.error("Error creating incident:",I)}finally{l(!1)}}};return e.jsx(be,{open:!0,onOpenChange:s,children:e.jsxs(je,{className:"max-w-lg max-h-[95vh] overflow-y-auto p-4 sm:p-6",children:[e.jsx(ye,{className:"pb-2",children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-warning"}),"Reportar Incidencia"]})}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"📍 Ubicación *"}),o.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay zonas configuradas"}):e.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.map(g=>e.jsx("button",{type:"button",onClick:()=>p({...j,zoneId:g.id}),className:E("p-3 rounded-lg border-2 text-left transition-all",j.zoneId===g.id?"border-primary bg-primary/10":"border-muted hover:border-primary/50"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:g.color||"#2196f3"}}),e.jsx("span",{className:"font-medium text-sm truncate",children:g.nombre})]})},g.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"⚠️ Prioridad *"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:tc.map(g=>e.jsx("button",{type:"button",onClick:()=>p({...j,prioridad:g.value}),className:E("p-3 rounded-lg border-2 text-left transition-all",j.prioridad===g.value?"border-primary bg-primary/10":"border-muted hover:border-primary/50"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:E("w-3 h-3 rounded-full",g.color)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:g.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g.desc})]})]})},g.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"titulo",className:"text-sm font-medium",children:"📝 Título *"}),e.jsx(J,{id:"titulo",value:j.titulo,onChange:g=>p({...j,titulo:g.target.value}),placeholder:"Ej: Fuga de aceite en bomba principal",className:"text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"descripcion",className:"text-sm font-medium",children:"📋 Descripción *"}),e.jsx(qe,{id:"descripcion",value:j.descripcion,onChange:g=>p({...j,descripcion:g.target.value}),placeholder:"Describe el problema con detalle...",rows:3,className:"text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"🔍 Síntomas (opcional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ac.map(g=>e.jsx("button",{type:"button",onClick:()=>{C(I=>I.includes(g)?I.filter(Z=>Z!==g):[...I,g])},className:E("px-3 py-1.5 rounded-full text-sm border transition-colors",b.includes(g)?"bg-primary text-primary-foreground border-primary":"bg-muted/50 border-muted hover:border-primary/50"),children:g},g))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"📷 Fotos (máx. 5)"}),e.jsxs("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2",children:[h.map((g,I)=>e.jsxs("div",{className:"relative aspect-square",children:[e.jsx("img",{src:g,alt:`Foto ${I+1}`,className:"w-full h-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>w(I),className:"absolute -top-2 -right-2 bg-destructive text-destructive-foreground rounded-full p-1 shadow-lg",children:e.jsx(Ye,{className:"h-3 w-3"})})]},I)),d.length<5&&e.jsxs("button",{type:"button",onClick:()=>{var g;return(g=r.current)==null?void 0:g.click()},className:"aspect-square border-2 border-dashed border-muted rounded-lg flex flex-col items-center justify-center text-muted-foreground hover:border-primary hover:text-primary transition-colors bg-muted/30",children:[e.jsx(ct,{className:"h-8 w-8"}),e.jsx("span",{className:"text-xs mt-1",children:"Tomar foto"})]})]}),e.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:x,className:"hidden",capture:"environment"})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-2 pt-4 border-t",children:[e.jsx(k,{type:"button",variant:"outline",onClick:s,className:"w-full sm:w-auto",children:"Cancelar"}),e.jsx(k,{type:"submit",disabled:i||!j.zoneId||!j.titulo,className:"w-full sm:w-auto sm:flex-1",children:i?e.jsxs(e.Fragment,{children:[e.jsx(es,{size:"sm"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Reportar Incidencia"]})})]})]})]})})}const nc={pendiente:{label:"Pendiente de validación",icon:Oe,color:"text-warning"},confirmada:{label:"Confirmada",icon:Pe,color:"text-primary"},rechazada:{label:"Rechazada",icon:ut,color:"text-destructive"},en_proceso:{label:"En proceso",icon:ue,color:"text-blue-400"},cerrada:{label:"Cerrada",icon:Pe,color:"text-success"}},oc={critica:{label:"Crítica",className:"bg-destructive text-destructive-foreground"},alta:{label:"Alta",className:"bg-warning text-warning-foreground"},media:{label:"Media",className:"bg-primary text-primary-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function ic({incident:s,onClose:t,canValidate:a}){const n=oe(A=>A.user),[o,r]=c.useState(!1),[i,l]=c.useState(!1),[d,u]=c.useState(!1),[h,m]=c.useState(""),[b,C]=c.useState(""),[j,p]=c.useState(null),x=nc[s.status],w=oc[s.prioridad],y=x.icon,g=async()=>{if(n){r(!0);try{await Yi(s.id,n.id),t()}catch(A){console.error("Error confirming incident:",A)}finally{r(!1)}}},I=async()=>{if(!(!n||!h.trim())){r(!0);try{await Wi(s.id,n.id,h),t()}catch(A){console.error("Error rejecting incident:",A)}finally{r(!1)}}},Z=async()=>{if(b.trim()){r(!0);try{await Xi(s.id,b),t()}catch(A){console.error("Error closing incident:",A)}finally{r(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(be,{open:!0,onOpenChange:t,children:e.jsxs(je,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ne,{className:"text-xl",children:s.titulo}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"}),ja(s.createdAt)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:w.className,children:w.label}),e.jsxs(Y,{variant:"outline",className:x.color,children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),x.label]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Descripción"}),e.jsx("p",{className:"text-muted-foreground",children:s.descripcion})]}),s.sintomas&&s.sintomas.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Síntomas observados"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.sintomas.map((A,W)=>e.jsx(Y,{variant:"outline",children:A},W))})]}),s.fotos.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(ct,{className:"h-4 w-4"}),"Fotos (",s.fotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.fotos.map((A,W)=>e.jsx("img",{src:A,alt:`Foto ${W+1}`,className:"aspect-square object-cover rounded-md cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>p(A)},W))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsxs("span",{children:["Zona: ",s.zoneId]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsxs("span",{children:["Reportado por: ",s.reportadoPor]})]})]}),s.asignadoA&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsxs("span",{children:["Asignado a: ",s.asignadoA]})]})})]}),s.status==="rechazada"&&s.rejectionReason&&e.jsxs("div",{className:"p-4 bg-destructive/10 rounded-lg border border-destructive/20",children:[e.jsx("h4",{className:"font-medium text-destructive mb-2",children:"Motivo de rechazo"}),e.jsx("p",{className:"text-sm",children:s.rejectionReason})]}),s.status==="cerrada"&&s.resolucion&&e.jsxs("div",{className:"p-4 bg-success/10 rounded-lg border border-success/20",children:[e.jsx("h4",{className:"font-medium text-success mb-2",children:"Resolución"}),e.jsx("p",{className:"text-sm",children:s.resolucion}),s.tiempoResolucionMinutos&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Tiempo de resolución: ",Math.round(s.tiempoResolucionMinutos/60),"h ",s.tiempoResolucionMinutos%60,"min"]})]}),i&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Rechazar incidencia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"rejectionReason",children:"Motivo del rechazo *"}),e.jsx(qe,{id:"rejectionReason",value:h,onChange:A=>m(A.target.value),placeholder:"Explica por qué se rechaza esta incidencia...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(k,{variant:"destructive",onClick:I,disabled:o||!h.trim(),children:o?e.jsx(es,{size:"sm"}):"Confirmar Rechazo"})]})]}),d&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Cerrar incidencia"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"resolution",children:"Resolución aplicada *"}),e.jsx(qe,{id:"resolution",value:b,onChange:A=>C(A.target.value),placeholder:"Describe cómo se resolvió el problema...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"outline",onClick:()=>u(!1),children:"Cancelar"}),e.jsx(k,{variant:"success",onClick:Z,disabled:o||!b.trim(),children:o?e.jsx(es,{size:"sm"}):"Cerrar Incidencia"})]})]})]}),e.jsxs(fs,{className:"flex-wrap gap-2",children:[s.status==="pendiente"&&a&&!i&&e.jsxs(e.Fragment,{children:[e.jsxs(k,{variant:"outline",onClick:()=>l(!0),children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Rechazar"]}),e.jsx(k,{onClick:g,disabled:o,children:o?e.jsx(es,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Confirmar"]})})]}),(s.status==="confirmada"||s.status==="en_proceso")&&!d&&e.jsxs(k,{variant:"success",onClick:()=>u(!0),children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Cerrar Incidencia"]}),e.jsx(k,{variant:"outline",onClick:t,children:"Cerrar"})]})]})}),j&&e.jsx(be,{open:!0,onOpenChange:()=>p(null),children:e.jsxs(je,{className:"max-w-4xl p-0",children:[e.jsx("button",{onClick:()=>p(null),className:"absolute top-2 right-2 z-10 bg-background/80 rounded-full p-2",children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx("img",{src:j,alt:"Foto ampliada",className:"w-full h-auto max-h-[80vh] object-contain"})]})})]})}const cc={pendiente:{label:"Pendiente",icon:Oe,variant:"warning"},confirmada:{label:"Confirmada",icon:Pe,variant:"default"},rechazada:{label:"Rechazada",icon:ut,variant:"destructive"},en_proceso:{label:"En Proceso",icon:ue,variant:"secondary"},cerrada:{label:"Cerrada",icon:Pe,variant:"success"}},lc={critica:{label:"Crítica",className:"bg-destructive text-destructive-foreground"},alta:{label:"Alta",className:"bg-warning text-warning-foreground"},media:{label:"Media",className:"bg-primary text-primary-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function dc(){const s=qn(),{incidents:t,setIncidents:a,selectedIncident:n,setSelectedIncident:o}=rs(),[r,i]=c.useState(!1),[l,d]=c.useState(""),[u,h]=c.useState("all"),[m,b]=c.useState("all");c.useEffect(()=>{const p=yr(x=>{a(x)});return()=>p()},[a]);const C=t.filter(p=>{const x=p.titulo.toLowerCase().includes(l.toLowerCase())||p.descripcion.toLowerCase().includes(l.toLowerCase()),w=u==="all"||p.status===u,y=m==="all"||p.prioridad===m;return x&&w&&y}),j={total:t.length,pendientes:t.filter(p=>p.status==="pendiente").length,enProceso:t.filter(p=>p.status==="en_proceso").length,criticas:t.filter(p=>p.prioridad==="critica"&&p.status!=="cerrada").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Incidencias"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de mantenimiento correctivo"})]}),e.jsxs(k,{onClick:()=>i(!0),children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Nueva Incidencia"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:j.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]})}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:j.pendientes}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pendientes"})]})}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:j.enProceso}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En Proceso"})]})}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:j.criticas}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Críticas"})]})})]}),e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Aa,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Buscar incidencias...",value:l,onChange:p=>d(p.target.value),className:"pl-9"})]}),e.jsxs(me,{value:u,onValueChange:h,children:[e.jsxs(ie,{className:"w-full sm:w-[180px]",children:[e.jsx(Ca,{className:"h-4 w-4 mr-2"}),e.jsx(he,{placeholder:"Estado"})]}),e.jsxs(ce,{children:[e.jsx(O,{value:"all",children:"Todos los estados"}),e.jsx(O,{value:"pendiente",children:"Pendiente"}),e.jsx(O,{value:"confirmada",children:"Confirmada"}),e.jsx(O,{value:"en_proceso",children:"En Proceso"}),e.jsx(O,{value:"cerrada",children:"Cerrada"}),e.jsx(O,{value:"rechazada",children:"Rechazada"})]})]}),e.jsxs(me,{value:m,onValueChange:b,children:[e.jsx(ie,{className:"w-full sm:w-[180px]",children:e.jsx(he,{placeholder:"Prioridad"})}),e.jsxs(ce,{children:[e.jsx(O,{value:"all",children:"Todas las prioridades"}),e.jsx(O,{value:"critica",children:"Crítica"}),e.jsx(O,{value:"alta",children:"Alta"}),e.jsx(O,{value:"media",children:"Media"}),e.jsx(O,{value:"baja",children:"Baja"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:C.length===0?e.jsx(P,{children:e.jsxs(F,{className:"p-8 text-center",children:[e.jsx(ue,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No hay incidencias"}),e.jsx("p",{className:"text-muted-foreground",children:l||u!=="all"||m!=="all"?"No se encontraron incidencias con los filtros aplicados":"Comienza creando una nueva incidencia"})]})}):C.map(p=>e.jsx(uc,{incident:p,onClick:()=>o(p)},p.id))}),r&&e.jsx(rc,{onClose:()=>i(!1),onSuccess:()=>i(!1)}),n&&e.jsx(ic,{incident:n,onClose:()=>o(null),canValidate:s})]})}function uc({incident:s,onClick:t}){const a=cc[s.status],n=lc[s.prioridad],o=a.icon;return e.jsx(P,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:t,children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(Y,{variant:a.variant,className:"gap-1",children:[e.jsx(o,{className:"h-3 w-3"}),a.label]}),e.jsx(Y,{className:n.className,children:n.label})]}),e.jsx("h3",{className:"font-medium truncate",children:s.titulo}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.descripcion})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground shrink-0",children:[e.jsx("div",{children:xs(s.createdAt)}),s.fotos.length>0&&e.jsxs("div",{className:"text-xs mt-1",children:[s.fotos.length," foto(s)"]})]})]})})})}const ms="zones";async function mc(s){const t={...s,createdAt:new Date,updatedAt:new Date};return await We(te(H,ms,s.id),{...t,createdAt:re(),updatedAt:re()}),t}async function ss(s){let t=Re(ge(H,ms),_e("id"));return s!=null&&s.nivel&&(t=Re(ge(H,ms),as("nivel","==",s.nivel),_e("id"))),s!=null&&s.parentId&&(t=Re(ge(H,ms),as("parentId","==",s.parentId),_e("id"))),(await Ue(t)).docs.map(fc)}async function hc(){return ss({nivel:1})}async function xc(s){return ss({parentId:s})}async function pc(s){if((await xc(s)).length>0)throw new Error("No se puede eliminar una zona que tiene subzonas");await at(te(H,ms,s))}function fc(s){const t=s.data();return{id:s.id,parentId:t.parentId||null,nivel:t.nivel||1,nombre:t.nombre||"",codigo:t.codigo||t.id||"",tipo:t.tipo||"otro",descripcion:t.descripcion||"",polygon:t.polygon||[],bounds:t.bounds||void 0,color:t.color||"#2196f3",activa:t.activa!==!1,createdAt:Vt(t.createdAt),updatedAt:Vt(t.updatedAt)}}function Vt(s){return s?s instanceof Te?s.toDate():s instanceof Date?s:new Date(s):new Date}const $s="/mantenimiento-planta/";function wr(s){if(s.startsWith("http://")||s.startsWith("https://")||s.startsWith("blob:"))return s;const t=s.startsWith("/")?s:`/${s}`;return`${$s.endsWith("/")?$s.slice(0,-1):$s}${t}`}function Cr(s){return s.includes("firebasestorage.googleapis.com")||s.includes(".firebasestorage.app")}const Ke=[{value:"produccion",label:"Producción",color:"#2196f3",icon:"🏭"},{value:"almacen",label:"Almacén",color:"#4caf50",icon:"📦"},{value:"oficinas",label:"Oficinas",color:"#9c27b0",icon:"🏢"},{value:"mantenimiento",label:"Mantenimiento",color:"#ff9800",icon:"🔧"},{value:"carga_descarga",label:"Carga/Descarga",color:"#795548",icon:"🚚"},{value:"servicios",label:"Servicios",color:"#00bcd4",icon:"🚿"},{value:"seguridad",label:"Seguridad",color:"#f44336",icon:"🛡️"},{value:"maquina",label:"Máquina/Equipo",color:"#ff5722",icon:"⚙️"},{value:"otro",label:"Otro",color:"#607d8b",icon:"📍"}],gc=["#e91e63","#673ab7","#3f51b5","#009688","#8bc34a","#cddc39","#ffc107","#ff5722"];function jc(){var kt;const{user:s}=oe(),{zones:t,setZones:a,mapImage:n,setMapImage:o,equipment:r}=rs(),[i,l]=c.useState("select"),[d,u]=c.useState(1),[h,m]=c.useState({x:0,y:0}),[b,C]=c.useState(!1),[j,p]=c.useState({x:0,y:0}),[x,w]=c.useState(!1),[y,g]=c.useState(null),[I,Z]=c.useState(!1),[A,W]=c.useState(null),[pe,le]=c.useState(!1),[V,de]=c.useState({nombre:"",codigo:"",tipo:"produccion",descripcion:"",color:"#2196f3",equipmentId:""}),[q,fe]=c.useState(!1),[ae,Se]=c.useState([]),[ke,Ee]=c.useState(!1),[S,T]=c.useState(!1),se=c.useRef(null),K=c.useRef(null),N=c.useRef(null),G=c.useRef(null),U=(s==null?void 0:s.rol)==="admin",[B,ve]=c.useState({width:1400,height:800}),we=typeof window<"u"&&window.devicePixelRatio||1;c.useEffect(()=>{ss().then(a),Be()},[a]);const Be=async()=>{try{const v=await ec();Se(v),!n&&v.length>0&&o(v[0])}catch(v){console.error("Error cargando mapas:",v)}};c.useEffect(()=>{if(!n){fe(!1);return}const v=new Image;v.crossOrigin="anonymous",v.onload=()=>{N.current=v;const f=1600,M=900;let D=v.naturalWidth,L=v.naturalHeight;D>f&&(L=f/D*L,D=f),L>M&&(D=M/L*D,L=M),ve({width:Math.floor(D),height:Math.floor(L)}),fe(!0)},v.onerror=()=>{console.error("Error cargando imagen del mapa"),fe(!1)},v.src=Cr(n)?n:wr(n)},[n]);const He=v=>{if(v.length===0)return;let f=1/0,M=1/0,D=-1/0,L=-1/0;return v.forEach($=>{f=Math.min(f,$.x),M=Math.min(M,$.y),D=Math.max(D,$.x),L=Math.max(L,$.y)}),{minX:f,minY:M,maxX:D,maxY:L}},Ie=(v,f)=>{let M=!1;for(let D=0,L=f.length-1;D<f.length;L=D++){const $=f[D],ne=f[L];$.y>v.y!=ne.y>v.y&&v.x<(ne.x-$.x)*(v.y-$.y)/(ne.y-$.y)+$.x&&(M=!M)}return M},Ae=c.useCallback(()=>{const v=se.current,f=v==null?void 0:v.getContext("2d");if(!v||!f)return;f.setTransform(we,0,0,we,0,0);const M=B.width,D=B.height;if(f.clearRect(0,0,M,D),N.current&&q)f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(N.current,0,0,M,D);else{f.fillStyle="#1a1a2e",f.fillRect(0,0,M,D),f.strokeStyle="#2a2a4e",f.lineWidth=1;const L=50;for(let $=0;$<=M;$+=L)f.beginPath(),f.moveTo($,0),f.lineTo($,D),f.stroke();for(let $=0;$<=D;$+=L)f.beginPath(),f.moveTo(0,$),f.lineTo(M,$),f.stroke();f.fillStyle="#666",f.font="18px Inter, sans-serif",f.textAlign="center",f.fillText("Sube una imagen del plano para comenzar",M/2,D/2)}if(t.forEach(L=>{if(!L.polygon||L.polygon.length<3)return;const $=(A==null?void 0:A.id)===L.id,ne=L.color||"#2196f3",Ce=L.polygon.map(xe=>({x:xe.x*M,y:xe.y*D}));f.beginPath(),f.moveTo(Ce[0].x,Ce[0].y),Ce.slice(1).forEach(xe=>f.lineTo(xe.x,xe.y)),f.closePath(),f.fillStyle=$?`${ne}55`:`${ne}33`,f.fill(),f.strokeStyle=ne,f.lineWidth=$?3:2,f.stroke();const js=Ce.reduce((xe,Ls)=>xe+Ls.x,0)/Ce.length,vs=Ce.reduce((xe,Ls)=>xe+Ls.y,0)/Ce.length,zs=Ke.find(xe=>xe.value===L.tipo);f.fillStyle="#fff",f.font="bold 14px Inter, sans-serif",f.textAlign="center",f.shadowColor="rgba(0,0,0,0.8)",f.shadowBlur=4,f.fillText(`${(zs==null?void 0:zs.icon)||"📍"} ${L.codigo}`,js,vs-8),f.font="12px Inter, sans-serif",f.fillText(L.nombre,js,vs+10),f.shadowBlur=0,$&&Ce.forEach(xe=>{f.beginPath(),f.arc(xe.x,xe.y,6,0,Math.PI*2),f.fillStyle=ne,f.fill(),f.strokeStyle="#fff",f.lineWidth=2,f.stroke()})}),y&&y.points.length>0){const L=y.points.map($=>({x:$.x*M,y:$.y*D}));f.beginPath(),f.moveTo(L[0].x,L[0].y),L.slice(1).forEach($=>f.lineTo($.x,$.y)),f.strokeStyle=V.color,f.lineWidth=2,f.setLineDash([5,5]),f.stroke(),f.setLineDash([]),L.forEach(($,ne)=>{f.beginPath(),f.arc($.x,$.y,ne===0?10:6,0,Math.PI*2),ne===0&&I&&L.length>=3?(f.fillStyle="#4caf50",f.strokeStyle="#fff",f.lineWidth=3):(f.fillStyle=ne===0?V.color:"#fff",f.strokeStyle=V.color,f.lineWidth=2),f.fill(),f.stroke(),f.fillStyle=ne===0?"#fff":V.color,f.font="bold 10px Inter, sans-serif",f.textAlign="center",f.textBaseline="middle",f.fillText(`${ne+1}`,$.x,$.y)}),L.length>=3&&(f.fillStyle="#4caf50",f.font="14px Inter, sans-serif",f.textAlign="left",f.fillText("✓ Click en punto 1 para cerrar el polígono",20,D-20))}},[t,y,I,q,A,V.color,B,we]);c.useEffect(()=>{Ae()},[Ae]);const yt=v=>{const f=se.current;if(!f)return{x:0,y:0};const M=f.getBoundingClientRect(),D=B.width/M.width,L=B.height/M.height;return{x:(v.clientX-M.left)*D/B.width,y:(v.clientY-M.top)*L/B.height}},Nt=(v,f)=>{const M=(v.x-f.x)*B.width,D=(v.y-f.y)*B.height;return Math.sqrt(M*M+D*D)},Ar=v=>{if(!se.current)return;const M=yt(v);if(i==="draw"&&U){if(!y)g({points:[M],isComplete:!1});else if(!y.isComplete){const D=y.points[0],L=Nt(M,D);y.points.length>=3&&L<20?(g({...y,isComplete:!0}),le(!0)):g({...y,points:[...y.points,M]})}}else if(i==="select"){const D=t.find(L=>L.polygon&&L.polygon.length>=3&&Ie(M,L.polygon));W(D||null)}},Mr=v=>{if(se.current){if(i==="draw"&&y&&!y.isComplete&&y.points.length>=3){const M=yt(v),D=y.points[0],L=Nt(M,D);Z(L<20)}b&&i==="select"&&m({x:v.clientX-j.x,y:v.clientY-j.y})}},Dr=v=>{i==="select"&&v.button===0&&(C(!0),p({x:v.clientX-h.x,y:v.clientY-h.y}))},wt=()=>{C(!1)},Rr=()=>{y&&y.points.length>1?g({...y,points:y.points.slice(0,-1)}):y&&y.points.length===1&&g(null)},is=()=>{g(null),le(!1),Z(!1),Tr()},Tr=()=>{de({nombre:"",codigo:"",tipo:"produccion",descripcion:"",color:"#2196f3",equipmentId:void 0})},Pr=async()=>{if(!y||!y.isComplete||y.points.length<3)return;const v=He(y.points),f=V.codigo||`Z${t.length+1}`,M={id:`zone_${Date.now()}`,nombre:V.nombre||`Zona ${f}`,codigo:f,tipo:V.tipo,descripcion:V.descripcion,polygon:y.points,bounds:v,color:V.color,parentId:null,nivel:1,activa:!0,...V.tipo==="maquina"&&V.equipmentId?{equipmentId:V.equipmentId}:{}};try{await mc(M),await ss().then(a),is(),l("select")}catch(D){console.error("Error creando zona:",D),alert("Error al guardar la zona")}},zr=async v=>{if(confirm("¿Estás seguro de eliminar esta zona?"))try{await pc(v),await ss().then(a),W(null)}catch(f){console.error("Error eliminando zona:",f)}},Lr=async v=>{var M;const f=(M=v.target.files)==null?void 0:M[0];if(f){if(!f.type.startsWith("image/")){alert("Por favor selecciona una imagen");return}if(f.size>10*1024*1024){alert("La imagen es muy grande. Máximo 10MB");return}T(!0);try{const D=await Qi(f);o(D),await Be()}catch(D){console.error("Error subiendo mapa:",D),alert("Error al subir la imagen")}finally{T(!1),G.current&&(G.current.value="")}}},Ct=v=>{u(f=>Math.max(.3,Math.min(5,f+v)))},Fr=()=>{u(1),m({x:0,y:0})},_r=c.useCallback(v=>{v.preventDefault();const f=K.current;if(!f)return;const M=v.deltaY<0?1.1:.9,D=Math.max(.3,Math.min(5,d*M)),L=f.getBoundingClientRect(),$=v.clientX-L.left,ne=v.clientY-L.top,Ce=D/d,js=$-($-h.x)*Ce,vs=ne-(ne-h.y)*Ce;u(D),m({x:js,y:vs})},[d,h]),Or=v=>{v.button===1&&(v.preventDefault(),w(!0),C(!0),p({x:v.clientX-h.x,y:v.clientY-h.y}))},$r=v=>{x&&b&&m({x:v.clientX-j.x,y:v.clientY-j.y})},St=()=>{w(!1),C(!1)},Vr=v=>{const f=Ke.find(M=>M.value===v);de({...V,tipo:v,color:(f==null?void 0:f.color)||V.color})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Herramientas:"}),e.jsxs(k,{variant:i==="select"?"default":"outline",size:"sm",onClick:()=>{l("select"),is()},children:[e.jsx(Xo,{className:"h-4 w-4 mr-1"}),"Seleccionar"]}),U&&e.jsxs(k,{variant:i==="draw"?"default":"outline",size:"sm",onClick:()=>l("draw"),disabled:!q,children:[e.jsx(Lt,{className:"h-4 w-4 mr-1"}),"Dibujar Zona"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"outline",size:"icon",onClick:()=>Ct(.25),children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm w-12 text-center",children:[Math.round(d*100),"%"]}),e.jsx(k,{variant:"outline",size:"icon",onClick:()=>Ct(-.25),children:e.jsx(Ra,{className:"h-4 w-4"})}),e.jsx(k,{variant:"outline",size:"icon",onClick:Fr,children:e.jsx(Ia,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[U&&e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:G,type:"file",accept:"image/*",className:"hidden",onChange:Lr}),e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>{var v;return(v=G.current)==null?void 0:v.click()},disabled:S,children:[e.jsx(Ma,{className:"h-4 w-4 mr-1"}),S?"Subiendo...":"Subir Plano"]})]}),ae.length>1&&e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>Ee(!0),children:[e.jsx(zt,{className:"h-4 w-4 mr-1"}),"Mapas (",ae.length,")"]})]})]}),i==="draw"&&y&&e.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t",children:[e.jsxs(Y,{variant:"secondary",children:[y.points.length," puntos"]}),e.jsxs(k,{variant:"outline",size:"sm",onClick:Rr,disabled:y.points.length===0,children:[e.jsx(si,{className:"h-4 w-4 mr-1"}),"Deshacer"]}),e.jsxs(k,{variant:"destructive",size:"sm",onClick:is,children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),y.isComplete&&e.jsxs(k,{size:"sm",onClick:()=>le(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-1"}),"Completar Zona"]})]})]})}),e.jsx(P,{className:"overflow-hidden",children:e.jsx(F,{className:"p-0",children:e.jsxs("div",{ref:K,className:E("relative w-full overflow-hidden bg-muted",i==="select"?"cursor-grab active:cursor-grabbing":"cursor-crosshair",x&&"cursor-grabbing"),style:{height:"70vh",minHeight:"500px"},onWheel:_r,onMouseDown:Or,onMouseMove:$r,onMouseUp:St,onMouseLeave:St,children:[e.jsx("div",{className:"absolute transition-transform duration-75",style:{transform:`translate(${h.x}px, ${h.y}px) scale(${d})`,transformOrigin:"top left"},children:e.jsx("canvas",{ref:se,width:B.width*we,height:B.height*we,style:{width:B.width,height:B.height},onClick:Ar,onMouseMove:Mr,onMouseDown:Dr,onMouseUp:wt,onMouseLeave:wt,className:"block"})}),i==="draw"&&e.jsxs("div",{className:"absolute top-4 left-4 bg-primary/90 text-primary-foreground px-4 py-2 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Modo Dibujo"})]}),e.jsx("p",{className:"text-sm mt-1 opacity-90",children:y?y.points.length<3?`Click para agregar punto ${y.points.length+1}`:"Click en punto 1 para cerrar o continúa agregando puntos":"Click para colocar el primer punto"})]}),A&&i==="select"&&e.jsxs("div",{className:"absolute bottom-4 left-4 bg-card/95 backdrop-blur p-4 rounded-lg shadow-lg border max-w-xs",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Y,{style:{backgroundColor:A.color},children:A.codigo}),U&&e.jsx(k,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>zr(A.id),children:e.jsx(ps,{className:"h-4 w-4"})})]}),e.jsx("h4",{className:"font-medium",children:A.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(kt=Ke.find(v=>v.value===A.tipo))==null?void 0:kt.label}),A.descripcion&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:A.descripcion})]})]})})}),e.jsxs(P,{children:[e.jsx(Q,{className:"pb-3",children:e.jsx(ee,{className:"text-lg flex items-center justify-between",children:e.jsxs("span",{children:["Zonas Configuradas (",t.length,")"]})})}),e.jsx(F,{children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(zt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"}),U&&q&&e.jsx("p",{className:"text-sm mt-1",children:'Usa "Dibujar Zona" para crear polígonos punto a punto'}),!q&&e.jsx("p",{className:"text-sm mt-1",children:"Primero sube una imagen del plano de la planta"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:t.map(v=>{const f=Ke.find(D=>D.value===v.tipo),M=(A==null?void 0:A.id)===v.id;return e.jsxs("div",{className:E("p-3 rounded-lg border-2 cursor-pointer transition-all hover:shadow-md",M?"ring-2 ring-primary":""),style:{borderColor:v.color},onClick:()=>W(M?null:v),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{children:f==null?void 0:f.icon}),e.jsx(Y,{className:"text-xs",style:{backgroundColor:v.color},children:v.codigo})]}),e.jsx("h4",{className:"font-medium text-sm truncate",children:v.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:f==null?void 0:f.label})]},v.id)})})})]}),e.jsx(be,{open:pe,onOpenChange:v=>!v&&is(),children:e.jsxs(je,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Configurar Nueva Zona"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"zoneCodigo",children:"Código"}),e.jsx(J,{id:"zoneCodigo",value:V.codigo,onChange:v=>de({...V,codigo:v.target.value.toUpperCase()}),placeholder:"A, B, PROD-1...",maxLength:10})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"zoneTipo",children:"Tipo de Zona"}),e.jsxs(me,{value:V.tipo,onValueChange:v=>Vr(v),children:[e.jsx(ie,{children:e.jsx(he,{})}),e.jsx(ce,{children:Ke.map(v=>e.jsx(O,{value:v.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:v.icon}),e.jsx("span",{children:v.label})]})},v.value))})]})]})]}),V.tipo==="maquina"&&e.jsxs("div",{children:[e.jsx(z,{htmlFor:"zoneEquipment",children:"Equipo Vinculado"}),e.jsxs(me,{value:V.equipmentId||"",onValueChange:v=>{const f=r.find(M=>M.id===v);de({...V,equipmentId:v,nombre:f?`${f.nombre}`:V.nombre,codigo:(f==null?void 0:f.codigo)||V.codigo})},children:[e.jsx(ie,{children:e.jsx(he,{placeholder:"Seleccionar equipo..."})}),e.jsxs(ce,{children:[e.jsx(O,{value:"",children:"Sin vincular"}),r.map(v=>e.jsx(O,{value:v.id,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"⚙️"}),e.jsxs("span",{children:[v.codigo," - ",v.nombre]})]})},v.id))]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Al vincular un equipo, se usará su nombre y código"})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"zoneName",children:"Nombre de la Zona"}),e.jsx(J,{id:"zoneName",value:V.nombre,onChange:v=>de({...V,nombre:v.target.value}),placeholder:"Ej: Línea de producción 1"})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"zoneDescription",children:"Descripción (opcional)"}),e.jsx(qe,{id:"zoneDescription",value:V.descripcion,onChange:v=>de({...V,descripcion:v.target.value}),placeholder:"Descripción detallada de la zona...",rows:2})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Color"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:[...Ke.map(v=>v.color),...gc].map(v=>e.jsx("button",{className:E("w-8 h-8 rounded-full border-2 transition-all",V.color===v?"scale-110 border-white ring-2 ring-primary":"border-transparent"),style:{backgroundColor:v},onClick:()=>de({...V,color:v})},v))})]}),e.jsx("div",{className:"bg-muted rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Polígono:"})," ",(y==null?void 0:y.points.length)||0," puntos"]})})]}),e.jsxs(fs,{children:[e.jsxs(k,{variant:"outline",onClick:is,children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),e.jsxs(k,{onClick:Pr,children:[e.jsx(mt,{className:"h-4 w-4 mr-1"}),"Guardar Zona"]})]})]})}),e.jsx(be,{open:ke,onOpenChange:Ee,children:e.jsxs(je,{children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Seleccionar Plano"})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto",children:ae.map((v,f)=>e.jsxs("div",{className:E("relative aspect-video rounded-lg overflow-hidden border-2 transition-all group",n===v?"border-primary ring-2 ring-primary":"border-muted hover:border-primary/50"),children:[e.jsx("img",{src:v,alt:`Plano ${f+1}`,className:"w-full h-full object-cover cursor-pointer",onClick:()=>{o(v),Ee(!1)}}),n===v&&e.jsx("div",{className:"absolute inset-0 bg-primary/20 flex items-center justify-center pointer-events-none",children:e.jsx(Ss,{className:"h-8 w-8 text-primary"})}),U&&ae.length>1&&e.jsx(k,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:async M=>{if(M.stopPropagation(),confirm("¿Eliminar este plano?"))try{if(await sc(v),n===v){const D=ae.find(L=>L!==v);o(D||null)}await Be()}catch(D){console.error("Error eliminando mapa:",D),alert("Error al eliminar el mapa")}},children:e.jsx(ps,{className:"h-4 w-4"})})]},v))}),ae.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:'No hay planos subidos. Usa el botón "Subir plano" para agregar uno.'})]})})]})}const Ws={critica:{color:"text-red-500",bg:"bg-red-500",label:"Crítica"},alta:{color:"text-orange-500",bg:"bg-orange-500",label:"Alta"},media:{color:"text-blue-500",bg:"bg-blue-500",label:"Media"},baja:{color:"text-gray-500",bg:"bg-gray-500",label:"Baja"}},Sr={pendiente:{label:"Pendiente",variant:"warning"},confirmada:{label:"Confirmada",variant:"default"},rechazada:{label:"Rechazada",variant:"destructive"},en_proceso:{label:"En proceso",variant:"secondary"},cerrada:{label:"Cerrada",variant:"outline"}};function vc(){const{user:s}=oe(),{zones:t,setZones:a,setSelectedZone:n,incidents:o,setIncidents:r,mapImage:i}=rs(),[l,d]=c.useState("view"),[u,h]=c.useState(null),[m,b]=c.useState(!0),C=i?Cr(i)?i:wr(i):null,[j,p]=c.useState(1),[x,w]=c.useState({x:0,y:0}),[y,g]=c.useState(!1),[I,Z]=c.useState({x:0,y:0}),A=c.useRef(null),W=(s==null?void 0:s.rol)==="admin";c.useEffect(()=>{ss().then(a)},[a]),c.useEffect(()=>{const S=yr(r,{status:["pendiente","confirmada","en_proceso"]});return()=>S()},[r]);const pe=o.reduce((S,T)=>(S[T.zoneId]||(S[T.zoneId]=[]),S[T.zoneId].push(T),S),{}),le=S=>{p(T=>Math.max(.3,Math.min(5,T+S)))},V=()=>{p(1),w({x:0,y:0})},de=S=>{S.preventDefault();const T=A.current;if(!T)return;const se=S.deltaY<0?1.15:.85,K=Math.max(.3,Math.min(5,j*se)),N=T.getBoundingClientRect(),G=S.clientX-N.left,U=S.clientY-N.top,B=K/j,ve=G-(G-x.x)*B,we=U-(U-x.y)*B;p(K),w({x:ve,y:we})},q=S=>{S.button===0&&(g(!0),Z({x:S.clientX-x.x,y:S.clientY-x.y}))},fe=S=>{y&&w({x:S.clientX-I.x,y:S.clientY-I.y})},ae=()=>{g(!1)},Se=S=>{const T=S.touches[0];S.touches.length===1&&T&&(g(!0),Z({x:T.clientX-x.x,y:T.clientY-x.y}))},ke=S=>{const T=S.touches[0];y&&S.touches.length===1&&T&&w({x:T.clientX-I.x,y:T.clientY-I.y})},Ee=()=>{g(!1)};return l==="edit"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Editor de Zonas"}),e.jsx("p",{className:"text-muted-foreground",children:"Dibuja zonas poligonales punto a punto sobre el plano"})]}),e.jsxs(k,{variant:"outline",onClick:()=>d("view"),children:[e.jsx(Bo,{className:"h-4 w-4 mr-2"}),"Volver a Vista"]})]}),e.jsx(jc,{})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mapa de Planta"}),e.jsx("p",{className:"text-muted-foreground",children:"Vista general de zonas e incidencias"})]}),e.jsxs("div",{className:"flex gap-2",children:[W&&e.jsxs(k,{variant:"outline",onClick:()=>d("edit"),children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Editar Zonas"]}),e.jsx(k,{variant:"outline",size:"icon",onClick:()=>le(.25),children:e.jsx(Da,{className:"h-4 w-4"})}),e.jsx(k,{variant:"outline",size:"icon",onClick:()=>le(-.25),children:e.jsx(Ra,{className:"h-4 w-4"})}),e.jsx(k,{variant:"outline",size:"icon",onClick:V,children:e.jsx(Ia,{className:"h-4 w-4"})})]})]}),e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-destructive"}),e.jsx("span",{children:"Incidencias críticas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-warning"}),e.jsx("span",{children:"Incidencias altas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-primary"}),e.jsx("span",{children:"Incidencias medias"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-success"}),e.jsx("span",{children:"Sin incidencias"})]})]})})}),e.jsx(P,{className:"overflow-hidden",children:e.jsx(F,{className:"p-0",children:e.jsxs("div",{ref:A,className:"relative w-full h-[600px] md:h-[700px] overflow-hidden bg-muted cursor-grab active:cursor-grabbing",onMouseDown:q,onMouseMove:fe,onMouseUp:ae,onMouseLeave:ae,onTouchStart:Se,onTouchMove:ke,onTouchEnd:Ee,onWheel:de,children:[e.jsx("div",{className:"absolute transition-transform duration-100",style:{transform:`translate(${x.x}px, ${x.y}px) scale(${j})`,transformOrigin:"top left",width:"100%",height:"100%"},children:e.jsxs("div",{className:"relative w-full h-full",children:[C&&e.jsx("img",{src:C,alt:"Plano de planta",className:"absolute inset-0 w-full h-full object-contain",onError:S=>{S.currentTarget.style.display="none"}}),t.length>0?t.map(S=>e.jsx(bc,{zone:S,incidents:pe[S.id]||[],onClick:()=>n(S),onIncidentClick:h},S.id)):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(Ve,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No hay zonas configuradas"}),W&&e.jsx(k,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>d("edit"),children:"Configurar zonas"})]})}),o.map(S=>{const T=t.find(Ae=>Ae.id===S.zoneId);if(!(T!=null&&T.bounds))return null;const se=(T.bounds.minX+T.bounds.maxX)/2,K=(T.bounds.minY+T.bounds.maxY)/2,N=o.filter(Ae=>Ae.zoneId===S.zoneId),U=N.findIndex(Ae=>Ae.id===S.id)/N.length*2*Math.PI,B=Math.min((T.bounds.maxX-T.bounds.minX)*.3,(T.bounds.maxY-T.bounds.minY)*.3),ve=Math.cos(U)*B,we=Math.sin(U)*B,Be=(se+ve)*100,He=(K+we)*100,Ie=Ws[S.prioridad];return e.jsx("button",{className:E("absolute w-6 h-6 -ml-3 -mt-3 rounded-full border-2 border-white shadow-lg cursor-pointer","hover:scale-125 transition-transform z-10",Ie.bg,(u==null?void 0:u.id)===S.id&&"ring-2 ring-white scale-125"),style:{left:`${Be}%`,top:`${He}%`},onClick:Ae=>{Ae.stopPropagation(),h(S)},title:S.titulo,children:e.jsx(ue,{className:"h-3 w-3 text-white mx-auto"})},S.id)})]})}),e.jsx("div",{className:E("absolute top-0 right-0 h-full bg-card/95 backdrop-blur border-l shadow-lg transition-all duration-300 overflow-hidden",m?"w-80":"w-0"),children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold",children:["Incidencias Activas (",o.length,")"]}),e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>b(!1),children:e.jsx(Ye,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:o.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No hay incidencias activas"}):o.map(S=>{const T=t.find(N=>N.id===S.zoneId),se=Ws[S.prioridad],K=Sr[S.status];return e.jsx("button",{className:E("w-full text-left p-3 rounded-lg border bg-card hover:bg-muted transition-colors",(u==null?void 0:u.id)===S.id&&"ring-2 ring-primary"),onClick:()=>h(S),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:E("w-2 h-2 rounded-full mt-2 flex-shrink-0",se.bg)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:S.titulo}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:(T==null?void 0:T.nombre)||"Sin zona"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Y,{variant:K.variant,className:"text-xs",children:K.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:xs(S.createdAt)})]})]}),e.jsx(dt,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]})},S.id)})})]})}),!m&&e.jsxs(k,{className:"absolute top-4 right-4",variant:"secondary",size:"sm",onClick:()=>b(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-1"}),o.length]}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-card/80 backdrop-blur px-3 py-1 rounded text-sm",children:["Zoom: ",Math.round(j*100),"%"]})]})})}),u&&e.jsx(yc,{incident:u,zone:t.find(S=>S.id===u.zoneId),onClose:()=>h(null)}),t.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map(S=>{const T=pe[S.id]||[],se=T.filter(K=>K.prioridad==="critica").length;return e.jsxs(P,{className:E("cursor-pointer hover:border-primary/50 transition-colors",se>0&&"border-destructive"),onClick:()=>n(S),children:[e.jsx(Q,{className:"p-4 pb-2",children:e.jsxs(ee,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:S.color||"#2196f3"}}),S.nombre]})}),e.jsxs(F,{className:"p-4 pt-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl font-bold",children:T.length}),se>0&&e.jsxs(Y,{variant:"destructive",className:"gap-1",children:[e.jsx(ue,{className:"h-3 w-3"}),se]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"incidencias activas"})]})]},S.id)})})]})}function bc({zone:s,incidents:t,onClick:a}){const n=t.filter(i=>i.prioridad==="critica").length,o=t.filter(i=>i.prioridad==="alta").length;let r="border-success/30 bg-success/5";if(n>0?r="border-destructive/50 bg-destructive/10":o>0?r="border-warning/50 bg-warning/10":t.length>0&&(r="border-primary/50 bg-primary/10"),s.bounds){const i={position:"absolute",left:`${s.bounds.minX*100}%`,top:`${s.bounds.minY*100}%`,width:`${(s.bounds.maxX-s.bounds.minX)*100}%`,height:`${(s.bounds.maxY-s.bounds.minY)*100}%`,borderColor:s.color};return e.jsxs("div",{className:E("rounded-lg border-2 cursor-pointer transition-all hover:bg-white/10",r),style:i,onClick:a,children:[e.jsx("div",{className:"absolute top-1 left-1",children:e.jsx(Y,{style:{backgroundColor:s.color},className:"text-white text-xs shadow",children:s.codigo||s.nombre})}),t.length>0&&e.jsx("div",{className:"absolute bottom-1 right-1",children:e.jsxs(Y,{variant:"secondary",className:"text-xs gap-1",children:[e.jsx(ue,{className:"h-3 w-3"}),t.length]})})]})}return null}function yc({incident:s,zone:t,onClose:a}){const n=Ws[s.prioridad],o=Sr[s.status];return e.jsx(be,{open:!0,onOpenChange:a,children:e.jsxs(je,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-start gap-2",children:[e.jsx("div",{className:E("w-3 h-3 rounded-full mt-1.5 flex-shrink-0",n.bg)}),e.jsx("span",{children:s.titulo})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(Y,{variant:o.variant,children:o.label}),e.jsx(Y,{variant:"outline",className:n.color,children:n.label})]}),t&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.color||"#2196f3"}}),e.jsx("span",{children:t.nombre})]}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:s.descripcion})}),s.sintomas&&s.sintomas.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Síntomas:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.sintomas.map((r,i)=>e.jsx(Y,{variant:"secondary",className:"text-xs",children:r},i))})]}),s.fotos.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium text-muted-foreground mb-2 flex items-center gap-1",children:[e.jsx(ct,{className:"h-3 w-3"}),"Fotos (",s.fotos.length,")"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.fotos.slice(0,3).map((r,i)=>e.jsx("img",{src:r,alt:`Foto ${i+1}`,className:"w-full aspect-square object-cover rounded-md cursor-pointer hover:opacity-80",onClick:()=>window.open(r,"_blank")},i))})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),xs(s.createdAt)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Gs,{className:"h-3 w-3"}),"Reportado"]})]})]})]})})}const vt="equipment";async function Nc(s){const t=it(),a={...s,id:t,createdAt:new Date,updatedAt:new Date};return await We(te(H,vt,t),{...a,createdAt:re(),updatedAt:re()}),a}async function Xs(s){let t=Re(ge(H,vt),_e("nombre"));return(await Ue(t)).docs.map(Cc)}async function wc(s,t){const a=te(H,vt,s);await ts(a,{...t,updatedAt:re()})}function Cc(s){const t=s.data();return{...t,id:s.id,createdAt:Vs(t.createdAt),updatedAt:Vs(t.updatedAt),fechaInstalacion:Vs(t.fechaInstalacion)}}function Vs(s){if(s)return s instanceof Te?s.toDate():s instanceof Date?s:new Date(s)}const Sc={operativo:{label:"Operativo",className:"bg-success text-success-foreground"},en_mantenimiento:{label:"En Mantenimiento",className:"bg-warning text-warning-foreground"},fuera_servicio:{label:"Fuera de Servicio",className:"bg-destructive text-destructive-foreground"}},kc={alta:{label:"Alta",className:"bg-destructive text-destructive-foreground"},media:{label:"Media",className:"bg-warning text-warning-foreground"},baja:{label:"Baja",className:"bg-muted text-muted-foreground"}};function Ec(){const{equipment:s,setEquipment:t,zones:a,setZones:n}=rs(),[o,r]=c.useState(!1),[i,l]=c.useState(null),[d,u]=c.useState(""),[h,m]=c.useState("all"),[b,C]=c.useState("all");c.useEffect(()=>{Xs().then(t),hc().then(n)},[t,n]);const j=s.filter(g=>{const I=g.nombre.toLowerCase().includes(d.toLowerCase())||g.codigo.toLowerCase().includes(d.toLowerCase()),Z=h==="all"||g.zoneId===h,A=b==="all"||g.estado===b;return I&&Z&&A}),p={total:s.length,operativos:s.filter(g=>g.estado==="operativo").length,enMantenimiento:s.filter(g=>g.estado==="en_mantenimiento").length,fueraServicio:s.filter(g=>g.estado==="fuera_servicio").length},x=g=>{l(g),r(!0)},w=()=>{r(!1),l(null)},y=async()=>{w();const g=await Xs();t(g)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Equipos"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestión de activos y máquinas"})]}),e.jsxs(k,{onClick:()=>r(!0),children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Nuevo Equipo"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:p.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]})}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-success",children:p.operativos}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Operativos"})]})}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:p.enMantenimiento}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En Mantenimiento"})]})}),e.jsx(P,{children:e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:p.fueraServicio}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Fuera de Servicio"})]})})]}),e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Aa,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Buscar por nombre o código...",value:d,onChange:g=>u(g.target.value),className:"pl-9"})]}),e.jsxs(me,{value:h,onValueChange:m,children:[e.jsxs(ie,{className:"w-full sm:w-[180px]",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),e.jsx(he,{placeholder:"Zona"})]}),e.jsxs(ce,{children:[e.jsx(O,{value:"all",children:"Todas las zonas"}),a.map(g=>e.jsx(O,{value:g.id,children:g.nombre},g.id))]})]}),e.jsxs(me,{value:b,onValueChange:C,children:[e.jsx(ie,{className:"w-full sm:w-[180px]",children:e.jsx(he,{placeholder:"Estado"})}),e.jsxs(ce,{children:[e.jsx(O,{value:"all",children:"Todos los estados"}),e.jsx(O,{value:"operativo",children:"Operativo"}),e.jsx(O,{value:"en_mantenimiento",children:"En Mantenimiento"}),e.jsx(O,{value:"fuera_servicio",children:"Fuera de Servicio"})]})]})]})})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.length===0?e.jsx(P,{className:"md:col-span-2 lg:col-span-3",children:e.jsxs(F,{className:"p-8 text-center",children:[e.jsx(Xe,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No hay equipos"}),e.jsx("p",{className:"text-muted-foreground",children:d||h!=="all"||b!=="all"?"No se encontraron equipos con los filtros aplicados":"Comienza agregando un nuevo equipo"})]})}):j.map(g=>e.jsx(Ic,{equipment:g,zone:a.find(I=>I.id===g.zoneId),onClick:()=>x(g)},g.id))}),o&&e.jsx(Ac,{equipment:i,zones:a,onClose:w,onSuccess:y})]})}function Ic({equipment:s,zone:t,onClick:a}){const n=Sc[s.estado],o=kc[s.criticidad];return e.jsxs(P,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:a,children:[e.jsx(Q,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(ee,{className:"text-base",children:s.nombre}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:s.codigo})]}),e.jsx(Y,{className:n.className,children:n.label})]})}),e.jsx(F,{className:"p-4 pt-2",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[t&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ve,{className:"h-4 w-4"}),t.nombre]}),s.marca&&e.jsxs("div",{className:"text-muted-foreground",children:[s.marca," ",s.modelo]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Criticidad:"}),e.jsx(Y,{variant:"outline",className:o.className,children:o.label})]})]})})]})}function Ac({equipment:s,zones:t,onClose:a,onSuccess:n}){const[o,r]=c.useState(!1),[i,l]=c.useState({codigo:(s==null?void 0:s.codigo)||"",nombre:(s==null?void 0:s.nombre)||"",descripcion:(s==null?void 0:s.descripcion)||"",marca:(s==null?void 0:s.marca)||"",modelo:(s==null?void 0:s.modelo)||"",numeroSerie:(s==null?void 0:s.numeroSerie)||"",zoneId:(s==null?void 0:s.zoneId)||"",criticidad:(s==null?void 0:s.criticidad)||"media",estado:(s==null?void 0:s.estado)||"operativo"}),d=async u=>{u.preventDefault(),r(!0);try{s?await wc(s.id,i):await Nc({...i,zonePath:[i.zoneId],position:{x:0,y:0}}),n()}catch(h){console.error("Error saving equipment:",h)}finally{r(!1)}};return e.jsx(be,{open:!0,onOpenChange:a,children:e.jsxs(je,{className:"max-w-md",children:[e.jsx(ye,{children:e.jsx(Ne,{children:s?"Editar Equipo":"Nuevo Equipo"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"codigo",children:"Código *"}),e.jsx(J,{id:"codigo",value:i.codigo,onChange:u=>l({...i,codigo:u.target.value}),placeholder:"EQ-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"zoneId",children:"Zona *"}),e.jsxs(me,{value:i.zoneId,onValueChange:u=>l({...i,zoneId:u}),children:[e.jsx(ie,{children:e.jsx(he,{placeholder:"Seleccionar zona"})}),e.jsx(ce,{children:t.map(u=>e.jsx(O,{value:u.id,children:u.nombre},u.id))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"nombre",children:"Nombre *"}),e.jsx(J,{id:"nombre",value:i.nombre,onChange:u=>l({...i,nombre:u.target.value}),placeholder:"Bomba centrífuga principal",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(qe,{id:"descripcion",value:i.descripcion,onChange:u=>l({...i,descripcion:u.target.value}),placeholder:"Descripción del equipo...",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"marca",children:"Marca"}),e.jsx(J,{id:"marca",value:i.marca,onChange:u=>l({...i,marca:u.target.value}),placeholder:"Siemens"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"modelo",children:"Modelo"}),e.jsx(J,{id:"modelo",value:i.modelo,onChange:u=>l({...i,modelo:u.target.value}),placeholder:"XYZ-100"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"criticidad",children:"Criticidad"}),e.jsxs(me,{value:i.criticidad,onValueChange:u=>l({...i,criticidad:u}),children:[e.jsx(ie,{children:e.jsx(he,{})}),e.jsxs(ce,{children:[e.jsx(O,{value:"alta",children:"Alta"}),e.jsx(O,{value:"media",children:"Media"}),e.jsx(O,{value:"baja",children:"Baja"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"estado",children:"Estado"}),e.jsxs(me,{value:i.estado,onValueChange:u=>l({...i,estado:u}),children:[e.jsx(ie,{children:e.jsx(he,{})}),e.jsxs(ce,{children:[e.jsx(O,{value:"operativo",children:"Operativo"}),e.jsx(O,{value:"en_mantenimiento",children:"En Mantenimiento"}),e.jsx(O,{value:"fuera_servicio",children:"Fuera de Servicio"})]})]})]})]}),e.jsxs(fs,{children:[e.jsx(k,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(k,{type:"submit",disabled:o,children:o?"Guardando...":s?"Guardar Cambios":"Crear Equipo"})]})]})]})})}function Mc(){const{user:s}=oe(),[t,a]=c.useState("general");if((s==null?void 0:s.rol)!=="admin")return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs(P,{className:"p-8 text-center",children:[e.jsx(Jo,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),e.jsx("h2",{className:"text-xl font-bold",children:"Acceso Denegado"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Solo los administradores pueden acceder a esta página."})]})});const n=[{id:"general",label:"General",icon:Ms},{id:"users",label:"Usuarios",icon:ai},{id:"invites",label:"Invitaciones",icon:Ho},{id:"notifications",label:"Notificaciones",icon:_o}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Configuración"}),e.jsx("p",{className:"text-muted-foreground",children:"Administra la configuración del sistema"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-border pb-2",children:n.map(o=>e.jsxs(k,{variant:t===o.id?"default":"ghost",onClick:()=>a(o.id),className:"gap-2",children:[e.jsx(o.icon,{className:"h-4 w-4"}),o.label]},o.id))}),t==="general"&&e.jsx(Dc,{}),t==="users"&&e.jsx(Rc,{}),t==="invites"&&e.jsx(Tc,{}),t==="notifications"&&e.jsx(Pc,{})]})}function Dc(){const[s,t]=c.useState(!0),[a,n]=c.useState(!1),[o,r]=c.useState(!1),[i,l]=c.useState(!1),d=async()=>{r(!0);try{await We(te(H,"settings","general"),{requireValidation:s,autoAssign:a,updatedAt:re()},{merge:!0}),l(!0),setTimeout(()=>l(!1),2e3)}catch(u){console.error("Error guardando:",u)}r(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(P,{children:[e.jsx(Q,{children:e.jsx(ee,{children:"Flujo de Incidencias"})}),e.jsxs(F,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(z,{children:"Validación de Incidencias"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Requiere que un supervisor valide las incidencias reportadas"})]}),e.jsx(Ze,{checked:s,onCheckedChange:t})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(z,{children:"Auto-asignación"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Asigna automáticamente incidencias a técnicos disponibles"})]}),e.jsx(Ze,{checked:a,onCheckedChange:n})]})]})]}),e.jsxs(P,{children:[e.jsx(Q,{children:e.jsx(ee,{children:"Prioridades"})}),e.jsx(F,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(z,{children:"Tiempo respuesta crítica (min)"}),e.jsx(J,{type:"number",defaultValue:15,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Tiempo respuesta alta (min)"}),e.jsx(J,{type:"number",defaultValue:30,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Tiempo respuesta media (min)"}),e.jsx(J,{type:"number",defaultValue:60,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(z,{children:"Tiempo respuesta baja (min)"}),e.jsx(J,{type:"number",defaultValue:120,className:"mt-1"})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(k,{onClick:d,disabled:o,children:o?"Guardando...":i?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Guardado"]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})})]})}function Rc(){const[s,t]=c.useState([]),[a,n]=c.useState(!0);c.useEffect(()=>{o()},[]);const o=async()=>{try{const u=(await Ue(ge(H,"users"))).docs.map(h=>({id:h.id,...h.data()}));t(u)}catch(d){console.error("Error cargando usuarios:",d)}n(!1)},r=async(d,u)=>{try{await ts(te(H,"users",d),{activo:!u,updatedAt:re()}),o()}catch(h){console.error("Error actualizando usuario:",h)}},i=async(d,u)=>{try{await ts(te(H,"users",d),{rol:u,updatedAt:re()}),o()}catch(h){console.error("Error actualizando rol:",h)}},l=d=>{const u={admin:{label:"Admin",className:"bg-destructive"},supervisor:{label:"Supervisor",className:"bg-warning"},tecnico:{label:"Técnico",className:"bg-primary"}},{label:h,className:m}=u[d]||u.tecnico;return e.jsx(Y,{className:m,children:h})};return a?e.jsx("div",{className:"text-center py-8",children:"Cargando usuarios..."}):e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(ee,{children:["Usuarios del Sistema (",s.length,")"]})}),e.jsx(F,{children:e.jsx("div",{className:"divide-y divide-border",children:s.map(d=>e.jsxs("div",{className:"py-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[d.nombre," ",d.apellido]}),l(d.rol),!d.activo&&e.jsx(Y,{variant:"outline",className:"text-destructive",children:"Inactivo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:d.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(me,{value:d.rol,onValueChange:u=>i(d.id,u),children:[e.jsx(ie,{className:"w-32",children:e.jsx(he,{})}),e.jsxs(ce,{children:[e.jsx(O,{value:"admin",children:"Admin"}),e.jsx(O,{value:"supervisor",children:"Supervisor"}),e.jsx(O,{value:"tecnico",children:"Técnico"})]})]}),e.jsx(Ze,{checked:d.activo,onCheckedChange:()=>r(d.id,d.activo)})]})]},d.id))})})]})}function Tc(){const{user:s}=oe(),[t,a]=c.useState([]),[n,o]=c.useState(!0),[r,i]=c.useState(!1),[l,d]=c.useState("tecnico"),[u,h]=c.useState(!1);c.useEffect(()=>{m()},[]);const m=async()=>{try{const w=(await Ue(ge(H,"inviteCodes"))).docs.map(y=>({...y.data(),code:y.id}));a(w)}catch(x){console.error("Error cargando invitaciones:",x)}o(!1)},b=()=>Math.random().toString(36).substring(2,8).toUpperCase(),C=async()=>{if(s){h(!0);try{const x=b(),w=new Date;w.setDate(w.getDate()+7),await We(te(H,"inviteCodes",x),{rol:l,createdBy:s.id,createdAt:re(),expiresAt:w,used:!1,usedBy:null,usedAt:null}),i(!1),m()}catch(x){console.error("Error creando invitación:",x)}h(!1)}},j=async x=>{if(confirm("¿Eliminar este código de invitación?"))try{await at(te(H,"inviteCodes",x)),m()}catch(w){console.error("Error eliminando invitación:",w)}},p=x=>{navigator.clipboard.writeText(x)};return n?e.jsx("div",{className:"text-center py-8",children:"Cargando invitaciones..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Códigos de Invitación"}),e.jsxs(k,{onClick:()=>i(!0),children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Nuevo Código"]})]}),e.jsx(P,{children:e.jsx(F,{className:"p-0",children:t.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No hay códigos de invitación activos"}):e.jsx("div",{className:"divide-y divide-border",children:t.map(x=>{const w=x.usosActuales>=x.usosMaximos;return e.jsxs("div",{className:E("p-4 flex items-center justify-between",w&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("code",{className:"bg-muted px-3 py-1 rounded text-lg font-mono",children:x.code}),e.jsxs("div",{children:[e.jsx(Y,{variant:"outline",children:x.rol==="admin"?"Admin":x.rol==="supervisor"?"Supervisor":"Técnico"}),w&&e.jsx(Y,{className:"ml-2 bg-muted text-muted-foreground",children:"Usado"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!w&&e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>p(x.code),children:e.jsx(Uo,{className:"h-4 w-4"})}),e.jsx(k,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>j(x.code),children:e.jsx(ps,{className:"h-4 w-4"})})]})]},x.code)})})})}),e.jsx(be,{open:r,onOpenChange:i,children:e.jsxs(je,{children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Crear Código de Invitación"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{children:"Rol del nuevo usuario"}),e.jsxs(me,{value:l,onValueChange:d,children:[e.jsx(ie,{className:"mt-1",children:e.jsx(he,{})}),e.jsxs(ce,{children:[e.jsx(O,{value:"tecnico",children:"Técnico"}),e.jsx(O,{value:"supervisor",children:"Supervisor"}),e.jsx(O,{value:"admin",children:"Administrador"})]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"El código expirará en 7 días"})]}),e.jsxs(fs,{children:[e.jsx(k,{variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(k,{onClick:C,disabled:u,children:u?"Creando...":"Crear Código"})]})]})})]})}function Pc(){const[s,t]=c.useState(!0),[a,n]=c.useState(!1),[o,r]=c.useState(!0),[i,l]=c.useState(!1),[d,u]=c.useState(!1),h=async()=>{l(!0);try{await We(te(H,"settings","notifications"),{emailNotifications:s,pushNotifications:a,criticalAlerts:o,updatedAt:re()},{merge:!0}),u(!0),setTimeout(()=>u(!1),2e3)}catch(m){console.error("Error guardando:",m)}l(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(P,{children:[e.jsx(Q,{children:e.jsx(ee,{children:"Notificaciones"})}),e.jsxs(F,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(z,{children:"Notificaciones por Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recibir resumen diario de incidencias"})]}),e.jsx(Ze,{checked:s,onCheckedChange:t})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(z,{children:"Notificaciones Push"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recibir alertas en tiempo real (requiere PWA instalada)"})]}),e.jsx(Ze,{checked:a,onCheckedChange:n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(z,{children:"Alertas Críticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notificar inmediatamente incidencias críticas"})]}),e.jsx(Ze,{checked:o,onCheckedChange:r})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(k,{onClick:h,disabled:i,children:i?"Guardando...":d?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Guardado"]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})})]})}const gs="preventiveTasks",bt="preventiveExecutions";async function kr(s){let t=Re(ge(H,gs),_e("proximaEjecucion","asc"));return(await Ue(t)).docs.map(n=>{var o;return{id:n.id,...n.data(),ultimaEjecucion:(o=n.data().ultimaEjecucion)==null?void 0:o.toDate(),proximaEjecucion:n.data().proximaEjecucion.toDate(),createdAt:n.data().createdAt.toDate(),updatedAt:n.data().updatedAt.toDate()}})}async function zc(s){var o;const t=te(H,gs,s),a=await st(t);if(!a.exists())return null;const n=a.data();return{id:a.id,...n,ultimaEjecucion:(o=n.ultimaEjecucion)==null?void 0:o.toDate(),proximaEjecucion:n.proximaEjecucion.toDate(),createdAt:n.createdAt.toDate(),updatedAt:n.updatedAt.toDate()}}async function Lc(s){return(await na(ge(H,gs),{...s,proximaEjecucion:Te.fromDate(s.proximaEjecucion),ultimaEjecucion:s.ultimaEjecucion?Te.fromDate(s.ultimaEjecucion):null,createdAt:re(),updatedAt:re()})).id}async function Er(s,t){const a=te(H,gs,s),n={...t,updatedAt:re()};t.proximaEjecucion&&(n.proximaEjecucion=Te.fromDate(t.proximaEjecucion)),t.ultimaEjecucion&&(n.ultimaEjecucion=Te.fromDate(t.ultimaEjecucion)),await ts(a,n)}async function Fc(s){await at(te(H,gs,s))}async function _c(s){let t=Re(ge(H,bt),_e("fechaEjecucion","desc"));return(await Ue(t)).docs.map(n=>({id:n.id,...n.data(),fechaEjecucion:n.data().fechaEjecucion.toDate()}))}async function Oc(s){const t=await na(ge(H,bt),{...s,fechaEjecucion:Te.fromDate(s.fechaEjecucion)}),a=await zc(s.taskId);if(a){const n=new Date(s.fechaEjecucion);n.setDate(n.getDate()+a.frecuenciaDias),await Er(s.taskId,{ultimaEjecucion:s.fechaEjecucion,proximaEjecucion:n})}return t.id}async function $c(){const s=await kr(),t=new Date,a=s.filter(r=>r.activo&&r.proximaEjecucion<t).length,n=s.filter(r=>{if(!r.activo)return!1;const l=(r.proximaEjecucion.getTime()-t.getTime())/(1e3*60*60*24);return l>0&&l<=7}).length,o=await Vc();return{totalTasks:s.filter(r=>r.activo).length,overdue:a,upcoming7Days:n,completedThisMonth:o.length}}async function Vc(){const s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=Re(ge(H,bt),as("fechaEjecucion",">=",Te.fromDate(t)),_e("fechaEjecucion","desc"));return(await Ue(a)).docs.map(o=>({id:o.id,...o.data(),fechaEjecucion:o.data().fechaEjecucion.toDate()}))}const Ir=[{value:"inspeccion",label:"Inspección visual"},{value:"lubricacion",label:"Lubricación"},{value:"limpieza",label:"Limpieza"},{value:"calibracion",label:"Calibración"},{value:"cambio_filtro",label:"Cambio de filtro"},{value:"cambio_aceite",label:"Cambio de aceite"},{value:"ajuste",label:"Ajuste/Torque"},{value:"verificacion_electrica",label:"Verificación eléctrica"},{value:"verificacion_neumatica",label:"Verificación neumática"},{value:"revision_seguridad",label:"Revisión de seguridad"},{value:"otro",label:"Otro"}],qc=[{value:1,label:"Diario"},{value:7,label:"Semanal"},{value:14,label:"Quincenal"},{value:30,label:"Mensual"},{value:60,label:"Bimestral"},{value:90,label:"Trimestral"},{value:180,label:"Semestral"},{value:365,label:"Anual"}];function Uc(){const s=oe(N=>N.user),[t,a]=c.useState([]),[n,o]=c.useState([]),[r,i]=c.useState([]),[l,d]=c.useState(!0),[u,h]=c.useState({totalTasks:0,overdue:0,upcoming7Days:0,completedThisMonth:0}),[m,b]=c.useState(new Date),[C,j]=c.useState(null),[p,x]=c.useState(!1),[w,y]=c.useState(!1),[g,I]=c.useState(null),[Z,A]=c.useState(null),[W,pe]=c.useState("all");c.useEffect(()=>{le()},[]);const le=async()=>{d(!0);try{const[N,G,U,B]=await Promise.all([kr(),Xs(),$c(),_c()]);a(N),i(G),h(U),o(B)}catch(N){console.error("Error loading data:",N)}finally{d(!1)}},de=(N=>{const G=N.getFullYear(),U=N.getMonth(),B=new Date(G,U,1),we=new Date(G,U+1,0).getDate(),Be=B.getDay(),He=[];for(let Ie=0;Ie<Be;Ie++)He.push(null);for(let Ie=1;Ie<=we;Ie++)He.push(new Date(G,U,Ie));return He})(m),q=N=>t.filter(G=>{if(!G.activo)return!1;const U=new Date(G.proximaEjecucion);return U.getDate()===N.getDate()&&U.getMonth()===N.getMonth()&&U.getFullYear()===N.getFullYear()}),fe=c.useMemo(()=>t.filter(N=>!(W!=="all"&&N.equipmentId!==W)),[t,W]),ae=fe.filter(N=>N.activo&&N.proximaEjecucion<new Date),Se=fe.filter(N=>{if(!N.activo)return!1;const G=new Date,B=(N.proximaEjecucion.getTime()-G.getTime())/(1e3*60*60*24);return B>=0&&B<=7}),ke=()=>{b(new Date(m.getFullYear(),m.getMonth()-1))},Ee=()=>{b(new Date(m.getFullYear(),m.getMonth()+1))},S=async N=>{if(confirm("¿Estás seguro de eliminar esta tarea?"))try{await Fc(N),le()}catch(G){console.error("Error deleting task:",G)}},T=N=>{const G=new Date;return N.getDate()===G.getDate()&&N.getMonth()===G.getMonth()&&N.getFullYear()===G.getFullYear()},se=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],K=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mantenimiento Preventivo"}),e.jsx("p",{className:"text-muted-foreground",children:"Planifica y ejecuta tareas de mantenimiento programado"})]}),e.jsxs(be,{open:p,onOpenChange:x,children:[e.jsx(ri,{asChild:!0,children:e.jsxs(k,{onClick:()=>I(null),children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Nueva Tarea"]})}),e.jsx(Bc,{task:g,equipment:r,onClose:()=>{x(!1),I(null)},onSave:le})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(Pt,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tareas"}),e.jsx("p",{className:"text-2xl font-bold",children:u.totalTasks})]})]})})}),e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(ue,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vencidas"}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:u.overdue})]})]})})}),e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx(Oe,{className:"h-5 w-5 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Próximos 7 días"}),e.jsx("p",{className:"text-2xl font-bold",children:u.upcoming7Days})]})]})})}),e.jsx(P,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(Hs,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completadas (mes)"}),e.jsx("p",{className:"text-2xl font-bold",children:u.completedThisMonth})]})]})})})]}),e.jsxs(Pi,{defaultValue:"calendar",className:"space-y-4",children:[e.jsxs(vr,{children:[e.jsxs(Ns,{value:"calendar",children:[e.jsx(Oo,{className:"h-4 w-4 mr-2"}),"Calendario"]}),e.jsxs(Ns,{value:"list",children:[e.jsx(Pt,{className:"h-4 w-4 mr-2"}),"Lista de Tareas"]}),e.jsxs(Ns,{value:"history",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Historial"]})]}),e.jsxs(ws,{value:"calendar",className:"space-y-4",children:[e.jsxs(P,{children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{variant:"outline",size:"icon",onClick:ke,children:e.jsx($o,{className:"h-4 w-4"})}),e.jsxs(ee,{className:"text-lg",children:[se[m.getMonth()]," ",m.getFullYear()]}),e.jsx(k,{variant:"outline",size:"icon",onClick:Ee,children:e.jsx(dt,{className:"h-4 w-4"})})]}),e.jsxs(me,{value:W,onValueChange:pe,children:[e.jsxs(ie,{className:"w-48",children:[e.jsx(Ca,{className:"h-4 w-4 mr-2"}),e.jsx(he,{placeholder:"Filtrar por equipo"})]}),e.jsxs(ce,{children:[e.jsx(O,{value:"all",children:"Todos los equipos"}),r.map(N=>e.jsx(O,{value:N.id,children:N.nombre},N.id))]})]})]}),e.jsxs(F,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:K.map(N=>e.jsx("div",{className:"text-center text-sm font-medium text-muted-foreground py-2",children:N},N))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:de.map((N,G)=>{if(!N)return e.jsx("div",{className:"h-24"},`empty-${G}`);const U=q(N),B=U.some(ve=>ve.proximaEjecucion<new Date);return e.jsxs("div",{className:E("h-24 p-1 border rounded-lg overflow-hidden cursor-pointer transition-colors",T(N)&&"bg-primary/5 border-primary",(C==null?void 0:C.toDateString())===N.toDateString()&&"ring-2 ring-primary"),onClick:()=>j(N),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:E("text-sm font-medium",T(N)&&"text-primary"),children:N.getDate()}),B&&e.jsx(ue,{className:"h-3 w-3 text-red-500"})]}),e.jsxs("div",{className:"space-y-0.5 overflow-y-auto max-h-16",children:[U.slice(0,3).map(ve=>e.jsx("div",{className:E("text-xs px-1 py-0.5 rounded truncate",ve.proximaEjecucion<new Date?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:ve.nombre},ve.id)),U.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground px-1",children:["+",U.length-3," más"]})]})]},N.toISOString())})})]})]}),C&&e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(ee,{className:"text-lg",children:["Tareas del ",C.getDate()," de ",se[C.getMonth()]]})}),e.jsx(F,{children:q(C).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas programadas para este día"}):e.jsx("div",{className:"space-y-2",children:q(C).map(N=>e.jsx(ys,{task:N,equipment:r,onEdit:()=>{I(N),x(!0)},onExecute:()=>{A(N),y(!0)},onDelete:()=>S(N.id)},N.id))})})]})]}),e.jsxs(ws,{value:"list",className:"space-y-4",children:[ae.length>0&&e.jsxs(P,{className:"border-red-500/50",children:[e.jsx(Q,{children:e.jsxs(ee,{className:"text-lg flex items-center gap-2 text-red-500",children:[e.jsx(ue,{className:"h-5 w-5"}),"Tareas Vencidas (",ae.length,")"]})}),e.jsx(F,{className:"space-y-2",children:ae.map(N=>e.jsx(ys,{task:N,equipment:r,onEdit:()=>{I(N),x(!0)},onExecute:()=>{A(N),y(!0)},onDelete:()=>S(N.id)},N.id))})]}),e.jsxs(P,{children:[e.jsx(Q,{children:e.jsxs(ee,{className:"text-lg flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-yellow-500"}),"Próximos 7 días (",Se.length,")"]})}),e.jsx(F,{className:"space-y-2",children:Se.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas programadas para los próximos 7 días"}):Se.map(N=>e.jsx(ys,{task:N,equipment:r,onEdit:()=>{I(N),x(!0)},onExecute:()=>{A(N),y(!0)},onDelete:()=>S(N.id)},N.id))})]}),e.jsxs(P,{children:[e.jsx(Q,{children:e.jsx(ee,{className:"text-lg",children:"Todas las Tareas"})}),e.jsx(F,{className:"space-y-2",children:fe.filter(N=>N.activo).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay tareas activas"}):fe.filter(N=>N.activo).map(N=>e.jsx(ys,{task:N,equipment:r,onEdit:()=>{I(N),x(!0)},onExecute:()=>{A(N),y(!0)},onDelete:()=>S(N.id)},N.id))})]})]}),e.jsx(ws,{value:"history",children:e.jsxs(P,{children:[e.jsx(Q,{children:e.jsx(ee,{className:"text-lg",children:"Historial de Ejecuciones"})}),e.jsx(F,{children:n.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No hay ejecuciones registradas"}):e.jsx("div",{className:"space-y-3",children:n.map(N=>{const G=t.find(B=>B.id===N.taskId),U=r.find(B=>B.id===N.equipmentId);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(Hs,{className:"h-4 w-4 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(G==null?void 0:G.nombre)||"Tarea eliminada"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(U==null?void 0:U.nombre)||"Equipo"," • ",N.duracionMinutos," min"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm",children:N.fechaEjecucion.toLocaleDateString("es-ES")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:N.fechaEjecucion.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]},N.id)})})})]})})]}),e.jsx(be,{open:w,onOpenChange:y,children:e.jsx(je,{className:"max-w-lg",children:Z&&e.jsx(Hc,{task:Z,equipment:r,userId:(s==null?void 0:s.id)||"",onClose:()=>{y(!1),A(null)},onSave:le})})})]})}function ys({task:s,equipment:t,onEdit:a,onExecute:n,onDelete:o}){const r=t.find(d=>d.id===s.equipmentId),i=s.proximaEjecucion<new Date,l=Ir.find(d=>d.value===s.tipo);return e.jsxs("div",{className:E("flex items-center justify-between p-3 rounded-lg border",i?"border-red-500/50 bg-red-500/5":"bg-muted/50"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:E("p-2 rounded-lg",i?"bg-red-500/10":"bg-blue-500/10"),children:e.jsx(Xe,{className:E("h-4 w-4",i?"text-red-500":"text-blue-500")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.nombre}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:(r==null?void 0:r.nombre)||"Sin equipo"}),e.jsx("span",{children:"•"}),e.jsx(Y,{variant:"outline",className:"text-xs",children:(l==null?void 0:l.label)||s.tipo})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:["Próxima: ",s.proximaEjecucion.toLocaleDateString("es-ES"),s.ultimaEjecucion&&e.jsxs(e.Fragment,{children:[" • Última: ",s.ultimaEjecucion.toLocaleDateString("es-ES")]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:n,title:"Ejecutar",children:e.jsx(Ko,{className:"h-4 w-4 text-green-500"})}),e.jsx(k,{variant:"ghost",size:"icon",onClick:a,title:"Editar",children:e.jsx(Qo,{className:"h-4 w-4"})}),e.jsx(k,{variant:"ghost",size:"icon",onClick:o,title:"Eliminar",children:e.jsx(ps,{className:"h-4 w-4 text-destructive"})})]})]})}function Bc({task:s,equipment:t,onClose:a,onSave:n}){var C;const o=()=>s!=null&&s.proximaEjecucion?s.proximaEjecucion.toISOString().split("T")[0]||new Date().toISOString().substring(0,10):new Date().toISOString().substring(0,10),[r,i]=c.useState({equipmentId:(s==null?void 0:s.equipmentId)||"",tipo:(s==null?void 0:s.tipo)||"",nombre:(s==null?void 0:s.nombre)||"",descripcion:(s==null?void 0:s.descripcion)||"",frecuenciaDias:(s==null?void 0:s.frecuenciaDias)||30,proximaEjecucion:o(),asignadoA:(s==null?void 0:s.asignadoA)||"",checklist:((C=s==null?void 0:s.checklist)==null?void 0:C.map(j=>({id:j.id,tarea:j.tarea,completado:j.completado})))||[{id:"1",tarea:"",completado:!1}]}),[l,d]=c.useState(!1),u=async j=>{j.preventDefault(),d(!0);try{const p={...r,proximaEjecucion:new Date(r.proximaEjecucion),checklist:r.checklist.filter(x=>x.tarea.trim()!==""),activo:!0};s?await Er(s.id,p):await Lc(p),n(),a()}catch(p){console.error("Error saving task:",p)}finally{d(!1)}},h=()=>{i({...r,checklist:[...r.checklist,{id:String(Date.now()),tarea:"",completado:!1}]})},m=(j,p)=>{const x=[...r.checklist],w=x[j];w&&(x[j]={id:w.id,tarea:p,completado:w.completado},i({...r,checklist:x}))},b=j=>{i({...r,checklist:r.checklist.filter((p,x)=>x!==j)})};return e.jsxs(je,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{children:e.jsx(Ne,{children:s?"Editar Tarea":"Nueva Tarea Preventiva"})}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Equipo *"}),e.jsxs(me,{value:r.equipmentId,onValueChange:j=>i({...r,equipmentId:j}),required:!0,children:[e.jsx(ie,{children:e.jsx(he,{placeholder:"Seleccionar equipo"})}),e.jsx(ce,{children:t.map(j=>e.jsxs(O,{value:j.id,children:[j.nombre," (",j.codigo,")"]},j.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Tipo de Tarea *"}),e.jsxs(me,{value:r.tipo,onValueChange:j=>i({...r,tipo:j}),required:!0,children:[e.jsx(ie,{children:e.jsx(he,{placeholder:"Seleccionar tipo"})}),e.jsx(ce,{children:Ir.map(j=>e.jsx(O,{value:j.value,children:j.label},j.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Frecuencia *"}),e.jsxs(me,{value:String(r.frecuenciaDias),onValueChange:j=>i({...r,frecuenciaDias:Number(j)}),children:[e.jsx(ie,{children:e.jsx(he,{placeholder:"Seleccionar"})}),e.jsx(ce,{children:qc.map(j=>e.jsx(O,{value:String(j.value),children:j.label},j.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Nombre de la Tarea *"}),e.jsx(J,{value:r.nombre,onChange:j=>i({...r,nombre:j.target.value}),placeholder:"Ej: Lubricación de rodamientos",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Descripción"}),e.jsx(qe,{value:r.descripcion,onChange:j=>i({...r,descripcion:j.target.value}),placeholder:"Instrucciones adicionales...",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Próxima Ejecución *"}),e.jsx(J,{type:"date",value:r.proximaEjecucion,onChange:j=>i({...r,proximaEjecucion:j.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Checklist de Tareas"}),e.jsxs("div",{className:"space-y-2",children:[r.checklist.map((j,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{value:j.tarea,onChange:x=>m(p,x.target.value),placeholder:`Paso ${p+1}`}),r.checklist.length>1&&e.jsx(k,{type:"button",variant:"ghost",size:"icon",onClick:()=>b(p),children:e.jsx(ps,{className:"h-4 w-4"})})]},j.id)),e.jsxs(k,{type:"button",variant:"outline",size:"sm",onClick:h,children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Agregar paso"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(k,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(k,{type:"submit",disabled:l,children:l?"Guardando...":s?"Actualizar":"Crear Tarea"})]})]})]})}function Hc({task:s,equipment:t,userId:a,onClose:n,onSave:o}){const r=t.find(x=>x.id===s.equipmentId),[i,l]=c.useState(s.checklist.map(x=>({...x,completado:!1,observacion:""}))),[d,u]=c.useState(""),[h,m]=c.useState(30),[b,C]=c.useState(!1),j=i.every(x=>x.completado),p=async x=>{if(x.preventDefault(),!j){alert("Debes completar todas las tareas del checklist");return}C(!0);try{await Oc({taskId:s.id,equipmentId:s.equipmentId,ejecutadoPor:a,fechaEjecucion:new Date,checklistCompletado:i,observaciones:d,fotos:[],duracionMinutos:h}),o(),n()}catch(w){console.error("Error executing task:",w)}finally{C(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsxs(Ne,{children:["Ejecutar: ",s.nombre]})}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:["Equipo: ",e.jsx("span",{className:"font-medium text-foreground",children:r==null?void 0:r.nombre})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Checklist"}),e.jsx("div",{className:"space-y-2 border rounded-lg p-3",children:i.map((x,w)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wa,{id:`check-${x.id}`,checked:x.completado,onCheckedChange:y=>{const g=[...i];g[w]={...x,completado:y},l(g)}}),e.jsx("label",{htmlFor:`check-${x.id}`,className:E("text-sm cursor-pointer",x.completado&&"line-through text-muted-foreground"),children:x.tarea})]}),x.completado&&e.jsx(J,{placeholder:"Observación (opcional)",value:x.observacion,onChange:y=>{const g=[...i];g[w]={...x,observacion:y.target.value},l(g)},className:"ml-6 text-xs h-8"})]},x.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Duración (minutos)"}),e.jsx(J,{type:"number",value:h,onChange:x=>m(Number(x.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Observaciones generales"}),e.jsx(qe,{value:d,onChange:x=>u(x.target.value),placeholder:"Notas adicionales...",rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(k,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),e.jsx(k,{type:"submit",disabled:b||!j,children:b?"Guardando...":"Completar Ejecución"})]})]})]})}function Gc({children:s}){const{isAuthenticated:t,isLoading:a}=oe();return a?e.jsx(nr,{}):t?e.jsx(e.Fragment,{children:s}):e.jsx(et,{to:"/login",replace:!0})}function Zc({children:s}){const{isAuthenticated:t,isLoading:a}=oe();return a?e.jsx(nr,{}):t?e.jsx(et,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:s})}function Yc(){const{setUser:s,setLoading:t}=oe();return c.useEffect(()=>{const a=zn(async n=>{if(n)try{const o=await oa(n.uid);s(o)}catch(o){console.error("Error fetching user:",o),s(null)}else s(null)});return()=>a()},[s,t]),e.jsx(zi,{children:e.jsx(mn,{basename:"/mantenimiento-planta",children:e.jsxs(hn,{children:[e.jsx(Me,{path:"/login",element:e.jsx(Zc,{children:e.jsx(Ui,{})})}),e.jsxs(Me,{path:"/",element:e.jsx(Gc,{children:e.jsx(qi,{})}),children:[e.jsx(Me,{index:!0,element:e.jsx(Hi,{})}),e.jsx(Me,{path:"incidents",element:e.jsx(dc,{})}),e.jsx(Me,{path:"map",element:e.jsx(vc,{})}),e.jsx(Me,{path:"equipment",element:e.jsx(Ec,{})}),e.jsx(Me,{path:"preventive",element:e.jsx(Uc,{})}),e.jsx(Me,{path:"settings",element:e.jsx(Mc,{})})]}),e.jsx(Me,{path:"*",element:e.jsx(et,{to:"/",replace:!0})})]})})})}An.createRoot(document.getElementById("root")).render(e.jsx(us.StrictMode,{children:e.jsx(Yc,{})}));
